libname NZCVS 'C:\Documents and Settings\cbg.thomas\My Documents\Data\NZCVS';
LIBNAME NZCVS1 '\\CBGSAS04\Data\CBGSurvey\NZCVS\Level1';
LIBNAME NZCVS2 '\\CBGSAS04\Data\CBGSurvey\NZCVS\Level2';
LIBNAME FSGA2013 '\\CBGSAS04\Data\FormsServer\GeographicAreas2013';
LIBNAME FSGA2015 '\\CBGSAS04\Data\FormsServer\GeographicAreas2015';
LIBNAME CVSForm '\\CBGSAS04\Data\FormsServer\NZCVSCoding';


data NZCVS;
set NZCVS1.NZCVSdatv4;
drop CBGQ1537A1--Version CBGQ1535 CBGQ1485--CBGQ1531 CBGQ7 CBGQ9 DatPartial--VictimFormsComplete;
run;


/*rename all variables*/
%INCLUDE "C:\Documents and Settings\cbg.thomas\My Documents\Program\NZCVS\Year2\renamey2.sas";



proc datasets lib=work memtype=data;
   modify nzcvs; 
     attrib _all_ label=' '; 
   run;


/*drop lots of dummy variables*/
data nzcvs;
set nzcvs;          
drop VFA--VFZ Master_VFType--VS13_02_text4 /*VFSetter1-VFSetter8*/ IVFSmartText1-IVFSmartText8 ResidualClusterCount1-ResidualClusterCount8
RemainingVF1_06_1-RemainingVF1_06_8 VFSetter_ClusterInfo1-VFSetter_ClusterInfo8 ClusterLabelVF1-ClusterLabelVF8 ComboCountVF1-ComboCountVF8
VFQueue1-VFQueue8 DummyIncidents_1-DummyIncidents_8 ClusterCheck1-ClusterCheck8 individualVF1-individualVF8
completeCVFnum5-completeCVFnum8 CBGQ1454 NumberPeople Children
;

/*create few empty variables for 1st VF (these questions are not exist in VF1)*/
VF1_06_1=.;
VF2_02a_1=.;
VF2_02a_op2_1=.;
VF3_34_1A=.;
VF3_34_1B=.;
VF3_35_1A=.;
VF3_35_1B=.;
VF3_01a_8B=.;
VF3_01a_8C=.;

run;



/*coding mutiple responses to 0/1 flags and recode questions to match the word doc*/
/*TSS store varaibles in suffix _A _B _C etc format.
eg ID1_05A stores the first choice for ID1.05, ID1_05B stores the second choice for ID1.05
we want to change them into yes/no flags. so that they become ID1_05_01 ID1_05_02 ID1_05_03
*/
%macro tranq(invars,outvarprefix,values);
	%let invars=%sysfunc(compbl(&invars));

	%do i=1 %to %sysfunc(countw(&values));                     /* Loop through suffixes of output variables we’re creating */
		%let value=%scan(&values,&i);
		%let outvar=&outvarprefix&value;

		if n(%sysfunc(translate(&invars,%str(,),%str( )))) then  /* All/some input variables have values */
			&outvar=
			%do j=1 %to %sysfunc(countw(&invars));
				%let invar=%scan(&invars,&j);
				&invar eq &value or
			%end;
			0;
		else                                                     /* No input variables have values */
			&outvar=.;
	%end;
%mend;


/*recode to match word doc, mainly due to TSS limiation.
e.g TSS cant store option 0. the minimum value is 1. so for ID1.07 op1 means 0, op2 means 1 etc.
*/
data nzcvs_recode;
set nzcvs;
if ID1_07 not in (98,99) then ID1_07=ID1_07-1;
if ID1_08 not in (98,99) then ID1_08=ID1_08-1;

if ID1_02 = 199 then do ID1_02_DKR=99; ID1_02=.; end;

if MD1_03 = 5 then MD1_03=98;
if MD1_04 = 5 then MD1_04=98;
if MD1_05 = 5 then MD1_05=98;
if MD1_06 = 5 then MD1_06=98;
if MD1_07 = 5 then MD1_07=98;

if MD1_03 = 6 then MD1_03=99;
if MD1_04 = 6 then MD1_04=99;
if MD1_05 = 6 then MD1_05=99;
if MD1_06 = 6 then MD1_06=99;
if MD1_07 = 6 then MD1_07=99;
/*WT section*/
if WT3_02 = 6 then WT3_02=97;
if WT3_03 = 6 then WT3_03=97;
if WT3_04 = 6 then WT3_04=97;
if WT3_05 = 6 then WT3_05=97;

if WT6_01 = 6 then WT6_01=98;
if WT6_02 = 6 then WT6_02=98;
if WT6_03 = 6 then WT6_03=98;
if WT6_04 = 6 then WT6_04=98;
if WT6_05 = 6 then WT6_05=98;
if WT6_06 = 6 then WT6_06=98;
if WT6_07 = 6 then WT6_07=98;
if WT6_08 = 6 then WT6_08=98;

if WT6_01 = 7 then WT6_01=99;
if WT6_02 = 7 then WT6_02=99;
if WT6_03 = 7 then WT6_03=99;
if WT6_04 = 7 then WT6_04=99;
if WT6_05 = 7 then WT6_05=99;
if WT6_06 = 7 then WT6_06=99;
if WT6_07 = 7 then WT6_07=99;
if WT6_08 = 7 then WT6_08=99;



/*change all screen questions to the new format.
VS1_01 is yes/no/dkr mutiple choice
VS1_01NUM stores the actual counts
*/
VS1_01Num=VS1_01A; 
if VS1_01A ne . then VS1_01=1;
if VS1_01C=2 then VS1_01=2;
if VS1_01C=3 then VS1_01=98;

VS1_02Num=VS1_02A;
if VS1_02A ne . then VS1_02=1;
if VS1_02B=1 then VS1_02=2;

VS1_03Num=VS1_03A;
if VS1_03A ne . then VS1_03=1;
if VS1_03C=2 then VS1_03=2;
if VS1_03C=3 then VS1_03=98;

VS1_04Num=VS1_04A; 
if VS1_04A ne . then VS1_04=1;
if VS1_04B=1 then VS1_04=2;

VS2_01Num=VS2_01A; 
if VS2_01A ne . then VS2_01=1;
if VS2_01C=2 then VS2_01=2;
if VS2_01C=3 then VS2_01=98;

VS2_02Num=VS2_02A;
if VS2_02A ne . then VS2_02=1;
if VS2_02B=1 then VS2_02=2;

VS2_03Num=VS2_03A;
if VS2_03A ne . then VS2_03=1;
if VS2_03B=1 then VS2_03=2;

VS2_04Num=VS2_04A; 
if VS2_04A ne . then VS2_04=1;
if VS2_04C=2 then VS2_04=2;
if VS2_04C=3 then VS2_04=98;

VS2_05Num=VS2_05A;
if VS2_05A ne . then VS2_05=1;
if VS2_05B=1 then VS2_05=2;

VS2_06Num=VS2_06A;
if VS2_06A ne . then VS2_06=1;
if VS2_06B=1 then VS2_06=2;

VS2_07Num=VS2_07A;
if VS2_07A ne . then VS2_07=1;
if VS2_07C=2 then VS2_07=2;
if VS2_07C=3 then VS2_07=98;

VS2_08Num=VS2_08A;
if VS2_08A ne . then VS2_08=1;
if VS2_08B=1 then VS2_08=2;

VS2_09Num=VS2_09A;
if VS2_09A ne . then VS2_09=1;
if VS2_09B=1 then VS2_09=2;

VS2_10Num=VS2_10A; 
if VS2_10A ne . then VS2_10=1;
if VS2_10C=2 then VS2_10=2;
if VS2_10C=3 then VS2_10=98;

VS2_11Num=VS2_11A;
if VS2_11A ne . then VS2_11=1;
if VS2_11B=1 then VS2_11=2;

VS2_12Num=VS2_12A;
if VS2_12A ne . then VS2_12=1;
if VS2_12B=1 then VS2_12=2;

VS2_13Num=VS2_13A; 
if VS2_13A ne . then VS2_13=1;
if VS2_13C=2 then VS2_13=2;
if VS2_13C=3 then VS2_13=98;

VS2_14Num=VS2_14A;
if VS2_14A ne . then VS2_14=1;
if VS2_14B=1 then VS2_14=2;

VS2_15Num=VS2_15A;
if VS2_15A ne . then VS2_15=1;
if VS2_15B=1 then VS2_15=2;

VS2_16Num=VS2_16A; 
if VS2_16A ne . then VS2_16=1;
if VS2_16C=2 then VS2_16=2;
if VS2_16C=3 then VS2_16=98;

VS2_17Num=VS2_17A;
if VS2_17A ne . then VS2_17=1;
if VS2_17B=1 then VS2_17=2;

VS2_18Num=VS2_18A;
if VS2_18A ne . then VS2_18=1;
if VS2_18B=1 then VS2_18=2;

VS3_01Num=VS3_01A; 
if VS3_01A ne . then VS3_01=1;
if VS3_01C=2 then VS3_01=2;
if VS3_01C=3 then VS3_01=98;

VS3_02Num=VS3_02A; 
if VS3_02A ne . then VS3_02=1;
if VS3_02C=2 then VS3_02=2;
if VS3_02C=3 then VS3_02=98;

VS4_01Num=VS4_01A; 
if VS4_01A ne . then VS4_01=1;
if VS4_01C=2 then VS4_01=2;
if VS4_01C=3 then VS4_01=98;

VS4_02Num=VS4_02A;
if VS4_02A ne . then VS4_02=1;
if VS4_02B=1 then VS4_02=2;

VS4_03Num=VS4_03A;
if VS4_03A ne . then VS4_03=1;
if VS4_03B=1 then VS4_03=2;

VS4_04Num=VS4_04A; 
if VS4_04A ne . then VS4_04=1;
if VS4_04C=2 then VS4_04=2;
if VS4_04C=3 then VS4_04=98;

VS5_01Num=VS5_01A; 
if VS5_01A ne . then VS5_01=1;
if VS5_01C=2 then VS5_01=2;
if VS5_01C=3 then VS5_01=98;

VS6_01Num=VS6_01A; 
if VS6_01A ne . then VS6_01=1;
if VS6_01C=2 then VS6_01=2;
if VS6_01C=3 then VS6_01=98;

VS6_02Num=VS6_02A;
if VS6_02A ne . then VS6_02=1;
if VS6_02B=1 then VS6_02=2;

VS6_03Num=VS6_03A; 
if VS6_03A ne . then VS6_03=1;
if VS6_03C=2 then VS6_03=2;
if VS6_03C=3 then VS6_03=98;

VS7_01Num=VS7_01A; 
if VS7_01A ne . then VS7_01=1;
if VS7_01C=2 then VS7_01=2;
if VS7_01C=3 then VS7_01=98;

VS7_02Num=VS7_02A; 
if VS7_02A ne . then VS7_02=1;
if VS7_02C=2 then VS7_02=2;
if VS7_02C=3 then VS7_02=98;


VS8_01Num=VS8_01A; 
if VS8_01A ne . then VS8_01=1;
if VS8_01D=2 then VS8_01=2;
if VS8_01D=3 then VS8_01=97;
if VS8_01D=4 then VS8_01=98;

VS9_01_Intro8Num=VS9_01_Intro8A;
if VS9_01_Intro8A ne . then VS9_01_Intro8=1;
if VS9_01_Intro8B=1 then VS9_01_Intro8=98;

VS9_02Num=VS9_02A;
if VS9_02A ne . then VS9_02=1;
if VS9_02B=1 then VS9_02=99;

VS9_04Num=VS9_04A;
if VS9_04A ne . then VS9_04=1;
if VS9_04B=1 then VS9_04=99;

VS9_06Num=VS9_06A;
if VS9_06A ne . then VS9_06=1;
if VS9_06B=1 then VS9_06=99;

VS9_08Num=VS9_08A;
if VS9_08A ne . then VS9_08=1;
if VS9_08B=1 then VS9_08=99;

VS10_02Num=VS10_02A;
if VS10_02A ne . then VS10_02=1;
if VS10_02B=1 then VS10_02=99;

VS10_04Num=VS10_04A;
if VS10_04A ne . then VS10_04=1;
if VS10_04B=1 then VS10_04=99;

VS11_02Num=VS11_02A;
if VS11_02A ne . then VS11_02=1;
if VS11_02B=1 then VS11_02=99;

VS11_04Num=VS11_04A;
if VS11_04A ne . then VS11_04=1;
if VS11_04B=1 then VS11_04=99;

VS11_06Num=VS11_06A;
if VS11_06A ne . then VS11_06=1;
if VS11_06B=1 then VS11_06=99;

VS11_08Num=VS11_08A;
if VS11_08A ne . then VS11_08=1;
if VS11_08B=1 then VS11_08=99;

VS13_01Num=VS13_01A; 
if VS13_01A ne . then VS13_01=1;
if VS13_01C=2 then VS13_01=2;
if VS13_01C=3 then VS13_01=98;

/*VF1*/
/*remaining cluster is stored in format "ungrouped incidents_count"
extact count here.*/
VF1_02RemainingIncidents_1=input(scan(VF1_02RemainingCluster_1,2,'_'),best12.);
VFIncidentsCount_1=sum(VF1_02RemainingIncidents_1,CurrentIncidentsCount_1);

/*VF2.05 stored in 3 versions (different option based on crime code), merge them into 1 version*/
VF2_05_1 = VF2_05a_1;
VF2_05_OTHER_1=VF2_05a_OTHER_1;
if VF2_05b_1 ne . then do VF2_05_1=VF2_05b_1; VF2_05_OTHER_1=VF2_05b_OTHER_1; end;
if VF2_05c_1 ne . then do VF2_05_1=VF2_05c_1; VF2_05_OTHER_1=VF2_05c_OTHER_1; end;

VF2_06_1=VF2_06_1A;
if VF2_06_1B=1 then VF2_06_DKR_1=98;

VF2_08_1=VF2_08_1A;
if VF2_08_1B=1 then VF2_08_DKR_1=98;

VF2_10_1=VF2_10_1A;
if VF2_10_1B=1 then VF2_10_DKR_1=98;

VF2_11_1=VF2_11_1A;
if VF2_11_1B=1 then VF2_11_DKR_1=98;

VF2_12_1=VF2_12_1A;
if VF2_12_1B=1 then VF2_12_DKR_1=98;

VF2_14_1=VF2_14_1A; 
if VF2_14_1C=2 then VF2_14_DKR_1=2;
if VF2_14_1C=3 then VF2_14_DKR_1=98;

VF2_15_1=VF2_15_1A;
if VF2_15_1B=1 then VF2_15_DKR_1=98;

VF2_19_1=VF2_19_1A;
if VF2_19_1B=1 then VF2_19_DKR_1=98;

VF2_20_1=VF2_20_1A;
if VF2_20_1B=1 then VF2_20_DKR_1=98;

VF2_21_1=VF2_21_1A;
if VF2_21_1B=1 then VF2_21_DKR_1=98;

if VF2_22_DKR_1=1 then VF2_22_DKR_1=98;

VF2_24_1=VF2_24_1A;
if VF2_24_1B=1 then VF2_24_DKR_1=98;

VF2_27_1=VF2_27_1A;
if VF2_27_1B=1 then VF2_27_DKR_1=98;

VF2_28_1=VF2_28_1A;
if VF2_28_1B=1 then VF2_28_DKR_1=98;

VF2_29_1=VF2_29_1A;
if VF2_29_1B=1 then VF2_29_DKR_1=98;

FV2_01_1=FV2_01_1A; 
if FV2_01_1C=2 then FV2_01_DKR_1=98;
if FV2_01_1C=3 then FV2_01_DKR_1=99;

FV2_02_1=FV2_02_1A; 
if FV2_02_1C=2 then FV2_02_DKR_1=98;
if FV2_02_1C=3 then FV2_02_DKR_1=99;

FV2_06_1=FV2_06_1A;
if FV2_06_1B=1 then FV2_06_DKR_1=98;

FV2_07_1=FV2_07_1A;
if FV2_07_1B=1 then FV2_07_DKR_1=98;

FV2_10_1=FV2_10_1A;
if FV2_10_1B=1 then FV2_10_DKR_1=98;

FV2_11_1=FV2_11_1A;
if FV2_11_1B=1 then FV2_11_DKR_1=98;

/*VF3.05 stored in 3 versions (different option based on crime code), merge them into 1 version*/
VF3_05_1 = VF3_05a_1;
VF3_05_OTHER_1=VF3_05a_OTHER_1;
if VF3_05b_1 ne . then do VF3_05_1=VF3_05b_1; VF3_05_OTHER_1=VF3_05b_OTHER_1; end;
if VF3_05c_1 ne . then do VF3_05_1=VF3_05c_1; VF3_05_OTHER_1=VF3_05c_OTHER_1; end;

VF3_17_1=VF3_17_1A; 
if VF3_17_1C=2 then VF3_17_DKR_1=2;
if VF3_17_1C=3 then VF3_17_DKR_1=98;

if VF3_25_DKR_1=1 then VF2_22_DKR_1=98;

VF3_32_1=VF3_32_1A;
if VF3_32_1B=1 then VF3_32_DKR_1=98;

FV3_08_1=FV3_08_1A;
if FV3_08_1B=1 then FV3_08_DKR_1=98;

FV3_12_1=FV3_12_1A;
if FV3_12_1B=1 then FV3_12_DKR_1=98;

VF3_34_1=VF3_34_1A;
if VF3_34_1B=1 then VF3_34_DKR_1=98;

VF3_35_1=VF3_35_1A;
if VF3_35_1B=1 then VF3_35_DKR_1=98;

/*repeat this for VF2-VF8*/
/*VF2*/
VF1_02RemainingIncidents_2=input(scan(VF1_02RemainingCluster_2,2,'_'),best12.);
VFIncidentsCount_2=sum(VF1_02RemainingIncidents_2,CurrentIncidentsCount_2);

VF2_05_2= VF2_05a_2;
VF2_05_OTHER_2=VF2_05a_OTHER_2;
if VF2_05b_2 ne . then do VF2_05_2=VF2_05b_2; VF2_05_OTHER_2=VF2_05b_OTHER_2; end;
if VF2_05c_2 ne . then do VF2_05_2=VF2_05c_2; VF2_05_OTHER_2=VF2_05c_OTHER_2; end;

VF2_06_2=VF2_06_2A;
if VF2_06_2B=1 then VF2_06_DKR_2=98;

VF2_08_2=VF2_08_2A;
if VF2_08_2B=1 then VF2_08_DKR_2=98;

VF2_10_2=VF2_10_2A;
if VF2_10_2B=1 then VF2_10_DKR_2=98;

VF2_11_2=VF2_11_2A;
if VF2_11_2B=1 then VF2_11_DKR_2=98;

VF2_12_2=VF2_12_2A;
if VF2_12_2B=1 then VF2_12_DKR_2=98;

VF2_14_2=VF2_14_2A; 
if VF2_14_2C=2 then VF2_14_DKR_2=2;
if VF2_14_2C=3 then VF2_14_DKR_2=98;

VF2_15_2=VF2_15_2A;
if VF2_15_2B=1 then VF2_15_DKR_2=98;

VF2_19_2=VF2_19_2A;
if VF2_19_2B=1 then VF2_19_DKR_2=98;

VF2_20_2=VF2_20_2A;
if VF2_20_2B=1 then VF2_20_DKR_2=98;

VF2_21_2=VF2_21_2A;
if VF2_21_2B=1 then VF2_21_DKR_2=98;

if VF2_22_DKR_2=1 then VF2_22_DKR_2=98;

VF2_24_2=VF2_24_2A;
if VF2_24_2B=1 then VF2_24_DKR_2=98;

VF2_27_2=VF2_27_2A;
if VF2_27_2B=1 then VF2_27_DKR_2=98;

VF2_28_2=VF2_28_2A;
if VF2_28_2B=1 then VF2_28_DKR_2=98;

VF2_29_2=VF2_29_2A;
if VF2_29_2B=1 then VF2_29_DKR_2=98;

FV2_01_2=FV2_01_2A; 
if FV2_01_2C=2 then FV2_01_DKR_2=98;
if FV2_01_2C=3 then FV2_01_DKR_2=99;

FV2_02_2=FV2_02_2A; 
if FV2_02_2C=2 then FV2_02_DKR_2=98;
if FV2_02_2C=3 then FV2_02_DKR_2=99;

FV2_06_2=FV2_06_2A;
if FV2_06_2B=1 then FV2_06_DKR_2=98;

FV2_07_2=FV2_07_2A;
if FV2_07_2B=1 then FV2_07_DKR_2=98;

FV2_10_2=FV2_10_2A;
if FV2_10_2B=1 then FV2_10_DKR_2=98;

FV2_11_2=FV2_11_2A;
if FV2_11_2B=1 then FV2_11_DKR_2=98;

VF3_05_2 = VF3_05a_2;
VF3_05_OTHER_2=VF3_05a_OTHER_2;
if VF3_05b_2 ne . then do VF3_05_2=VF3_05b_2; VF3_05_OTHER_2=VF3_05b_OTHER_2; end;
if VF3_05c_2 ne . then do VF3_05_2=VF3_05c_2; VF3_05_OTHER_2=VF3_05c_OTHER_2; end;

VF3_17_2=VF3_17_2A; 
if VF3_17_2C=2 then VF3_17_DKR_2=2;
if VF3_17_2C=3 then VF3_17_DKR_2=98;

if VF3_25_DKR_2=1 then VF2_22_DKR_2=98;

VF3_32_2=VF3_32_2A;
if VF3_32_2B=1 then VF3_32_DKR_2=98;

FV3_08_2=FV3_08_2A;
if FV3_08_2B=1 then FV3_08_DKR_2=98;

FV3_12_2=FV3_12_2A;
if FV3_12_2B=1 then FV3_12_DKR_2=98;

VF3_34_2=VF3_34_2A;
if VF3_34_2B=1 then VF3_34_DKR_2=98;

VF3_35_2=VF3_35_2A;
if VF3_35_2B=1 then VF3_35_DKR_2=98;

/*VF3*/
VF1_02RemainingIncidents_3=input(scan(VF1_02RemainingCluster_3,2,'_'),best12.);
VFIncidentsCount_3=sum(VF1_02RemainingIncidents_3,CurrentIncidentsCount_3);

VF2_05_3= VF2_05a_3;
VF2_05_OTHER_3=VF2_05a_OTHER_3;
if VF2_05b_3 ne . then do VF2_05_3=VF2_05b_3; VF2_05_OTHER_3=VF2_05b_OTHER_3; end;
if VF2_05c_3 ne . then do VF2_05_3=VF2_05c_3; VF2_05_OTHER_3=VF2_05c_OTHER_3; end;

VF2_06_3=VF2_06_3A;
if VF2_06_3B=1 then VF2_06_DKR_3=98;

VF2_08_3=VF2_08_3A;
if VF2_08_3B=1 then VF2_08_DKR_3=98;

VF2_10_3=VF2_10_3A;
if VF2_10_3B=1 then VF2_10_DKR_3=98;

VF2_11_3=VF2_11_3A;
if VF2_11_3B=1 then VF2_11_DKR_3=98;

VF2_12_3=VF2_12_3A;
if VF2_12_3B=1 then VF2_12_DKR_3=98;

VF2_14_3=VF2_14_3A; 
if VF2_14_3C=2 then VF2_14_DKR_3=2;
if VF2_14_3C=3 then VF2_14_DKR_3=98;

VF2_15_3=VF2_15_3A;
if VF2_15_3B=1 then VF2_15_DKR_3=98;

VF2_19_3=VF2_19_3A;
if VF2_19_3B=1 then VF2_19_DKR_3=98;

VF2_20_3=VF2_20_3A;
if VF2_20_3B=1 then VF2_20_DKR_3=98;

VF2_21_3=VF2_21_3A;
if VF2_21_3B=1 then VF2_21_DKR_3=98;

if VF2_22_DKR_3=1 then VF2_22_DKR_3=98;

VF2_24_3=VF2_24_3A;
if VF2_24_3B=1 then VF2_24_DKR_3=98;

VF2_27_3=VF2_27_3A;
if VF2_27_3B=1 then VF2_27_DKR_3=98;

VF2_28_3=VF2_28_3A;
if VF2_28_3B=1 then VF2_28_DKR_3=98;

VF2_29_3=VF2_29_3A;
if VF2_29_3B=1 then VF2_29_DKR_3=98;

FV2_01_3=FV2_01_3A; 
if FV2_01_3C=2 then FV2_01_DKR_3=98;
if FV2_01_3C=3 then FV2_01_DKR_3=99;

FV2_02_3=FV2_02_3A; 
if FV2_02_3C=2 then FV2_02_DKR_3=98;
if FV2_02_3C=3 then FV2_02_DKR_3=99;

FV2_06_3=FV2_06_3A;
if FV2_06_3B=1 then FV2_06_DKR_3=98;

FV2_07_3=FV2_07_3A;
if FV2_07_3B=1 then FV2_07_DKR_3=98;

FV2_10_3=FV2_10_3A;
if FV2_10_3B=1 then FV2_10_DKR_3=98;

FV2_11_3=FV2_11_3A;
if FV2_11_3B=1 then FV2_11_DKR_3=98;

VF3_05_3= VF3_05a_3;
VF3_05_OTHER_3=VF3_05a_OTHER_3;
if VF3_05b_3 ne . then do VF3_05_3=VF3_05b_3; VF3_05_OTHER_3=VF3_05b_OTHER_3; end;
if VF3_05c_3 ne . then do VF3_05_3=VF3_05c_3; VF3_05_OTHER_3=VF3_05c_OTHER_3; end;

VF3_17_3=VF3_17_3A; 
if VF3_17_3C=2 then VF3_17_DKR_3=2;
if VF3_17_3C=3 then VF3_17_DKR_3=98;

if VF3_25_DKR_3=1 then VF2_22_DKR_3=98;

VF3_32_3=VF3_32_3A;
if VF3_32_3B=1 then VF3_32_DKR_3=98;

FV3_08_3=FV3_08_3A;
if FV3_08_3B=1 then FV3_08_DKR_3=98;

FV3_12_3=FV3_12_3A;
if FV3_12_3B=1 then FV3_12_DKR_3=98;

VF3_34_3=VF3_34_3A;
if VF3_34_3B=1 then VF3_34_DKR_3=98;

VF3_35_3=VF3_35_3A;
if VF3_35_3B=1 then VF3_35_DKR_3=98;

/*VF4*/
VF1_02RemainingIncidents_4=input(scan(VF1_02RemainingCluster_4,2,'_'),best12.);
VFIncidentsCount_4=sum(VF1_02RemainingIncidents_4,CurrentIncidentsCount_4);

VF2_05_4= VF2_05a_4;
VF2_05_OTHER_4=VF2_05a_OTHER_4;
if VF2_05b_4 ne . then do VF2_05_4=VF2_05b_4; VF2_05_OTHER_4=VF2_05b_OTHER_4; end;
if VF2_05c_4 ne . then do VF2_05_4=VF2_05c_4; VF2_05_OTHER_4=VF2_05c_OTHER_4; end;

VF2_06_4=VF2_06_4A;
if VF2_06_4B=1 then VF2_06_DKR_4=98;

VF2_08_4=VF2_08_4A;
if VF2_08_4B=1 then VF2_08_DKR_4=98;

VF2_10_4=VF2_10_4A;
if VF2_10_4B=1 then VF2_10_DKR_4=98;

VF2_11_4=VF2_11_4A;
if VF2_11_4B=1 then VF2_11_DKR_4=98;

VF2_12_4=VF2_12_4A;
if VF2_12_4B=1 then VF2_12_DKR_4=98;

VF2_14_4=VF2_14_4A; 
if VF2_14_4C=2 then VF2_14_DKR_4=2;
if VF2_14_4C=3 then VF2_14_DKR_4=98;

VF2_15_4=VF2_15_4A;
if VF2_15_4B=1 then VF2_15_DKR_4=98;

VF2_19_4=VF2_19_4A;
if VF2_19_4B=1 then VF2_19_DKR_4=98;

VF2_20_4=VF2_20_4A;
if VF2_20_4B=1 then VF2_20_DKR_4=98;

VF2_21_4=VF2_21_4A;
if VF2_21_4B=1 then VF2_21_DKR_4=98;

if VF2_22_DKR_4=1 then VF2_22_DKR_4=98;

VF2_24_4=VF2_24_4A;
if VF2_24_4B=1 then VF2_24_DKR_4=98;

VF2_27_4=VF2_27_4A;
if VF2_27_4B=1 then VF2_27_DKR_4=98;

VF2_28_4=VF2_28_4A;
if VF2_28_4B=1 then VF2_28_DKR_4=98;

VF2_29_4=VF2_29_4A;
if VF2_29_4B=1 then VF2_29_DKR_4=98;

FV2_01_4=FV2_01_4A; 
if FV2_01_4C=2 then FV2_01_DKR_4=98;
if FV2_01_4C=3 then FV2_01_DKR_4=99;

FV2_02_4=FV2_02_4A; 
if FV2_02_4C=2 then FV2_02_DKR_4=98;
if FV2_02_4C=3 then FV2_02_DKR_4=99;

FV2_06_4=FV2_06_4A;
if FV2_06_4B=1 then FV2_06_DKR_4=98;

FV2_07_4=FV2_07_4A;
if FV2_07_4B=1 then FV2_07_DKR_4=98;

FV2_10_4=FV2_10_4A;
if FV2_10_4B=1 then FV2_10_DKR_4=98;

FV2_11_4=FV2_11_4A;
if FV2_11_4B=1 then FV2_11_DKR_4=98;

VF3_05_4= VF3_05a_4;
VF3_05_OTHER_4=VF3_05a_OTHER_4;
if VF3_05b_4 ne . then do VF3_05_4=VF3_05b_4; VF3_05_OTHER_4=VF3_05b_OTHER_4; end;
if VF3_05c_4 ne . then do VF3_05_4=VF3_05c_4; VF3_05_OTHER_4=VF3_05c_OTHER_4; end;

VF3_17_4=VF3_17_4A; 
if VF3_17_4C=2 then VF3_17_DKR_4=2;
if VF3_17_4C=3 then VF3_17_DKR_4=98;

if VF3_25_DKR_4=1 then VF2_22_DKR_4=98;

VF3_32_4=VF3_32_4A;
if VF3_32_4B=1 then VF3_32_DKR_4=98;

FV3_08_4=FV3_08_4A;
if FV3_08_4B=1 then FV3_08_DKR_4=98;

FV3_12_4=FV3_12_4A;
if FV3_12_4B=1 then FV3_12_DKR_4=98;

VF3_34_4=VF3_34_4A;
if VF3_34_4B=1 then VF3_34_DKR_4=98;

VF3_35_4=VF3_35_4A;
if VF3_35_4B=1 then VF3_35_DKR_4=98;

/*VF5*/
VF1_02RemainingIncidents_5=input(scan(VF1_02RemainingCluster_5,2,'_'),best12.);
VFIncidentsCount_5=sum(VF1_02RemainingIncidents_5,CurrentIncidentsCount_5);

VF2_05_5= VF2_05a_5;
VF2_05_OTHER_5=VF2_05a_OTHER_5;
if VF2_05b_5 ne . then do VF2_05_5=VF2_05b_5; VF2_05_OTHER_5=VF2_05b_OTHER_5; end;
if VF2_05c_5 ne . then do VF2_05_5=VF2_05c_5; VF2_05_OTHER_5=VF2_05c_OTHER_5; end;

VF2_06_5=VF2_06_5A;
if VF2_06_5B=1 then VF2_06_DKR_5=98;

VF2_08_5=VF2_08_5A;
if VF2_08_5B=1 then VF2_08_DKR_5=98;

VF2_10_5=VF2_10_5A;
if VF2_10_5B=1 then VF2_10_DKR_5=98;

VF2_11_5=VF2_11_5A;
if VF2_11_5B=1 then VF2_11_DKR_5=98;

VF2_12_5=VF2_12_5A;
if VF2_12_5B=1 then VF2_12_DKR_5=98;

VF2_14_5=VF2_14_5A; 
if VF2_14_5C=2 then VF2_14_DKR_5=2;
if VF2_14_5C=3 then VF2_14_DKR_5=98;

VF2_15_5=VF2_15_5A;
if VF2_15_5B=1 then VF2_15_DKR_5=98;

VF2_19_5=VF2_19_5A;
if VF2_19_5B=1 then VF2_19_DKR_5=98;

VF2_20_5=VF2_20_5A;
if VF2_20_5B=1 then VF2_20_DKR_5=98;

VF2_21_5=VF2_21_5A;
if VF2_21_5B=1 then VF2_21_DKR_5=98;

if VF2_22_DKR_5=1 then VF2_22_DKR_5=98;

VF2_24_5=VF2_24_5A;
if VF2_24_5B=1 then VF2_24_DKR_5=98;

VF2_27_5=VF2_27_5A;
if VF2_27_5B=1 then VF2_27_DKR_5=98;

VF2_28_5=VF2_28_5A;
if VF2_28_5B=1 then VF2_28_DKR_5=98;

VF2_29_5=VF2_29_5A;
if VF2_29_5B=1 then VF2_29_DKR_5=98;

FV2_01_5=FV2_01_5A; 
if FV2_01_5C=2 then FV2_01_DKR_5=98;
if FV2_01_5C=3 then FV2_01_DKR_5=99;

FV2_02_5=FV2_02_5A; 
if FV2_02_5C=2 then FV2_02_DKR_5=98;
if FV2_02_5C=3 then FV2_02_DKR_5=99;

FV2_06_5=FV2_06_5A;
if FV2_06_5B=1 then FV2_06_DKR_5=98;

FV2_07_5=FV2_07_5A;
if FV2_07_5B=1 then FV2_07_DKR_5=98;

FV2_10_5=FV2_10_5A;
if FV2_10_5B=1 then FV2_10_DKR_5=98;

FV2_11_5=FV2_11_5A;
if FV2_11_5B=1 then FV2_11_DKR_5=98;

VF3_05_5= VF3_05a_5;
VF3_05_OTHER_5=VF3_05a_OTHER_5;
if VF3_05b_5 ne . then do VF3_05_5=VF3_05b_5; VF3_05_OTHER_5=VF3_05b_OTHER_5; end;
if VF3_05c_5 ne . then do VF3_05_5=VF3_05c_5; VF3_05_OTHER_5=VF3_05c_OTHER_5; end;

VF3_17_5=VF3_17_5A; 
if VF3_17_5C=2 then VF3_17_DKR_5=2;
if VF3_17_5C=3 then VF3_17_DKR_5=98;

if VF3_25_DKR_5=1 then VF2_22_DKR_5=98;

VF3_32_5=VF3_32_5A;
if VF3_32_5B=1 then VF3_32_DKR_5=98;

FV3_08_5=FV3_08_5A;
if FV3_08_5B=1 then FV3_08_DKR_5=98;

FV3_12_5=FV3_12_5A;
if FV3_12_5B=1 then FV3_12_DKR_5=98;

VF3_34_5=VF3_34_5A;
if VF3_34_5B=1 then VF3_34_DKR_5=98;

VF3_35_5=VF3_35_5A;
if VF3_35_5B=1 then VF3_35_DKR_5=98;

/*VF6*/
VF1_02RemainingIncidents_6=input(scan(VF1_02RemainingCluster_6,2,'_'),best12.);
VFIncidentsCount_6=sum(VF1_02RemainingIncidents_6,CurrentIncidentsCount_6);

VF2_05_6= VF2_05a_6;
VF2_05_OTHER_6=VF2_05a_OTHER_6;
if VF2_05b_6 ne . then do VF2_05_6=VF2_05b_6; VF2_05_OTHER_6=VF2_05b_OTHER_6; end;
if VF2_05c_6 ne . then do VF2_05_6=VF2_05c_6; VF2_05_OTHER_6=VF2_05c_OTHER_6; end;

VF2_06_6=VF2_06_6A;
if VF2_06_6B=1 then VF2_06_DKR_6=98;

VF2_08_6=VF2_08_6A;
if VF2_08_6B=1 then VF2_08_DKR_6=98;

VF2_10_6=VF2_10_6A;
if VF2_10_6B=1 then VF2_10_DKR_6=98;

VF2_11_6=VF2_11_6A;
if VF2_11_6B=1 then VF2_11_DKR_6=98;

VF2_12_6=VF2_12_6A;
if VF2_12_6B=1 then VF2_12_DKR_6=98;

VF2_14_6=VF2_14_6A; 
if VF2_14_6C=2 then VF2_14_DKR_6=2;
if VF2_14_6C=3 then VF2_14_DKR_6=98;

VF2_15_6=VF2_15_6A;
if VF2_15_6B=1 then VF2_15_DKR_6=98;

VF2_19_6=VF2_19_6A;
if VF2_19_6B=1 then VF2_19_DKR_6=98;

VF2_20_6=VF2_20_6A;
if VF2_20_6B=1 then VF2_20_DKR_6=98;

VF2_21_6=VF2_21_6A;
if VF2_21_6B=1 then VF2_21_DKR_6=98;

if VF2_22_DKR_6=1 then VF2_22_DKR_6=98;

VF2_24_6=VF2_24_6A;
if VF2_24_6B=1 then VF2_24_DKR_6=98;

VF2_27_6=VF2_27_6A;
if VF2_27_6B=1 then VF2_27_DKR_6=98;

VF2_28_6=VF2_28_6A;
if VF2_28_6B=1 then VF2_28_DKR_6=98;

VF2_29_6=VF2_29_6A;
if VF2_29_6B=1 then VF2_29_DKR_6=98;

FV2_01_6=FV2_01_6A; 
if FV2_01_6C=2 then FV2_01_DKR_6=98;
if FV2_01_6C=3 then FV2_01_DKR_6=99;

FV2_02_6=FV2_02_6A; 
if FV2_02_6C=2 then FV2_02_DKR_6=98;
if FV2_02_6C=3 then FV2_02_DKR_6=99;

FV2_06_6=FV2_06_6A;
if FV2_06_6B=1 then FV2_06_DKR_6=98;

FV2_07_6=FV2_07_6A;
if FV2_07_6B=1 then FV2_07_DKR_6=98;

FV2_10_6=FV2_10_6A;
if FV2_10_6B=1 then FV2_10_DKR_6=98;

FV2_11_6=FV2_11_6A;
if FV2_11_6B=1 then FV2_11_DKR_6=98;

VF3_05_6= VF3_05a_6;
VF3_05_OTHER_6=VF3_05a_OTHER_6;
if VF3_05b_6 ne . then do VF3_05_6=VF3_05b_6; VF3_05_OTHER_6=VF3_05b_OTHER_6; end;
if VF3_05c_6 ne . then do VF3_05_6=VF3_05c_6; VF3_05_OTHER_6=VF3_05c_OTHER_6; end;

VF3_17_6=VF3_17_6A; 
if VF3_17_6C=2 then VF3_17_DKR_6=2;
if VF3_17_6C=3 then VF3_17_DKR_6=98;

if VF3_25_DKR_6=1 then VF2_22_DKR_6=98;

VF3_32_6=VF3_32_6A;
if VF3_32_6B=1 then VF3_32_DKR_6=98;

FV3_08_6=FV3_08_6A;
if FV3_08_6B=1 then FV3_08_DKR_6=98;

FV3_12_6=FV3_12_6A;
if FV3_12_6B=1 then FV3_12_DKR_6=98;

VF3_34_6=VF3_34_6A;
if VF3_34_6B=1 then VF3_34_DKR_6=98;

VF3_35_6=VF3_35_6A;
if VF3_35_6B=1 then VF3_35_DKR_6=98;

/*VF7*/
VF1_02RemainingIncidents_7=input(scan(VF1_02RemainingCluster_7,2,'_'),best12.);
VFIncidentsCount_7=sum(VF1_02RemainingIncidents_7,CurrentIncidentsCount_7);

VF2_05_7= VF2_05a_7;
VF2_05_OTHER_7=VF2_05a_OTHER_7;
if VF2_05b_7 ne . then do VF2_05_7=VF2_05b_7; VF2_05_OTHER_7=VF2_05b_OTHER_7; end;
if VF2_05c_7 ne . then do VF2_05_7=VF2_05c_7; VF2_05_OTHER_7=VF2_05c_OTHER_7; end;

VF2_06_7=VF2_06_7A;
if VF2_06_7B=1 then VF2_06_DKR_7=98;

VF2_08_7=VF2_08_7A;
if VF2_08_7B=1 then VF2_08_DKR_7=98;

VF2_10_7=VF2_10_7A;
if VF2_10_7B=1 then VF2_10_DKR_7=98;

VF2_11_7=VF2_11_7A;
if VF2_11_7B=1 then VF2_11_DKR_7=98;

VF2_12_7=VF2_12_7A;
if VF2_12_7B=1 then VF2_12_DKR_7=98;

VF2_14_7=VF2_14_7A; 
if VF2_14_7C=2 then VF2_14_DKR_7=2;
if VF2_14_7C=3 then VF2_14_DKR_7=98;

VF2_15_7=VF2_15_7A;
if VF2_15_7B=1 then VF2_15_DKR_7=98;

VF2_19_7=VF2_19_7A;
if VF2_19_7B=1 then VF2_19_DKR_7=98;

VF2_20_7=VF2_20_7A;
if VF2_20_7B=1 then VF2_20_DKR_7=98;

VF2_21_7=VF2_21_7A;
if VF2_21_7B=1 then VF2_21_DKR_7=98;

if VF2_22_DKR_7=1 then VF2_22_DKR_7=98;

VF2_24_7=VF2_24_7A;
if VF2_24_7B=1 then VF2_24_DKR_7=98;

VF2_27_7=VF2_27_7A;
if VF2_27_7B=1 then VF2_27_DKR_7=98;

VF2_28_7=VF2_28_7A;
if VF2_28_7B=1 then VF2_28_DKR_7=98;

VF2_29_7=VF2_29_7A;
if VF2_29_7B=1 then VF2_29_DKR_7=98;

FV2_01_7=FV2_01_7A; 
if FV2_01_7C=2 then FV2_01_DKR_7=98;
if FV2_01_7C=3 then FV2_01_DKR_7=99;

FV2_02_7=FV2_02_7A; 
if FV2_02_7C=2 then FV2_02_DKR_7=98;
if FV2_02_7C=3 then FV2_02_DKR_7=99;

FV2_06_7=FV2_06_7A;
if FV2_06_7B=1 then FV2_06_DKR_7=98;

FV2_07_7=FV2_07_7A;
if FV2_07_7B=1 then FV2_07_DKR_7=98;

FV2_10_7=FV2_10_7A;
if FV2_10_7B=1 then FV2_10_DKR_7=98;

FV2_11_7=FV2_11_7A;
if FV2_11_7B=1 then FV2_11_DKR_7=98;

VF3_05_7= VF3_05a_7;
VF3_05_OTHER_7=VF3_05a_OTHER_7;
if VF3_05b_7 ne . then do VF3_05_7=VF3_05b_7; VF3_05_OTHER_7=VF3_05b_OTHER_7; end;
if VF3_05c_7 ne . then do VF3_05_7=VF3_05c_7; VF3_05_OTHER_7=VF3_05c_OTHER_7; end;

VF3_17_7=VF3_17_7A; 
if VF3_17_7C=2 then VF3_17_DKR_7=2;
if VF3_17_7C=3 then VF3_17_DKR_7=98;

if VF3_25_DKR_7=1 then VF2_22_DKR_7=98;

VF3_32_7=VF3_32_7A;
if VF3_32_7B=1 then VF3_32_DKR_7=98;

FV3_08_7=FV3_08_7A;
if FV3_08_7B=1 then FV3_08_DKR_7=98;

FV3_12_7=FV3_12_7A;
if FV3_12_7B=1 then FV3_12_DKR_7=98;

VF3_34_7=VF3_34_7A;
if VF3_34_7B=1 then VF3_34_DKR_7=98;

VF3_35_7=VF3_35_7A;
if VF3_35_7B=1 then VF3_35_DKR_7=98;

/*VF8*/
VF1_02RemainingIncidents_8=input(scan(VF1_02RemainingCluster_8,2,'_'),best12.);
VFIncidentsCount_8=sum(VF1_02RemainingIncidents_8,CurrentIncidentsCount_8);

VF2_05_8= VF2_05a_8;
VF2_05_OTHER_8=VF2_05a_OTHER_8;
if VF2_05b_8 ne . then do VF2_05_8=VF2_05b_8; VF2_05_OTHER_8=VF2_05b_OTHER_8; end;
if VF2_05c_8 ne . then do VF2_05_8=VF2_05c_8; VF2_05_OTHER_8=VF2_05c_OTHER_8; end;

VF2_06_8=VF2_06_8A;
if VF2_06_8B=1 then VF2_06_DKR_8=98;

VF2_08_8=VF2_08_8A;
if VF2_08_8B=1 then VF2_08_DKR_8=98;

VF2_10_8=VF2_10_8A;
if VF2_10_8B=1 then VF2_10_DKR_8=98;

VF2_11_8=VF2_11_8A;
if VF2_11_8B=1 then VF2_11_DKR_8=98;

VF2_12_8=VF2_12_8A;
if VF2_12_8B=1 then VF2_12_DKR_8=98;

VF2_14_8=VF2_14_8A; 
if VF2_14_8C=2 then VF2_14_DKR_8=2;
if VF2_14_8C=3 then VF2_14_DKR_8=98;

VF2_15_8=VF2_15_8A;
if VF2_15_8B=1 then VF2_15_DKR_8=98;

VF2_19_8=VF2_19_8A;
if VF2_19_8B=1 then VF2_19_DKR_8=98;

VF2_20_8=VF2_20_8A;
if VF2_20_8B=1 then VF2_20_DKR_8=98;

VF2_21_8=VF2_21_8A;
if VF2_21_8B=1 then VF2_21_DKR_8=98;

if VF2_22_DKR_8=1 then VF2_22_DKR_8=98;

VF2_24_8=VF2_24_8A;
if VF2_24_8B=1 then VF2_24_DKR_8=98;

VF2_27_8=VF2_27_8A;
if VF2_27_8B=1 then VF2_27_DKR_8=98;

VF2_28_8=VF2_28_8A;
if VF2_28_8B=1 then VF2_28_DKR_8=98;

VF2_29_8=VF2_29_8A;
if VF2_29_8B=1 then VF2_29_DKR_8=98;

FV2_01_8=FV2_01_8A; 
if FV2_01_8C=2 then FV2_01_DKR_8=98;
if FV2_01_8C=3 then FV2_01_DKR_8=99;

FV2_02_8=FV2_02_8A; 
if FV2_02_8C=2 then FV2_02_DKR_8=98;
if FV2_02_8C=3 then FV2_02_DKR_8=99;

FV2_06_8=FV2_06_8A;
if FV2_06_8B=1 then FV2_06_DKR_8=98;

FV2_07_8=FV2_07_8A;
if FV2_07_8B=1 then FV2_07_DKR_8=98;

FV2_10_8=FV2_10_8A;
if FV2_10_8B=1 then FV2_10_DKR_8=98;

FV2_11_8=FV2_11_8A;
if FV2_11_8B=1 then FV2_11_DKR_8=98;

VF3_05_8= VF3_05a_8;
VF3_05_OTHER_8=VF3_05a_OTHER_8;
if VF3_05b_8 ne . then do VF3_05_8=VF3_05b_8; VF3_05_OTHER_8=VF3_05b_OTHER_8; end;
if VF3_05c_8 ne . then do VF3_05_8=VF3_05c_8; VF3_05_OTHER_8=VF3_05c_OTHER_8; end;

VF3_17_8=VF3_17_8A; 
if VF3_17_8C=2 then VF3_17_DKR_8=2;
if VF3_17_8C=3 then VF3_17_DKR_8=98;

if VF3_25_DKR_8=1 then VF2_22_DKR_8=98;

VF3_32_8=VF3_32_8A;
if VF3_32_8B=1 then VF3_32_DKR_8=98;

FV3_08_8=FV3_08_8A;
if FV3_08_8B=1 then FV3_08_DKR_8=98;

FV3_12_8=FV3_12_8A;
if FV3_12_8B=1 then FV3_12_DKR_8=98;

VF3_34_8=VF3_34_8A;
if VF3_34_8B=1 then VF3_34_DKR_8=98;

VF3_35_8=VF3_35_8A;
if VF3_35_8B=1 then VF3_35_DKR_8=98;


drop
VS1_01A VS1_01B VS1_01C VS1_02A VS1_02B VS1_03A VS1_03B VS1_03C VS1_04A VS1_04B VS2_01A VS2_01B VS2_01C VS2_02A VS2_02B VS2_03A VS2_03B
VS2_04A VS2_04B VS2_04C VS2_05A VS2_05B VS2_06A VS2_06B VS2_07A VS2_07B VS2_07C VS2_08A VS2_08B VS2_09A VS2_09B VS2_10A VS2_10B VS2_10C
VS2_11A VS2_11B VS2_12A VS2_12B VS2_13A VS2_13B VS2_13C VS2_14A VS2_14B VS2_15A VS2_15B VS2_16A VS2_16B VS2_16C VS2_17A VS2_17B VS2_18A VS2_18B
VS3_01A VS3_01B VS3_01C VS3_02A VS3_02B VS3_02C VS4_01A VS4_01B VS4_01C VS4_02A VS4_02B VS4_03A VS4_03B VS4_04A VS4_04B VS4_04C VS5_01A VS5_01B VS5_01C
VS6_01A VS6_01B VS6_01C VS6_02A VS6_02B VS6_03A VS6_03B VS6_03C VS7_01A VS7_01B VS7_01C VS7_02A VS7_02B VS7_02C VS8_01A VS8_01B VS8_01C VS8_01D
VS9_02A VS9_02B VS9_04A VS9_04B VS9_06A VS9_06B VS9_08A VS9_08B VS10_02A VS10_02B VS10_04A VS10_04B VS11_02A VS11_02B VS11_04A VS11_04B
VS11_06A VS11_06B VS11_08A VS11_08B VS13_01A VS13_01B VS13_01C 
VF1_02RemainingCluster_1-VF1_02RemainingCluster_8
/*VF1*/
VF2_05a_1 VF2_05b_1 VF2_05c_1 VF2_05a_OTHER_1 VF2_05b_OTHER_1 VF2_05c_OTHER_1 VF2_06_1A VF2_06_1B VF2_08_1A VF2_08_1B VF2_10_1A VF2_10_1B
VF2_11_1A VF2_11_1B VF2_12_1A VF2_12_1B VF2_14_1A VF2_14_1B VF2_14_1C VF2_15_1A VF2_15_1B VF2_19_1A VF2_19_1B 
VF2_20_1A VF2_20_1B VF2_21_1A VF2_21_1B VF2_24_1A VF2_24_1B
VF2_27_1A VF2_27_1B VF2_28_1A VF2_28_1B VF2_29_1A VF2_29_1B FV2_01_1A FV2_01_1B FV2_01_1C FV2_02_1A FV2_02_1B FV2_02_1C
FV2_06_1A FV2_06_1B FV2_07_1A FV2_07_1B FV2_10_1A FV2_10_1B FV2_11_1A FV2_11_1B VF3_05a_1 VF3_05b_1 VF3_05c_1 VF3_05a_OTHER_1 VF3_05b_OTHER_1 VF3_05c_OTHER_1
VF3_17_1A VF3_17_1B VF3_17_1C VF3_32_1A VF3_32_1B FV3_08_1A FV3_08_1B FV3_12_1A FV3_12_1B VF3_34_1A VF3_34_1B VF3_35_1A VF3_35_1B
/*VF2*/
VF2_05a_2 VF2_05b_2 VF2_05c_2 VF2_05a_OTHER_2 VF2_05b_OTHER_2 VF2_05c_OTHER_2 VF2_06_2A VF2_06_2B VF2_08_2A VF2_08_2B VF2_10_2A VF2_10_2B
VF2_11_2A VF2_11_2B VF2_12_2A VF2_12_2B VF2_14_2A VF2_14_2B VF2_14_2C VF2_15_2A VF2_15_2B VF2_19_2A VF2_19_2B 
VF2_20_2A VF2_20_2B VF2_21_2A VF2_21_2B VF2_24_2A VF2_24_2B
VF2_27_2A VF2_27_2B VF2_28_2A VF2_28_2B VF2_29_2A VF2_29_2B FV2_01_2A FV2_01_2B FV2_01_2C FV2_02_2A FV2_02_2B FV2_02_2C
FV2_06_2A FV2_06_2B FV2_07_2A FV2_07_2B FV2_10_2A FV2_10_2B FV2_11_2A FV2_11_2B VF3_05a_2 VF3_05b_2 VF3_05c_2 VF3_05a_OTHER_2 VF3_05b_OTHER_2 VF3_05c_OTHER_2
VF3_17_2A VF3_17_2B VF3_17_2C VF3_32_2A VF3_32_2B FV3_08_2A FV3_08_2B FV3_12_2A FV3_12_2B VF3_34_2A VF3_34_2B VF3_35_2A VF3_35_2B
/*VF3*/
VF2_05a_3 VF2_05b_3 VF2_05c_3 VF2_05a_OTHER_3 VF2_05b_OTHER_3 VF2_05c_OTHER_3 VF2_06_3A VF2_06_3B VF2_08_3A VF2_08_3B VF2_10_3A VF2_10_3B
VF2_11_3A VF2_11_3B VF2_12_3A VF2_12_3B VF2_14_3A VF2_14_3B VF2_14_3C VF2_15_3A VF2_15_3B VF2_19_3A VF2_19_3B 
VF2_20_3A VF2_20_3B VF2_21_3A VF2_21_3B VF2_24_3A VF2_24_3B
VF2_27_3A VF2_27_3B VF2_28_3A VF2_28_3B VF2_29_3A VF2_29_3B FV2_01_3A FV2_01_3B FV2_01_3C FV2_02_3A FV2_02_3B FV2_02_3C
FV2_06_3A FV2_06_3B FV2_07_3A FV2_07_3B FV2_10_3A FV2_10_3B FV2_11_3A FV2_11_3B VF3_05a_3 VF3_05b_3 VF3_05c_3 VF3_05a_OTHER_3 VF3_05b_OTHER_3 VF3_05c_OTHER_3
VF3_17_3A VF3_17_3B VF3_17_3C VF3_32_3A VF3_32_3B FV3_08_3A FV3_08_3B FV3_12_3A FV3_12_3B VF3_34_3A VF3_34_3B VF3_35_3A VF3_35_3B
/*VF4*/
VF2_05a_4 VF2_05b_4 VF2_05c_4 VF2_05a_OTHER_4 VF2_05b_OTHER_4 VF2_05c_OTHER_4 VF2_06_4A VF2_06_4B VF2_08_4A VF2_08_4B VF2_10_4A VF2_10_4B
VF2_11_4A VF2_11_4B VF2_12_4A VF2_12_4B VF2_14_4A VF2_14_4B VF2_14_4C VF2_15_4A VF2_15_4B VF2_19_4A VF2_19_4B 
VF2_20_4A VF2_20_4B VF2_21_4A VF2_21_4B VF2_24_4A VF2_24_4B
VF2_27_4A VF2_27_4B VF2_28_4A VF2_28_4B VF2_29_4A VF2_29_4B FV2_01_4A FV2_01_4B FV2_01_4C FV2_02_4A FV2_02_4B FV2_02_4C
FV2_06_4A FV2_06_4B FV2_07_4A FV2_07_4B FV2_10_4A FV2_10_4B FV2_11_4A FV2_11_4B VF3_05a_4 VF3_05b_4 VF3_05c_4 VF3_05a_OTHER_4 VF3_05b_OTHER_4 VF3_05c_OTHER_4
VF3_17_4A VF3_17_4B VF3_17_4C VF3_32_4A VF3_32_4B FV3_08_4A FV3_08_4B FV3_12_4A FV3_12_4B VF3_34_4A VF3_34_4B VF3_35_4A VF3_35_4B
/*VF5*/
VF2_05a_5 VF2_05b_5 VF2_05c_5 VF2_05a_OTHER_5 VF2_05b_OTHER_5 VF2_05c_OTHER_5 VF2_06_5A VF2_06_5B VF2_08_5A VF2_08_5B VF2_10_5A VF2_10_5B
VF2_11_5A VF2_11_5B VF2_12_5A VF2_12_5B VF2_14_5A VF2_14_5B VF2_14_5C VF2_15_5A VF2_15_5B VF2_19_5A VF2_19_5B 
VF2_20_5A VF2_20_5B VF2_21_5A VF2_21_5B VF2_24_5A VF2_24_5B
VF2_27_5A VF2_27_5B VF2_28_5A VF2_28_5B VF2_29_5A VF2_29_5B FV2_01_5A FV2_01_5B FV2_01_5C FV2_02_5A FV2_02_5B FV2_02_5C
FV2_06_5A FV2_06_5B FV2_07_5A FV2_07_5B FV2_10_5A FV2_10_5B FV2_11_5A FV2_11_5B VF3_05a_5 VF3_05b_5 VF3_05c_5 VF3_05a_OTHER_5 VF3_05b_OTHER_5 VF3_05c_OTHER_5
VF3_17_5A VF3_17_5B VF3_17_5C VF3_32_5A VF3_32_5B FV3_08_5A FV3_08_5B FV3_12_5A FV3_12_5B VF3_34_5A VF3_34_5B VF3_35_5A VF3_35_5B
/*VF6*/
VF2_05a_6 VF2_05b_6 VF2_05c_6 VF2_05a_OTHER_6 VF2_05b_OTHER_6 VF2_05c_OTHER_6 VF2_06_6A VF2_06_6B VF2_08_6A VF2_08_6B VF2_10_6A VF2_10_6B
VF2_11_6A VF2_11_6B VF2_12_6A VF2_12_6B VF2_14_6A VF2_14_6B VF2_14_6C VF2_15_6A VF2_15_6B VF2_19_6A VF2_19_6B 
VF2_20_6A VF2_20_6B VF2_21_6A VF2_21_6B VF2_24_6A VF2_24_6B
VF2_27_6A VF2_27_6B VF2_28_6A VF2_28_6B VF2_29_6A VF2_29_6B FV2_01_6A FV2_01_6B FV2_01_6C FV2_02_6A FV2_02_6B FV2_02_6C
FV2_06_6A FV2_06_6B FV2_07_6A FV2_07_6B FV2_10_6A FV2_10_6B FV2_11_6A FV2_11_6B VF3_05a_6 VF3_05b_6 VF3_05c_6 VF3_05a_OTHER_6 VF3_05b_OTHER_6 VF3_05c_OTHER_6
VF3_17_6A VF3_17_6B VF3_17_6C VF3_32_6A VF3_32_6B FV3_08_6A FV3_08_6B FV3_12_6A FV3_12_6B VF3_34_6A VF3_34_6B VF3_35_6A VF3_35_6B

/*VF7*/
VF2_05a_7 VF2_05b_7 VF2_05c_7 VF2_05a_OTHER_7 VF2_05b_OTHER_7 VF2_05c_OTHER_7 VF2_06_7A VF2_06_7B VF2_08_7A VF2_08_7B VF2_10_7A VF2_10_7B
VF2_11_7A VF2_11_7B VF2_12_7A VF2_12_7B VF2_14_7A VF2_14_7B VF2_14_7C VF2_15_7A VF2_15_7B VF2_19_7A VF2_19_7B 
VF2_20_7A VF2_20_7B VF2_21_7A VF2_21_7B VF2_24_7A VF2_24_7B
VF2_27_7A VF2_27_7B VF2_28_7A VF2_28_7B VF2_29_7A VF2_29_7B FV2_01_7A FV2_01_7B FV2_01_7C FV2_02_7A FV2_02_7B FV2_02_7C
FV2_06_7A FV2_06_7B FV2_07_7A FV2_07_7B FV2_10_7A FV2_10_7B FV2_11_7A FV2_11_7B VF3_05a_7 VF3_05b_7 VF3_05c_7 VF3_05a_OTHER_7 VF3_05b_OTHER_7 VF3_05c_OTHER_7
VF3_17_7A VF3_17_7B VF3_17_7C VF3_32_7A VF3_32_7B FV3_08_7A FV3_08_7B FV3_12_7A FV3_12_7B VF3_34_7A VF3_34_7B VF3_35_7A VF3_35_7B

/*VF8*/
VF2_05a_8 VF2_05b_8 VF2_05c_8 VF2_05a_OTHER_8 VF2_05b_OTHER_8 VF2_05c_OTHER_8 VF2_06_8A VF2_06_8B VF2_08_8A VF2_08_8B VF2_10_8A VF2_10_8B
VF2_11_8A VF2_11_8B VF2_12_8A VF2_12_8B VF2_14_8A VF2_14_8B VF2_14_8C VF2_15_8A VF2_15_8B VF2_19_8A VF2_19_8B 
VF2_20_8A VF2_20_8B VF2_21_8A VF2_21_8B VF2_24_8A VF2_24_8B
VF2_27_8A VF2_27_8B VF2_28_8A VF2_28_8B VF2_29_8A VF2_29_8B FV2_01_8A FV2_01_8B FV2_01_8C FV2_02_8A FV2_02_8B FV2_02_8C
FV2_06_8A FV2_06_8B FV2_07_8A FV2_07_8B FV2_10_8A FV2_10_8B FV2_11_8A FV2_11_8B VF3_05a_8 VF3_05b_8 VF3_05c_8 VF3_05a_OTHER_8 VF3_05b_OTHER_8 VF3_05c_OTHER_8
VF3_17_8A VF3_17_8B VF3_17_8C VF3_32_8A VF3_32_8B FV3_08_8A FV3_08_8B FV3_12_8A FV3_12_8B VF3_34_8A VF3_34_8B VF3_35_8A VF3_35_8B
;
run;



/*apply macro to change mutiple response options question to flag*/
data nzcvs_flag;
set nzcvs_recode;

%tranq(ID1_04aA ID1_04aB ID1_04bA ID1_04bB ,ID1_04_,01 02 03);

%tranq(ID1_05A ID1_05B,ID1_05_,01 02 03);

%tranq(VS9_01_Intro5A VS9_01_Intro5B VS9_01_Intro5C VS9_01_Intro5D VS9_01_Intro5E VS9_01_Intro5F VS9_01_Intro5G VS9_01_Intro5H,VS9_01_Intro5_,01 02 03 04 05 06 07 08);
if VS9_01_Intro5A in (98,99) then VS9_01_Intro5_DKR=VS9_01_Intro5A;

/*VF1*/
%tranq(VF2_02_1A VF2_02_1B VF2_02_1C,VF2_02_1_,01 02 03);

%tranq(VF2_09_1A VF2_09_1B VF2_09_1C VF2_09_1D VF2_09_1E VF2_09_1F VF2_09_1G VF2_09_1H VF2_09_1I VF2_09_1J VF2_09_1K VF2_09_1L VF2_09_1M VF2_09_1N VF2_09_1O VF2_09_1P VF2_09_1Q VF2_09_1R VF2_09_1S,VF2_09_1_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 77);
if VF2_09_1A in (98,99) then VF2_09_DKR_1=VF2_09_1A;

%tranq(VF2_26_1A VF2_26_1B VF2_26_1C VF2_26_1D VF2_26_1E VF2_26_1F VF2_26_1G VF2_26_1H VF2_26_1I VF2_26_1J VF2_26_1K VF2_26_1L VF2_26_1M VF2_26_1N VF2_26_1O VF2_26_1P VF2_26_1Q ,VF2_26_1_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 77);
if VF2_26_1A in (98,99) then VF2_26_DKR_1=VF2_26_1A;

%tranq(FV2_03_1A FV2_03_1B,FV2_03_1_,01 02 03);
if FV2_03_1A in (98,99) then FV2_03_DKR_1=FV2_03_1A;

%tranq(FV2_04_1A FV2_04_1B FV2_04_1C FV2_04_1D FV2_04_1E FV2_04_1F FV2_04_1G FV2_04_1H,FV2_04_1_,01 02 03 04 05 06 07 77 78);
if FV2_04_1A in (98,99) then FV2_04_DKR_1=FV2_04_1A;

%tranq(FV2_05_1A FV2_05_1B FV2_05_1C FV2_05_1D,FV2_05_1_,01 02 03 77);

%tranq(FV2_08_1A FV2_08_1B FV2_08_1C FV2_08_1D FV2_08_1E,FV2_08_1_,01 02 03 04 77);
if FV2_08_1A in (98,99) then FV2_08_DKR_1=FV2_08_1A;

%tranq(FV2_09_1A FV2_09_1B FV2_09_1C FV2_09_1D FV2_09_1E FV2_09_1F FV2_09_1G FV2_09_1H FV2_09_1I FV2_09_1J FV2_09_1K FV2_09_1L,FV2_09_1_,01 02 03 04 05 06 07 08 09 10 11 77 78);
if FV2_09_1A in (98,99) then FV2_09_DKR_1=FV2_09_1A;

%tranq(VF3_01a_1A VF3_01a_1B VF3_01a_1C,VF3_01a_1_,01 02 03);

%tranq(VF3_13_1A VF3_13_1B VF3_13_1C VF3_13_1D VF3_13_1E VF3_13_1F VF3_13_1G VF3_13_1H VF3_13_1I VF3_13_1J VF3_13_1K VF3_13_1L VF3_13_1M VF3_13_1N VF3_13_1O VF3_13_1P VF3_13_1Q VF3_13_1R VF3_13_1S,VF3_13_1_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 77);
if VF3_13_1A in (98,99) then VF3_13_DKR_1=VF3_13_1A;

%tranq(VF3_24_1A VF3_24_1B,VF3_24_1_,01 02 03);
if VF3_24_1A in (98,99) then VF3_24_DKR_1=VF3_24_1A;

%tranq(VF3_29_1A VF3_29_1B VF3_29_1C VF3_29_1D VF3_29_1E VF3_29_1F VF3_29_1G VF3_29_1H VF3_29_1I VF3_29_1J VF3_29_1K VF3_29_1L VF3_29_1M VF3_29_1N VF3_29_1O VF3_29_1P VF3_29_1Q,VF3_29_1_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 77);
if VF3_29_1A in (98,99) then VF3_29_DKR_1=VF3_29_1A;

%tranq(FV3_05_1A FV3_05_1B,FV3_05_1_,01 02 03);
if FV3_05_1A in (98,99) then FV3_05_DKR_1=FV3_05_1A;

%tranq(FV3_06_1A FV3_06_1B FV3_06_1C FV3_06_1D FV3_06_1E FV3_06_1F FV3_06_1G,FV3_06_1_,01 02 03 04 05 06 07 77 78);
if FV3_06_1A in (98,99) then FV3_06_DKR_1=FV3_06_1A;

%tranq(FV3_07_1A FV3_07_1B FV3_07_1C FV3_07_1D,FV3_07_1_,01 02 03 77);
*if FV3_07_1A in (98,99) then FV3_07_DKR_1=FV3_07_1A;

%tranq(FV3_10_1A FV3_10_1B FV3_10_1C FV3_10_1D,FV3_10_1_,01 02 03 04 77);
if FV3_10_1A in (98,99) then FV3_10_DKR_1=FV3_10_1A;

%tranq(FV3_11_1A FV3_11_1B FV3_11_1C FV3_11_1D FV3_11_1E FV3_11_1F FV3_11_1G FV3_11_1H FV3_11_1I FV3_11_1J FV3_11_1K FV3_11_1L,FV3_11_1_,01 02 03 04 05 06 07 08 09 10 11 77 78);
if FV3_11_1A in (98,99) then FV3_11_DKR_1=FV3_11_1A;

/*VF2*/
%tranq(VF2_02_2A VF2_02_2B VF2_02_2C,VF2_02_2_,01 02 03);

%tranq(VF2_09_2A VF2_09_2B VF2_09_2C VF2_09_2D VF2_09_2E VF2_09_2F VF2_09_2G VF2_09_2H VF2_09_2I VF2_09_2J VF2_09_2K VF2_09_2L VF2_09_2M VF2_09_2N VF2_09_2O VF2_09_2P VF2_09_2Q VF2_09_2R VF2_09_2S,VF2_09_2_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 77);
if VF2_09_2A in (98,99) then VF2_09_DKR_2=VF2_09_2A;

%tranq(VF2_26_2A VF2_26_2B VF2_26_2C VF2_26_2D VF2_26_2E VF2_26_2F VF2_26_2G VF2_26_2H VF2_26_2I VF2_26_2J VF2_26_2K VF2_26_2L VF2_26_2M VF2_26_2N VF2_26_2O VF2_26_2P VF2_26_2Q ,VF2_26_2_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 77);
if VF2_26_2A in (98,99) then VF2_26_DKR_2=VF2_26_2A;

%tranq(FV2_03_2A FV2_03_2B,FV2_03_2_,01 02 03);
if FV2_03_2A in (98,99) then FV2_03_DKR_2=FV2_03_2A;

%tranq(FV2_04_2A FV2_04_2B FV2_04_2C FV2_04_2D FV2_04_2E FV2_04_2F FV2_04_2G FV2_04_2H,FV2_04_2_,01 02 03 04 05 06 07 77 78);
if FV2_04_2A in (98,99) then FV2_04_DKR_2=FV2_04_2A;

%tranq(FV2_05_2A FV2_05_2B FV2_05_2C FV2_05_2D,FV2_05_2_,01 02 03 77);

%tranq(FV2_08_2A FV2_08_2B FV2_08_2C FV2_08_2D FV2_08_2E,FV2_08_2_,01 02 03 04 77);
if FV2_08_2A in (98,99) then FV2_08_DKR_2=FV2_08_2A;

%tranq(FV2_09_2A FV2_09_2B FV2_09_2C FV2_09_2D FV2_09_2E FV2_09_2F FV2_09_2G FV2_09_2H FV2_09_2I FV2_09_2J FV2_09_2K FV2_09_2L,FV2_09_2_,01 02 03 04 05 06 07 08 09 10 11 77 78);
if FV2_09_2A in (98,99) then FV2_09_DKR_2=FV2_09_2A;

%tranq(VF3_01a_2A VF3_01a_2B VF3_01a_2C,VF3_01a_2_,01 02 03);

%tranq(VF3_13_2A VF3_13_2B VF3_13_2C VF3_13_2D VF3_13_2E VF3_13_2F VF3_13_2G VF3_13_2H VF3_13_2I VF3_13_2J VF3_13_2K VF3_13_2L VF3_13_2M VF3_13_2N VF3_13_2O VF3_13_2P VF3_13_2Q VF3_13_2R VF3_13_2S,VF3_13_2_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 77);
if VF3_13_2A in (98,99) then VF3_13_DKR_2=VF3_13_2A;

%tranq(VF3_24_2A VF3_24_2B,VF3_24_2_,01 02 03);
if VF3_24_2A in (98,99) then VF3_24_DKR_2=VF3_24_2A;

%tranq(VF3_29_2A VF3_29_2B VF3_29_2C VF3_29_2D VF3_29_2E VF3_29_2F VF3_29_2G VF3_29_2H VF3_29_2I VF3_29_2J VF3_29_2K VF3_29_2L VF3_29_2M VF3_29_2N VF3_29_2O VF3_29_2P VF3_29_2Q,VF3_29_2_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 77);
if VF3_29_2A in (98,99) then VF3_29_DKR_2=VF3_29_2A;

%tranq(FV3_05_2A FV3_05_2B,FV3_05_2_,01 02 03);
if FV3_05_2A in (98,99) then FV3_05_DKR_2=FV3_05_2A;

%tranq(FV3_06_2A FV3_06_2B FV3_06_2C FV3_06_2D FV3_06_2E FV3_06_2F FV3_06_2G,FV3_06_2_,01 02 03 04 05 06 07 77 78);
if FV3_06_2A in (98,99) then FV3_06_DKR_2=FV3_06_2A;

%tranq(FV3_07_2A FV3_07_2B FV3_07_2C FV3_07_2D,FV3_07_2_,01 02 03 77);
*if FV3_07_2A in (98,99) then FV3_07_DKR_2=FV3_07_2A;

%tranq(FV3_10_2A FV3_10_2B FV3_10_2C FV3_10_2D,FV3_10_2_,01 02 03 04 77);
if FV3_10_2A in (98,99) then FV3_10_DKR_2=FV3_10_2A;

%tranq(FV3_11_2A FV3_11_2B FV3_11_2C FV3_11_2D FV3_11_2E FV3_11_2F FV3_11_2G FV3_11_2H FV3_11_2I FV3_11_2J FV3_11_2K FV3_11_2L,FV3_11_2_,01 02 03 04 05 06 07 08 09 10 11 77 78);
if FV3_11_2A in (98,99) then FV3_11_DKR_2=FV3_11_2A;

/*VF3*/
%tranq(VF2_02_3A VF2_02_3B VF2_02_3C,VF2_02_3_,01 02 03);

%tranq(VF2_09_3A VF2_09_3B VF2_09_3C VF2_09_3D VF2_09_3E VF2_09_3F VF2_09_3G VF2_09_3H VF2_09_3I VF2_09_3J VF2_09_3K VF2_09_3L VF2_09_3M VF2_09_3N VF2_09_3O VF2_09_3P VF2_09_3Q VF2_09_3R VF2_09_3S,VF2_09_3_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 77);
if VF2_09_3A in (98,99) then VF2_09_DKR_3=VF2_09_3A;

%tranq(VF2_26_3A VF2_26_3B VF2_26_3C VF2_26_3D VF2_26_3E VF2_26_3F VF2_26_3G VF2_26_3H VF2_26_3I VF2_26_3J VF2_26_3K VF2_26_3L VF2_26_3M VF2_26_3N VF2_26_3O VF2_26_3P VF2_26_3Q ,VF2_26_3_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 77);
if VF2_26_3A in (98,99) then VF2_26_DKR_3=VF2_26_3A;

%tranq(FV2_03_3A FV2_03_3B,FV2_03_3_,01 02 03);
if FV2_03_3A in (98,99) then FV2_03_DKR_3=FV2_03_3A;

%tranq(FV2_04_3A FV2_04_3B FV2_04_3C FV2_04_3D FV2_04_3E FV2_04_3F FV2_04_3G FV2_04_3H,FV2_04_3_,01 02 03 04 05 06 07 77 78);
if FV2_04_3A in (98,99) then FV2_04_DKR_3=FV2_04_3A;

%tranq(FV2_05_3A FV2_05_3B FV2_05_3C FV2_05_3D,FV2_05_3_,01 02 03 77);

%tranq(FV2_08_3A FV2_08_3B FV2_08_3C FV2_08_3D FV2_08_3E,FV2_08_3_,01 02 03 04 77);
if FV2_08_3A in (98,99) then FV2_08_DKR_3=FV2_08_3A;

%tranq(FV2_09_3A FV2_09_3B FV2_09_3C FV2_09_3D FV2_09_3E FV2_09_3F FV2_09_3G FV2_09_3H FV2_09_3I FV2_09_3J FV2_09_3K FV2_09_3L,FV2_09_3_,01 02 03 04 05 06 07 08 09 10 11 77 78);
if FV2_09_3A in (98,99) then FV2_09_DKR_3=FV2_09_3A;

%tranq(VF3_01a_3A VF3_01a_3B VF3_01a_3C,VF3_01a_3_,01 02 03);

%tranq(VF3_13_3A VF3_13_3B VF3_13_3C VF3_13_3D VF3_13_3E VF3_13_3F VF3_13_3G VF3_13_3H VF3_13_3I VF3_13_3J VF3_13_3K VF3_13_3L VF3_13_3M VF3_13_3N VF3_13_3O VF3_13_3P VF3_13_3Q VF3_13_3R VF3_13_3S,VF3_13_3_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 77);
if VF3_13_3A in (98,99) then VF3_13_DKR_3=VF3_13_3A;

%tranq(VF3_24_3A VF3_24_3B,VF3_24_3_,01 02 03);
if VF3_24_3A in (98,99) then VF3_24_DKR_3=VF3_24_3A;

%tranq(VF3_29_3A VF3_29_3B VF3_29_3C VF3_29_3D VF3_29_3E VF3_29_3F VF3_29_3G VF3_29_3H VF3_29_3I VF3_29_3J VF3_29_3K VF3_29_3L VF3_29_3M VF3_29_3N VF3_29_3O VF3_29_3P VF3_29_3Q,VF3_29_3_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 77);
if VF3_29_3A in (98,99) then VF3_29_DKR_3=VF3_29_3A;

%tranq(FV3_05_3A FV3_05_3B,FV3_05_3_,01 02 03);
if FV3_05_3A in (98,99) then FV3_05_DKR_3=FV3_05_3A;

%tranq(FV3_06_3A FV3_06_3B FV3_06_3C FV3_06_3D FV3_06_3E FV3_06_3F FV3_06_3G,FV3_06_3_,01 02 03 04 05 06 07 77 78);
if FV3_06_3A in (98,99) then FV3_06_DKR_3=FV3_06_3A;

%tranq(FV3_07_3A FV3_07_3B FV3_07_3C FV3_07_3D,FV3_07_3_,01 02 03 77);
*if FV3_07_3A in (98,99) then FV3_07_DKR_3=FV3_07_3A;

%tranq(FV3_10_3A FV3_10_3B FV3_10_3C FV3_10_3D,FV3_10_3_,01 02 03 04 77);
if FV3_10_3A in (98,99) then FV3_10_DKR_3=FV3_10_3A;

%tranq(FV3_11_3A FV3_11_3B FV3_11_3C FV3_11_3D FV3_11_3E FV3_11_3F FV3_11_3G FV3_11_3H FV3_11_3I FV3_11_3J FV3_11_3K FV3_11_3L,FV3_11_3_,01 02 03 04 05 06 07 08 09 10 11 77 78);
if FV3_11_3A in (98,99) then FV3_11_DKR_3=FV3_11_3A;


/*VF4*/
%tranq(VF2_02_4A VF2_02_4B VF2_02_4C,VF2_02_4_,01 02 03);

%tranq(VF2_09_4A VF2_09_4B VF2_09_4C VF2_09_4D VF2_09_4E VF2_09_4F VF2_09_4G VF2_09_4H VF2_09_4I VF2_09_4J VF2_09_4K VF2_09_4L VF2_09_4M VF2_09_4N VF2_09_4O VF2_09_4P VF2_09_4Q VF2_09_4R VF2_09_4S,VF2_09_4_,01 02 03 04 05 06 07 08 09 10 
11 12 13 14 15 16 17 18 77);
if VF2_09_4A in (98,99) then VF2_09_DKR_4=VF2_09_4A;

%tranq(VF2_26_4A VF2_26_4B VF2_26_4C VF2_26_4D VF2_26_4E VF2_26_4F VF2_26_4G VF2_26_4H VF2_26_4I VF2_26_4J VF2_26_4K VF2_26_4L VF2_26_4M VF2_26_4N VF2_26_4O VF2_26_4P VF2_26_4Q ,VF2_26_4_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 
17 77);
if VF2_26_4A in (98,99) then VF2_26_DKR_4=VF2_26_4A;

%tranq(FV2_03_4A FV2_03_4B,FV2_03_4_,01 02 03);
if FV2_03_4A in (98,99) then FV2_03_DKR_4=FV2_03_4A;

%tranq(FV2_04_4A FV2_04_4B FV2_04_4C FV2_04_4D FV2_04_4E FV2_04_4F FV2_04_4G FV2_04_4H,FV2_04_4_,01 02 03 04 05 06 07 77 78);
if FV2_04_4A in (98,99) then FV2_04_DKR_4=FV2_04_4A;

%tranq(FV2_05_4A FV2_05_4B FV2_05_4C FV2_05_4D,FV2_05_4_,01 02 03 77);

%tranq(FV2_08_4A FV2_08_4B FV2_08_4C FV2_08_4D FV2_08_4E,FV2_08_4_,01 02 03 04 77);
if FV2_08_4A in (98,99) then FV2_08_DKR_4=FV2_08_4A;

%tranq(FV2_09_4A FV2_09_4B FV2_09_4C FV2_09_4D FV2_09_4E FV2_09_4F FV2_09_4G FV2_09_4H FV2_09_4I FV2_09_4J FV2_09_4K FV2_09_4L,FV2_09_4_,01 02 03 04 05 06 07 08 09 10 11 77 78);
if FV2_09_4A in (98,99) then FV2_09_DKR_4=FV2_09_4A;

%tranq(VF3_01a_4A VF3_01a_4B VF3_01a_4C,VF3_01a_4_,01 02 03);

%tranq(VF3_13_4A VF3_13_4B VF3_13_4C VF3_13_4D VF3_13_4E VF3_13_4F VF3_13_4G VF3_13_4H VF3_13_4I VF3_13_4J VF3_13_4K VF3_13_4L VF3_13_4M VF3_13_4N VF3_13_4O VF3_13_4P VF3_13_4Q VF3_13_4R VF3_13_4S,VF3_13_4_,01 02 03 04 05 06 07 08 09 10 
11 12 13 14 15 16 17 18 77);
if VF3_13_4A in (98,99) then VF3_13_DKR_4=VF3_13_4A;

%tranq(VF3_24_4A VF3_24_4B,VF3_24_4_,01 02 03);
if VF3_24_4A in (98,99) then VF3_24_DKR_4=VF3_24_4A;

%tranq(VF3_29_4A VF3_29_4B VF3_29_4C VF3_29_4D VF3_29_4E VF3_29_4F VF3_29_4G VF3_29_4H VF3_29_4I VF3_29_4J VF3_29_4K VF3_29_4L VF3_29_4M VF3_29_4N VF3_29_4O VF3_29_4P VF3_29_4Q,VF3_29_4_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 
77);
if VF3_29_4A in (98,99) then VF3_29_DKR_4=VF3_29_4A;

%tranq(FV3_05_4A FV3_05_4B,FV3_05_4_,01 02 03);
if FV3_05_4A in (98,99) then FV3_05_DKR_4=FV3_05_4A;

%tranq(FV3_06_4A FV3_06_4B FV3_06_4C FV3_06_4D FV3_06_4E FV3_06_4F FV3_06_4G,FV3_06_4_,01 02 03 04 05 06 07 77 78);
if FV3_06_4A in (98,99) then FV3_06_DKR_4=FV3_06_4A;

%tranq(FV3_07_4A FV3_07_4B FV3_07_4C FV3_07_4D,FV3_07_4_,01 02 03 77);
*if FV3_07_4A in (98,99) then FV3_07_DKR_4=FV3_07_4A;

%tranq(FV3_10_4A FV3_10_4B FV3_10_4C FV3_10_4D,FV3_10_4_,01 02 03 04 77);
if FV3_10_4A in (98,99) then FV3_10_DKR_4=FV3_10_4A;

%tranq(FV3_11_4A FV3_11_4B FV3_11_4C FV3_11_4D FV3_11_4E FV3_11_4F FV3_11_4G FV3_11_4H FV3_11_4I FV3_11_4J FV3_11_4K FV3_11_4L,FV3_11_4_,01 02 03 04 05 06 07 08 09 10 11 77 78);
if FV3_11_4A in (98,99) then FV3_11_DKR_4=FV3_11_4A;



/*VF5*/
%tranq(VF2_02_5A VF2_02_5B VF2_02_5C,VF2_02_5_,01 02 03);

%tranq(VF2_09_5A VF2_09_5B VF2_09_5C VF2_09_5D VF2_09_5E VF2_09_5F VF2_09_5G VF2_09_5H VF2_09_5I VF2_09_5J VF2_09_5K VF2_09_5L VF2_09_5M VF2_09_5N VF2_09_5O VF2_09_5P VF2_09_5Q VF2_09_5R VF2_09_5S,VF2_09_5_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 77);
if VF2_09_5A in (98,99) then VF2_09_DKR_5=VF2_09_5A;

%tranq(VF2_26_5A VF2_26_5B VF2_26_5C VF2_26_5D VF2_26_5E VF2_26_5F VF2_26_5G VF2_26_5H VF2_26_5I VF2_26_5J VF2_26_5K VF2_26_5L VF2_26_5M VF2_26_5N VF2_26_5O VF2_26_5P VF2_26_5Q ,VF2_26_5_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 77);
if VF2_26_5A in (98,99) then VF2_26_DKR_5=VF2_26_5A;

%tranq(FV2_03_5A FV2_03_5B,FV2_03_5_,01 02 03);
if FV2_03_5A in (98,99) then FV2_03_DKR_5=FV2_03_5A;

%tranq(FV2_04_5A FV2_04_5B FV2_04_5C FV2_04_5D FV2_04_5E FV2_04_5F FV2_04_5G FV2_04_5H,FV2_04_5_,01 02 03 04 05 06 07 77 78);
if FV2_04_5A in (98,99) then FV2_04_DKR_5=FV2_04_5A;

%tranq(FV2_05_5A FV2_05_5B FV2_05_5C FV2_05_5D,FV2_05_5_,01 02 03 77);

%tranq(FV2_08_5A FV2_08_5B FV2_08_5C FV2_08_5D FV2_08_5E,FV2_08_5_,01 02 03 04 77);
if FV2_08_5A in (98,99) then FV2_08_DKR_5=FV2_08_5A;

%tranq(FV2_09_5A FV2_09_5B FV2_09_5C FV2_09_5D FV2_09_5E FV2_09_5F FV2_09_5G FV2_09_5H FV2_09_5I FV2_09_5J FV2_09_5K FV2_09_5L,FV2_09_5_,01 02 03 04 05 06 07 08 09 10 11 77 78);
if FV2_09_5A in (98,99) then FV2_09_DKR_5=FV2_09_5A;

%tranq(VF3_01a_5A VF3_01a_5B VF3_01a_5C,VF3_01a_5_,01 02 03);

%tranq(VF3_13_5A VF3_13_5B VF3_13_5C VF3_13_5D VF3_13_5E VF3_13_5F VF3_13_5G VF3_13_5H VF3_13_5I VF3_13_5J VF3_13_5K VF3_13_5L VF3_13_5M VF3_13_5N VF3_13_5O VF3_13_5P VF3_13_5Q VF3_13_5R VF3_13_5S,VF3_13_5_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 77);
if VF3_13_5A in (98,99) then VF3_13_DKR_5=VF3_13_5A;

%tranq(VF3_24_5A VF3_24_5B,VF3_24_5_,01 02 03);
if VF3_24_5A in (98,99) then VF3_24_DKR_5=VF3_24_5A;

%tranq(VF3_29_5A VF3_29_5B VF3_29_5C VF3_29_5D VF3_29_5E VF3_29_5F VF3_29_5G VF3_29_5H VF3_29_5I VF3_29_5J VF3_29_5K VF3_29_5L VF3_29_5M VF3_29_5N VF3_29_5O VF3_29_5P VF3_29_5Q,VF3_29_5_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 77);
if VF3_29_5A in (98,99) then VF3_29_DKR_5=VF3_29_5A;

%tranq(FV3_05_5A FV3_05_5B,FV3_05_5_,01 02 03);
if FV3_05_5A in (98,99) then FV3_05_DKR_5=FV3_05_5A;

%tranq(FV3_06_5A FV3_06_5B FV3_06_5C FV3_06_5D FV3_06_5E FV3_06_5F FV3_06_5G,FV3_06_5_,01 02 03 04 05 06 07 77 78);
if FV3_06_5A in (98,99) then FV3_06_DKR_5=FV3_06_5A;

%tranq(FV3_07_5A FV3_07_5B FV3_07_5C FV3_07_5D,FV3_07_5_,01 02 03 77);
*if FV3_07_5A in (98,99) then FV3_07_DKR_5=FV3_07_5A;

%tranq(FV3_10_5A FV3_10_5B FV3_10_5C FV3_10_5D,FV3_10_5_,01 02 03 04 77);
if FV3_10_5A in (98,99) then FV3_10_DKR_5=FV3_10_5A;

%tranq(FV3_11_5A FV3_11_5B FV3_11_5C FV3_11_5D FV3_11_5E FV3_11_5F FV3_11_5G FV3_11_5H FV3_11_5I FV3_11_5J FV3_11_5K FV3_11_5L,FV3_11_5_,01 02 03 04 05 06 07 08 09 10 11 77 78);
if FV3_11_5A in (98,99) then FV3_11_DKR_5=FV3_11_5A;



/*VF6*/
%tranq(VF2_02_6A VF2_02_6B VF2_02_6C,VF2_02_6_,01 02 03);

%tranq(VF2_09_6A VF2_09_6B VF2_09_6C VF2_09_6D VF2_09_6E VF2_09_6F VF2_09_6G VF2_09_6H VF2_09_6I VF2_09_6J VF2_09_6K VF2_09_6L VF2_09_6M VF2_09_6N VF2_09_6O VF2_09_6P VF2_09_6Q VF2_09_6R VF2_09_6S,VF2_09_6_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 77);
if VF2_09_6A in (98,99) then VF2_09_DKR_6=VF2_09_6A;

%tranq(VF2_26_6A VF2_26_6B VF2_26_6C VF2_26_6D VF2_26_6E VF2_26_6F VF2_26_6G VF2_26_6H VF2_26_6I VF2_26_6J VF2_26_6K VF2_26_6L VF2_26_6M VF2_26_6N VF2_26_6O VF2_26_6P VF2_26_6Q ,VF2_26_6_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 77);
if VF2_26_6A in (98,99) then VF2_26_DKR_6=VF2_26_6A;

%tranq(FV2_03_6A FV2_03_6B,FV2_03_6_,01 02 03);
if FV2_03_6A in (98,99) then FV2_03_DKR_6=FV2_03_6A;

%tranq(FV2_04_6A FV2_04_6B FV2_04_6C FV2_04_6D FV2_04_6E FV2_04_6F FV2_04_6G FV2_04_6H,FV2_04_6_,01 02 03 04 05 06 07 77 78);
if FV2_04_6A in (98,99) then FV2_04_DKR_6=FV2_04_6A;

%tranq(FV2_05_6A FV2_05_6B FV2_05_6C FV2_05_6D,FV2_05_6_,01 02 03 77);

%tranq(FV2_08_6A FV2_08_6B FV2_08_6C FV2_08_6D FV2_08_6E,FV2_08_6_,01 02 03 04 77);
if FV2_08_6A in (98,99) then FV2_08_DKR_6=FV2_08_6A;

%tranq(FV2_09_6A FV2_09_6B FV2_09_6C FV2_09_6D FV2_09_6E FV2_09_6F FV2_09_6G FV2_09_6H FV2_09_6I FV2_09_6J FV2_09_6K FV2_09_6L,FV2_09_6_,01 02 03 04 05 06 07 08 09 10 11 77 78);
if FV2_09_6A in (98,99) then FV2_09_DKR_6=FV2_09_6A;

%tranq(VF3_01a_6A VF3_01a_6B VF3_01a_6C,VF3_01a_6_,01 02 03);

%tranq(VF3_13_6A VF3_13_6B VF3_13_6C VF3_13_6D VF3_13_6E VF3_13_6F VF3_13_6G VF3_13_6H VF3_13_6I VF3_13_6J VF3_13_6K VF3_13_6L VF3_13_6M VF3_13_6N VF3_13_6O VF3_13_6P VF3_13_6Q VF3_13_6R VF3_13_6S,VF3_13_6_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 77);
if VF3_13_6A in (98,99) then VF3_13_DKR_6=VF3_13_6A;

%tranq(VF3_24_6A VF3_24_6B,VF3_24_6_,01 02 03);
if VF3_24_6A in (98,99) then VF3_24_DKR_6=VF3_24_6A;

%tranq(VF3_29_6A VF3_29_6B VF3_29_6C VF3_29_6D VF3_29_6E VF3_29_6F VF3_29_6G VF3_29_6H VF3_29_6I VF3_29_6J VF3_29_6K VF3_29_6L VF3_29_6M VF3_29_6N VF3_29_6O VF3_29_6P VF3_29_6Q,VF3_29_6_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 77);
if VF3_29_6A in (98,99) then VF3_29_DKR_6=VF3_29_6A;

%tranq(FV3_05_6A FV3_05_6B,FV3_05_6_,01 02 03);
if FV3_05_6A in (98,99) then FV3_05_DKR_6=FV3_05_6A;

%tranq(FV3_06_6A FV3_06_6B FV3_06_6C FV3_06_6D FV3_06_6E FV3_06_6F FV3_06_6G FV3_06_6H FV3_06_6I FV3_06_6J FV3_06_6K FV3_06_6L,FV3_06_6_,01 02 03 04 05 06 07 77 78);
if FV3_06_6A in (98,99) then FV3_06_DKR_6=FV3_06_6A;

%tranq(FV3_07_6A FV3_07_6B FV3_07_6C FV3_07_6D,FV3_07_6_,01 02 03 77);
*if FV3_07_6A in (98,99) then FV3_07_DKR_6=FV3_07_6A;

%tranq(FV3_10_6A FV3_10_6B FV3_10_6C FV3_10_6D,FV3_10_6_,01 02 03 04 77);
if FV3_10_6A in (98,99) then FV3_10_DKR_6=FV3_10_6A;

%tranq(FV3_11_6A FV3_11_6B FV3_11_6C FV3_11_6D FV3_11_6E FV3_11_6F FV3_11_6G FV3_11_6H FV3_11_6I FV3_11_6J FV3_11_6K FV3_11_6L,FV3_11_6_,01 02 03 04 05 06 07 08 09 10 11 77 78);
if FV3_11_6A in (98,99) then FV3_11_DKR_6=FV3_11_6A;


/*VF7*/
%tranq(VF2_02_7A VF2_02_7B VF2_02_7C,VF2_02_7_,01 02 03);

%tranq(VF2_09_7A VF2_09_7B VF2_09_7C VF2_09_7D VF2_09_7E VF2_09_7F VF2_09_7G VF2_09_7H VF2_09_7I VF2_09_7J VF2_09_7K VF2_09_7L VF2_09_7M VF2_09_7N VF2_09_7O VF2_09_7P VF2_09_7Q VF2_09_7R VF2_09_7S,VF2_09_7_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 77);
if VF2_09_7A in (98,99) then VF2_09_DKR_7=VF2_09_7A;

%tranq(VF2_26_7A VF2_26_7B VF2_26_7C VF2_26_7D VF2_26_7E VF2_26_7F VF2_26_7G VF2_26_7H VF2_26_7I VF2_26_7J VF2_26_7K VF2_26_7L VF2_26_7M VF2_26_7N VF2_26_7O VF2_26_7P VF2_26_7Q ,VF2_26_7_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 77);
if VF2_26_7A in (98,99) then VF2_26_DKR_7=VF2_26_7A;

%tranq(FV2_03_7A FV2_03_7B,FV2_03_7_,01 02 03);
if FV2_03_7A in (98,99) then FV2_03_DKR_7=FV2_03_7A;

%tranq(FV2_04_7A FV2_04_7B FV2_04_7C FV2_04_7D FV2_04_7E FV2_04_7F FV2_04_7G FV2_04_7H,FV2_04_7_,01 02 03 04 05 06 07 77 78);
if FV2_04_7A in (98,99) then FV2_04_DKR_7=FV2_04_7A;

%tranq(FV2_05_7A FV2_05_7B FV2_05_7C FV2_05_7D,FV2_05_7_,01 02 03 77);

%tranq(FV2_08_7A FV2_08_7B FV2_08_7C FV2_08_7D FV2_08_7E,FV2_08_7_,01 02 03 04 77);
if FV2_08_7A in (98,99) then FV2_08_DKR_7=FV2_08_7A;

%tranq(FV2_09_7A FV2_09_7B FV2_09_7C FV2_09_7D FV2_09_7E FV2_09_7F FV2_09_7G FV2_09_7H FV2_09_7I FV2_09_7J FV2_09_7K FV2_09_7L,FV2_09_7_,01 02 03 04 05 06 07 08 09 10 11 77 78);
if FV2_09_7A in (98,99) then FV2_09_DKR_7=FV2_09_7A;

%tranq(VF3_01a_7A VF3_01a_7B VF3_01a_7C,VF3_01a_7_,01 02 03);

%tranq(VF3_13_7A VF3_13_7B VF3_13_7C VF3_13_7D VF3_13_7E VF3_13_7F VF3_13_7G VF3_13_7H VF3_13_7I VF3_13_7J VF3_13_7K VF3_13_7L VF3_13_7M VF3_13_7N VF3_13_7O VF3_13_7P VF3_13_7Q VF3_13_7R VF3_13_7S,VF3_13_7_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 77);
if VF3_13_7A in (98,99) then VF3_13_DKR_7=VF3_13_7A;

%tranq(VF3_24_7A VF3_24_7B,VF3_24_7_,01 02 03);
if VF3_24_7A in (98,99) then VF3_24_DKR_7=VF3_24_7A;

%tranq(VF3_29_7A VF3_29_7B VF3_29_7C VF3_29_7D VF3_29_7E VF3_29_7F VF3_29_7G VF3_29_7H VF3_29_7I VF3_29_7J VF3_29_7K VF3_29_7L VF3_29_7M VF3_29_7N VF3_29_7O VF3_29_7P VF3_29_7Q,VF3_29_7_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 77);
if VF3_29_7A in (98,99) then VF3_29_DKR_7=VF3_29_7A;

%tranq(FV3_05_7A FV3_05_7B,FV3_05_7_,01 02 03);
if FV3_05_7A in (98,99) then FV3_05_DKR_7=FV3_05_7A;

%tranq(FV3_06_7A FV3_06_7B FV3_06_7C FV3_06_7D FV3_06_7E FV3_06_7F FV3_06_7G,FV3_06_7_,01 02 03 04 05 06 07 77 78);
if FV3_06_7A in (98,99) then FV3_06_DKR_7=FV3_06_7A;

%tranq(FV3_07_7A FV3_07_7B FV3_07_7C FV3_07_7D,FV3_07_7_,01 02 03 77);
*if FV3_07_7A in (98,99) then FV3_07_DKR_7=FV3_07_7A;

%tranq(FV3_10_7A FV3_10_7B FV3_10_7C FV3_10_7D,FV3_10_7_,01 02 03 04 77);
if FV3_10_7A in (98,99) then FV3_10_DKR_7=FV3_10_7A;

%tranq(FV3_11_7A FV3_11_7B FV3_11_7C FV3_11_7D FV3_11_7E FV3_11_7F FV3_11_7G FV3_11_7H FV3_11_7I FV3_11_7J FV3_11_7K FV3_11_7L,FV3_11_7_,01 02 03 04 05 06 07 08 09 10 11 77 78);
if FV3_11_7A in (98,99) then FV3_11_DKR_7=FV3_11_7A;



/*VF8*/
%tranq(VF2_02_8A VF2_02_8B VF2_02_8C,VF2_02_8_,01 02 03);

%tranq(VF2_09_8A VF2_09_8B VF2_09_8C VF2_09_8D VF2_09_8E VF2_09_8F VF2_09_8G VF2_09_8H VF2_09_8I VF2_09_8J VF2_09_8K VF2_09_8L VF2_09_8M VF2_09_8N VF2_09_8O VF2_09_8P VF2_09_8Q VF2_09_8R VF2_09_8S,VF2_09_8_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 77);
if VF2_09_8A in (98,99) then VF2_09_DKR_8=VF2_09_8A;

%tranq(VF2_26_8A VF2_26_8B VF2_26_8C VF2_26_8D VF2_26_8E VF2_26_8F VF2_26_8G VF2_26_8H VF2_26_8I VF2_26_8J VF2_26_8K VF2_26_8L VF2_26_8M VF2_26_8N VF2_26_8O VF2_26_8P VF2_26_8Q ,VF2_26_8_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 77);
if VF2_26_8A in (98,99) then VF2_26_DKR_8=VF2_26_8A;

%tranq(FV2_03_8A FV2_03_8B,FV2_03_8_,01 02 03);
if FV2_03_8A in (98,99) then FV2_03_DKR_8=FV2_03_8A;

%tranq(FV2_04_8A FV2_04_8B FV2_04_8C FV2_04_8D FV2_04_8E FV2_04_8F FV2_04_8G FV2_04_8H,FV2_04_8_,01 02 03 04 05 06 07 77 78);
if FV2_04_8A in (98,99) then FV2_04_DKR_8=FV2_04_8A;

%tranq(FV2_05_8A FV2_05_8B FV2_05_8C FV2_05_8D,FV2_05_8_,01 02 03 77);

%tranq(FV2_08_8A FV2_08_8B FV2_08_8C FV2_08_8D FV2_08_8E,FV2_08_8_,01 02 03 04 77);
if FV2_08_8A in (98,99) then FV2_08_DKR_8=FV2_08_8A;

%tranq(FV2_09_8A FV2_09_8B FV2_09_8C FV2_09_8D FV2_09_8E FV2_09_8F FV2_09_8G FV2_09_8H FV2_09_8I FV2_09_8J FV2_09_8K FV2_09_8L,FV2_09_8_,01 02 03 04 05 06 07 08 09 10 11 77 78);
if FV2_09_8A in (98,99) then FV2_09_DKR_8=FV2_09_8A;

%tranq(VF3_01a_8A VF3_01a_8B VF3_01a_8C,VF3_01a_8_,01 02 03);

%tranq(VF3_13_8A VF3_13_8B VF3_13_8C VF3_13_8D VF3_13_8E VF3_13_8F VF3_13_8G VF3_13_8H VF3_13_8I VF3_13_8J VF3_13_8K VF3_13_8L VF3_13_8M VF3_13_8N VF3_13_8O VF3_13_8P VF3_13_8Q VF3_13_8R VF3_13_8S,VF3_13_8_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 18 77);
if VF3_13_8A in (98,99) then VF3_13_DKR_8=VF3_13_8A;

%tranq(VF3_24_8A VF3_24_8B,VF3_24_8_,01 02 03);
if VF3_24_8A in (98,99) then VF3_24_DKR_8=VF3_24_8A;

%tranq(VF3_29_8A VF3_29_8B VF3_29_8C VF3_29_8D VF3_29_8E VF3_29_8F VF3_29_8G VF3_29_8H VF3_29_8I VF3_29_8J VF3_29_8K VF3_29_8L VF3_29_8M VF3_29_8N VF3_29_8O VF3_29_8P VF3_29_8Q,VF3_29_8_,01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16 17 77);
if VF3_29_8A in (98,99) then VF3_29_DKR_8=VF3_29_8A;

%tranq(FV3_05_8A FV3_05_8B,FV3_05_8_,01 02 03);
if FV3_05_8A in (98,99) then FV3_05_DKR_8=FV3_05_8A;

%tranq(FV3_06_8A FV3_06_8B FV3_06_8C FV3_06_8D FV3_06_8E FV3_06_8F FV3_06_8G,FV3_06_8_,01 02 03 04 05 06 07 77 78);
if FV3_06_8A in (98,99) then FV3_06_DKR_8=FV3_06_8A;

%tranq(FV3_07_8A FV3_07_8B FV3_07_8C FV3_07_8D,FV3_07_8_,01 02 03 77);
*if FV3_07_8A in (98,99) then FV3_07_DKR_8=FV3_07_8A;

%tranq(FV3_10_8A FV3_10_8B FV3_10_8C FV3_10_8D,FV3_10_8_,01 02 03 04 77);
if FV3_10_8A in (98,99) then FV3_10_DKR_8=FV3_10_8A;

%tranq(FV3_11_8A FV3_11_8B FV3_11_8C FV3_11_8D FV3_11_8E FV3_11_8F FV3_11_8G FV3_11_8H FV3_11_8I FV3_11_8J FV3_11_8K FV3_11_8L,FV3_11_8_,01 02 03 04 05 06 07 08 09 10 11 77 78);
if FV3_11_8A in (98,99) then FV3_11_DKR_8=FV3_11_8A;

%tranq(MD1_01A MD1_01B MD1_01C MD1_01D MD1_01E MD1_01F MD1_01G MD1_01H MD1_01I,MD1_01_,01 02 03 04 05 06 07 08 77);
if MD1_01A in (98,99) then MD1_01_DKR=MD1_01A;



/*WT section*/
%tranq(WT4_01A WT4_01B WT4_01C WT4_01D WT4_01E WT4_01F WT4_01G WT4_01H WT4_01I WT4_01J WT4_01K WT4_01L WT4_01M WT4_01N WT4_01O WT4_01P WT4_01Q WT4_01R WT4_01S WT4_01T WT4_01U WT4_01V WT4_01W WT4_01X ,WT4_01_, 01 02 03 04 05 06 07 08 77 78);
if WT4_01A in (98,99) then WT4_01_DKR=WT4_01A;

%tranq(WT8_03A WT8_03B WT8_03C,WT8_03_, 01 02 03 04 05);
if WT8_03A in (98,99) then WT8_03_DKR=WT8_03A;

%tranq(WT9_01A WT9_01B WT9_01C WT9_01D WT9_01E WT9_01F WT9_01G WT9_01H WT9_01I WT9_01J WT9_01K WT9_01L WT9_01M WT9_01N WT9_01O WT9_01P WT9_01Q WT9_01R WT9_01S WT9_01T WT9_01U WT9_01V WT9_01W WT9_01X ,WT9_01_, 01 02 03 04 05 06 07 08 09 77 78);
if WT9_01A in (98,99) then WT9_01_DKR=WT9_01A;

drop ID1_04aA ID1_04aB ID1_04bA ID1_04bB
ID1_05A ID1_05B
VS9_01_Intro5A VS9_01_Intro5B VS9_01_Intro5C VS9_01_Intro5D VS9_01_Intro5E VS9_01_Intro5F VS9_01_Intro5G VS9_01_Intro5H
/*MD*/
/*MD1_01A MD1_01B MD1_01C MD1_01D MD1_01E MD1_01F MD1_01G MD1_01H MD1_01I*/

/*WT*/
WT4_01A WT4_01B WT4_01C WT4_01D WT4_01E WT4_01F WT4_01G WT4_01H WT4_01I WT4_01J WT4_01K WT4_01L WT4_01M WT4_01N WT4_01O WT4_01P WT4_01Q WT4_01R WT4_01S WT4_01T WT4_01U WT4_01V WT4_01W WT4_01X
WT8_03A WT8_03B WT8_03C
WT9_01A WT9_01B WT9_01C WT9_01D WT9_01E WT9_01F WT9_01G WT9_01H WT9_01I WT9_01J WT9_01K WT9_01L WT9_01M WT9_01N WT9_01O WT9_01P WT9_01Q WT9_01R WT9_01S WT9_01T WT9_01U WT9_01V WT9_01W WT9_01X
VS9_01_Intro8A VS9_01_Intro8B
/*VF1 section*/
VF2_02_1A VF2_02_1B VF2_02_1C
VF2_09_1A VF2_09_1B VF2_09_1C VF2_09_1D VF2_09_1E VF2_09_1F VF2_09_1G VF2_09_1H VF2_09_1I VF2_09_1J VF2_09_1K VF2_09_1L VF2_09_1M VF2_09_1N VF2_09_1O VF2_09_1P VF2_09_1Q VF2_09_1R VF2_09_1S
VF2_26_1A VF2_26_1B VF2_26_1C VF2_26_1D VF2_26_1E VF2_26_1F VF2_26_1G VF2_26_1H VF2_26_1I VF2_26_1J VF2_26_1K VF2_26_1L VF2_26_1M VF2_26_1N VF2_26_1O VF2_26_1P VF2_26_1Q
FV2_03_1A FV2_03_1B
FV2_04_1A FV2_04_1B FV2_04_1C FV2_04_1D FV2_04_1E FV2_04_1F FV2_04_1G FV2_04_1H
FV2_05_1A FV2_05_1B FV2_05_1C FV2_05_1D
FV2_08_1A FV2_08_1B FV2_08_1C FV2_08_1D FV2_08_1E
FV2_09_1A FV2_09_1B FV2_09_1C FV2_09_1D FV2_09_1E FV2_09_1F FV2_09_1G FV2_09_1H FV2_09_1I FV2_09_1J FV2_09_1K FV2_09_1L
VF3_01a_1A VF3_01a_1B VF3_01a_1C
VF3_13_1A VF3_13_1B VF3_13_1C VF3_13_1D VF3_13_1E VF3_13_1F VF3_13_1G VF3_13_1H VF3_13_1I VF3_13_1J VF3_13_1K VF3_13_1L VF3_13_1M VF3_13_1N VF3_13_1O VF3_13_1P VF3_13_1Q VF3_13_1R VF3_13_1S
VF3_24_1A VF3_24_1B
VF3_29_1A VF3_29_1B VF3_29_1C VF3_29_1D VF3_29_1E VF3_29_1F VF3_29_1G VF3_29_1H VF3_29_1I VF3_29_1J VF3_29_1K VF3_29_1L VF3_29_1M VF3_29_1N VF3_29_1O VF3_29_1P VF3_29_1Q
FV3_05_1A FV3_05_1B
FV3_06_1A FV3_06_1B FV3_06_1C FV3_06_1D FV3_06_1E FV3_06_1F FV3_06_1G
FV3_07_1A FV3_07_1B FV3_07_1C FV3_07_1D
FV3_10_1A FV3_10_1B FV3_10_1C FV3_10_1D
FV3_11_1A FV3_11_1B FV3_11_1C FV3_11_1D FV3_11_1E FV3_11_1F FV3_11_1G FV3_11_1H FV3_11_1I FV3_11_1J FV3_11_1K FV3_11_1L

/*VF2*/
VF2_02_2A VF2_02_2B VF2_02_2C
VF2_09_2A VF2_09_2B VF2_09_2C VF2_09_2D VF2_09_2E VF2_09_2F VF2_09_2G VF2_09_2H VF2_09_2I VF2_09_2J VF2_09_2K VF2_09_2L VF2_09_2M VF2_09_2N VF2_09_2O VF2_09_2P VF2_09_2Q 
VF2_09_2R VF2_09_2S
VF2_26_2A VF2_26_2B VF2_26_2C VF2_26_2D VF2_26_2E VF2_26_2F VF2_26_2G VF2_26_2H VF2_26_2I VF2_26_2J VF2_26_2K VF2_26_2L VF2_26_2M VF2_26_2N VF2_26_2O VF2_26_2P VF2_26_2Q
FV2_03_2A FV2_03_2B
FV2_04_2A FV2_04_2B FV2_04_2C FV2_04_2D FV2_04_2E FV2_04_2F FV2_04_2G FV2_04_2H
FV2_05_2A FV2_05_2B FV2_05_2C FV2_05_2D
FV2_08_2A FV2_08_2B FV2_08_2C FV2_08_2D FV2_08_2E
FV2_09_2A FV2_09_2B FV2_09_2C FV2_09_2D FV2_09_2E FV2_09_2F FV2_09_2G FV2_09_2H FV2_09_2I FV2_09_2J FV2_09_2K FV2_09_2L
VF3_01a_2A VF3_01a_2B VF3_01a_2C
VF3_13_2A VF3_13_2B VF3_13_2C VF3_13_2D VF3_13_2E VF3_13_2F VF3_13_2G VF3_13_2H VF3_13_2I VF3_13_2J VF3_13_2K VF3_13_2L VF3_13_2M VF3_13_2N VF3_13_2O VF3_13_2P VF3_13_2Q 
VF3_13_2R VF3_13_2S
VF3_24_2A VF3_24_2B
VF3_29_2A VF3_29_2B VF3_29_2C VF3_29_2D VF3_29_2E VF3_29_2F VF3_29_2G VF3_29_2H VF3_29_2I VF3_29_2J VF3_29_2K VF3_29_2L VF3_29_2M VF3_29_2N VF3_29_2O VF3_29_2P VF3_29_2Q
FV3_05_2A FV3_05_2B
FV3_06_2A FV3_06_2B FV3_06_2C FV3_06_2D FV3_06_2E FV3_06_2F FV3_06_2G
FV3_07_2A FV3_07_2B FV3_07_2C FV3_07_2D
FV3_10_2A FV3_10_2B FV3_10_2C FV3_10_2D
FV3_11_2A FV3_11_2B FV3_11_2C FV3_11_2D FV3_11_2E FV3_11_2F FV3_11_2G FV3_11_2H FV3_11_2I FV3_11_2J FV3_11_2K FV3_11_2L

/*VF3*/
VF2_02_3A VF2_02_3B VF2_02_3C
VF2_09_3A VF2_09_3B VF2_09_3C VF2_09_3D VF2_09_3E VF2_09_3F VF2_09_3G VF2_09_3H VF2_09_3I VF2_09_3J VF2_09_3K VF2_09_3L VF2_09_3M VF2_09_3N VF2_09_3O VF2_09_3P VF2_09_3Q 
VF2_09_3R VF2_09_3S
VF2_26_3A VF2_26_3B VF2_26_3C VF2_26_3D VF2_26_3E VF2_26_3F VF2_26_3G VF2_26_3H VF2_26_3I VF2_26_3J VF2_26_3K VF2_26_3L VF2_26_3M VF2_26_3N VF2_26_3O VF2_26_3P VF2_26_3Q
FV2_03_3A FV2_03_3B
FV2_04_3A FV2_04_3B FV2_04_3C FV2_04_3D FV2_04_3E FV2_04_3F FV2_04_3G FV2_04_3H
FV2_05_3A FV2_05_3B FV2_05_3C FV2_05_3D
FV2_08_3A FV2_08_3B FV2_08_3C FV2_08_3D FV2_08_3E
FV2_09_3A FV2_09_3B FV2_09_3C FV2_09_3D FV2_09_3E FV2_09_3F FV2_09_3G FV2_09_3H FV2_09_3I FV2_09_3J FV2_09_3K FV2_09_3L
VF3_01a_3A VF3_01a_3B VF3_01a_3C
VF3_13_3A VF3_13_3B VF3_13_3C VF3_13_3D VF3_13_3E VF3_13_3F VF3_13_3G VF3_13_3H VF3_13_3I VF3_13_3J VF3_13_3K VF3_13_3L VF3_13_3M VF3_13_3N VF3_13_3O VF3_13_3P VF3_13_3Q 
VF3_13_3R VF3_13_3S
VF3_24_3A VF3_24_3B
VF3_29_3A VF3_29_3B VF3_29_3C VF3_29_3D VF3_29_3E VF3_29_3F VF3_29_3G VF3_29_3H VF3_29_3I VF3_29_3J VF3_29_3K VF3_29_3L VF3_29_3M VF3_29_3N VF3_29_3O VF3_29_3P VF3_29_3Q
FV3_05_3A FV3_05_3B
FV3_06_3A FV3_06_3B FV3_06_3C FV3_06_3D FV3_06_3E FV3_06_3F FV3_06_3G
FV3_07_3A FV3_07_3B FV3_07_3C FV3_07_3D
FV3_10_3A FV3_10_3B FV3_10_3C FV3_10_3D
FV3_11_3A FV3_11_3B FV3_11_3C FV3_11_3D FV3_11_3E FV3_11_3F FV3_11_3G FV3_11_3H FV3_11_3I FV3_11_3J FV3_11_3K FV3_11_3L
/*VF4*/
VF2_02_4A VF2_02_4B VF2_02_4C
VF2_09_4A VF2_09_4B VF2_09_4C VF2_09_4D VF2_09_4E VF2_09_4F VF2_09_4G VF2_09_4H VF2_09_4I VF2_09_4J VF2_09_4K VF2_09_4L VF2_09_4M VF2_09_4N VF2_09_4O VF2_09_4P VF2_09_4Q 
VF2_09_4R VF2_09_4S
VF2_26_4A VF2_26_4B VF2_26_4C VF2_26_4D VF2_26_4E VF2_26_4F VF2_26_4G VF2_26_4H VF2_26_4I VF2_26_4J VF2_26_4K VF2_26_4L VF2_26_4M VF2_26_4N VF2_26_4O VF2_26_4P VF2_26_4Q
FV2_03_4A FV2_03_4B
FV2_04_4A FV2_04_4B FV2_04_4C FV2_04_4D FV2_04_4E FV2_04_4F FV2_04_4G FV2_04_4H
FV2_05_4A FV2_05_4B FV2_05_4C FV2_05_4D
FV2_08_4A FV2_08_4B FV2_08_4C FV2_08_4D FV2_08_4E
FV2_09_4A FV2_09_4B FV2_09_4C FV2_09_4D FV2_09_4E FV2_09_4F FV2_09_4G FV2_09_4H FV2_09_4I FV2_09_4J FV2_09_4K FV2_09_4L
VF3_01a_4A VF3_01a_4B VF3_01a_4C
VF3_13_4A VF3_13_4B VF3_13_4C VF3_13_4D VF3_13_4E VF3_13_4F VF3_13_4G VF3_13_4H VF3_13_4I VF3_13_4J VF3_13_4K VF3_13_4L VF3_13_4M VF3_13_4N VF3_13_4O VF3_13_4P VF3_13_4Q 
VF3_13_4R VF3_13_4S
VF3_24_4A VF3_24_4B
VF3_29_4A VF3_29_4B VF3_29_4C VF3_29_4D VF3_29_4E VF3_29_4F VF3_29_4G VF3_29_4H VF3_29_4I VF3_29_4J VF3_29_4K VF3_29_4L VF3_29_4M VF3_29_4N VF3_29_4O VF3_29_4P VF3_29_4Q
FV3_05_4A FV3_05_4B
FV3_06_4A FV3_06_4B FV3_06_4C FV3_06_4D FV3_06_4E FV3_06_4F FV3_06_4G
FV3_07_4A FV3_07_4B FV3_07_4C FV3_07_4D
FV3_10_4A FV3_10_4B FV3_10_4C FV3_10_4D
FV3_11_4A FV3_11_4B FV3_11_4C FV3_11_4D FV3_11_4E FV3_11_4F FV3_11_4G FV3_11_4H FV3_11_4I FV3_11_4J FV3_11_4K FV3_11_4L
/*VF5*/
VF2_02_5A VF2_02_5B VF2_02_5C
VF2_09_5A VF2_09_5B VF2_09_5C VF2_09_5D VF2_09_5E VF2_09_5F VF2_09_5G VF2_09_5H VF2_09_5I VF2_09_5J VF2_09_5K VF2_09_5L VF2_09_5M VF2_09_5N VF2_09_5O VF2_09_5P VF2_09_5Q 
VF2_09_5R VF2_09_5S
VF2_26_5A VF2_26_5B VF2_26_5C VF2_26_5D VF2_26_5E VF2_26_5F VF2_26_5G VF2_26_5H VF2_26_5I VF2_26_5J VF2_26_5K VF2_26_5L VF2_26_5M VF2_26_5N VF2_26_5O VF2_26_5P VF2_26_5Q
FV2_03_5A FV2_03_5B
FV2_04_5A FV2_04_5B FV2_04_5C FV2_04_5D FV2_04_5E FV2_04_5F FV2_04_5G FV2_04_5H
FV2_05_5A FV2_05_5B FV2_05_5C FV2_05_5D
FV2_08_5A FV2_08_5B FV2_08_5C FV2_08_5D FV2_08_5E
FV2_09_5A FV2_09_5B FV2_09_5C FV2_09_5D FV2_09_5E FV2_09_5F FV2_09_5G FV2_09_5H FV2_09_5I FV2_09_5J FV2_09_5K FV2_09_5L
VF3_01a_5A VF3_01a_5B VF3_01a_5C
VF3_13_5A VF3_13_5B VF3_13_5C VF3_13_5D VF3_13_5E VF3_13_5F VF3_13_5G VF3_13_5H VF3_13_5I VF3_13_5J VF3_13_5K VF3_13_5L VF3_13_5M VF3_13_5N VF3_13_5O VF3_13_5P VF3_13_5Q 
VF3_13_5R VF3_13_5S
VF3_24_5A VF3_24_5B
VF3_29_5A VF3_29_5B VF3_29_5C VF3_29_5D VF3_29_5E VF3_29_5F VF3_29_5G VF3_29_5H VF3_29_5I VF3_29_5J VF3_29_5K VF3_29_5L VF3_29_5M VF3_29_5N VF3_29_5O VF3_29_5P VF3_29_5Q
FV3_05_5A FV3_05_5B
FV3_06_5A FV3_06_5B FV3_06_5C FV3_06_5D FV3_06_5E FV3_06_5F FV3_06_5G
FV3_07_5A FV3_07_5B FV3_07_5C FV3_07_5D
FV3_10_5A FV3_10_5B FV3_10_5C FV3_10_5D
FV3_11_5A FV3_11_5B FV3_11_5C FV3_11_5D FV3_11_5E FV3_11_5F FV3_11_5G FV3_11_5H FV3_11_5I FV3_11_5J FV3_11_5K FV3_11_5L

/*VF6*/
VF2_02_6A VF2_02_6B VF2_02_6C
VF2_09_6A VF2_09_6B VF2_09_6C VF2_09_6D VF2_09_6E VF2_09_6F VF2_09_6G VF2_09_6H VF2_09_6I VF2_09_6J VF2_09_6K VF2_09_6L VF2_09_6M VF2_09_6N VF2_09_6O VF2_09_6P VF2_09_6Q 
VF2_09_6R VF2_09_6S
VF2_26_6A VF2_26_6B VF2_26_6C VF2_26_6D VF2_26_6E VF2_26_6F VF2_26_6G VF2_26_6H VF2_26_6I VF2_26_6J VF2_26_6K VF2_26_6L VF2_26_6M VF2_26_6N VF2_26_6O VF2_26_6P VF2_26_6Q
FV2_03_6A FV2_03_6B
FV2_04_6A FV2_04_6B FV2_04_6C FV2_04_6D FV2_04_6E FV2_04_6F FV2_04_6G FV2_04_6H
FV2_05_6A FV2_05_6B FV2_05_6C FV2_05_6D
FV2_08_6A FV2_08_6B FV2_08_6C FV2_08_6D FV2_08_6E
FV2_09_6A FV2_09_6B FV2_09_6C FV2_09_6D FV2_09_6E FV2_09_6F FV2_09_6G FV2_09_6H FV2_09_6I FV2_09_6J FV2_09_6K FV2_09_6L
VF3_01a_6A VF3_01a_6B VF3_01a_6C
VF3_13_6A VF3_13_6B VF3_13_6C VF3_13_6D VF3_13_6E VF3_13_6F VF3_13_6G VF3_13_6H VF3_13_6I VF3_13_6J VF3_13_6K VF3_13_6L VF3_13_6M VF3_13_6N VF3_13_6O VF3_13_6P VF3_13_6Q 
VF3_13_6R VF3_13_6S
VF3_24_6A VF3_24_6B
VF3_29_6A VF3_29_6B VF3_29_6C VF3_29_6D VF3_29_6E VF3_29_6F VF3_29_6G VF3_29_6H VF3_29_6I VF3_29_6J VF3_29_6K VF3_29_6L VF3_29_6M VF3_29_6N VF3_29_6O VF3_29_6P VF3_29_6Q
FV3_05_6A FV3_05_6B
FV3_06_6A FV3_06_6B FV3_06_6C FV3_06_6D FV3_06_6E FV3_06_6F FV3_06_6G FV3_06_6H FV3_06_6I FV3_06_6J FV3_06_6K FV3_06_6L
FV3_07_6A FV3_07_6B FV3_07_6C FV3_07_6D
FV3_10_6A FV3_10_6B FV3_10_6C FV3_10_6D
FV3_11_6A FV3_11_6B FV3_11_6C FV3_11_6D FV3_11_6E FV3_11_6F FV3_11_6G FV3_11_6H FV3_11_6I FV3_11_6J FV3_11_6K FV3_11_6L

/*VF7*/
VF2_02_7A VF2_02_7B VF2_02_7C
VF2_09_7A VF2_09_7B VF2_09_7C VF2_09_7D VF2_09_7E VF2_09_7F VF2_09_7G VF2_09_7H VF2_09_7I VF2_09_7J VF2_09_7K VF2_09_7L VF2_09_7M VF2_09_7N VF2_09_7O VF2_09_7P VF2_09_7Q 
VF2_09_7R VF2_09_7S
VF2_26_7A VF2_26_7B VF2_26_7C VF2_26_7D VF2_26_7E VF2_26_7F VF2_26_7G VF2_26_7H VF2_26_7I VF2_26_7J VF2_26_7K VF2_26_7L VF2_26_7M VF2_26_7N VF2_26_7O VF2_26_7P VF2_26_7Q
FV2_03_7A FV2_03_7B
FV2_04_7A FV2_04_7B FV2_04_7C FV2_04_7D FV2_04_7E FV2_04_7F FV2_04_7G FV2_04_7H
FV2_05_7A FV2_05_7B FV2_05_7C FV2_05_7D
FV2_08_7A FV2_08_7B FV2_08_7C FV2_08_7D FV2_08_7E
FV2_09_7A FV2_09_7B FV2_09_7C FV2_09_7D FV2_09_7E FV2_09_7F FV2_09_7G FV2_09_7H FV2_09_7I FV2_09_7J FV2_09_7K FV2_09_7L
VF3_01a_7A VF3_01a_7B VF3_01a_7C
VF3_13_7A VF3_13_7B VF3_13_7C VF3_13_7D VF3_13_7E VF3_13_7F VF3_13_7G VF3_13_7H VF3_13_7I VF3_13_7J VF3_13_7K VF3_13_7L VF3_13_7M VF3_13_7N VF3_13_7O VF3_13_7P VF3_13_7Q 
VF3_13_7R VF3_13_7S
VF3_24_7A VF3_24_7B
VF3_29_7A VF3_29_7B VF3_29_7C VF3_29_7D VF3_29_7E VF3_29_7F VF3_29_7G VF3_29_7H VF3_29_7I VF3_29_7J VF3_29_7K VF3_29_7L VF3_29_7M VF3_29_7N VF3_29_7O VF3_29_7P VF3_29_7Q
FV3_05_7A FV3_05_7B
FV3_06_7A FV3_06_7B FV3_06_7C FV3_06_7D FV3_06_7E FV3_06_7F FV3_06_7G
FV3_07_7A FV3_07_7B FV3_07_7C FV3_07_7D
FV3_10_7A FV3_10_7B FV3_10_7C FV3_10_7D
FV3_11_7A FV3_11_7B FV3_11_7C FV3_11_7D FV3_11_7E FV3_11_7F FV3_11_7G FV3_11_7H FV3_11_7I FV3_11_7J FV3_11_7K FV3_11_7L
/*VF8*/
VF2_02_8A VF2_02_8B VF2_02_8C
VF2_09_8A VF2_09_8B VF2_09_8C VF2_09_8D VF2_09_8E VF2_09_8F VF2_09_8G VF2_09_8H VF2_09_8I VF2_09_8J VF2_09_8K VF2_09_8L VF2_09_8M VF2_09_8N VF2_09_8O VF2_09_8P VF2_09_8Q 
VF2_09_8R VF2_09_8S
VF2_26_8A VF2_26_8B VF2_26_8C VF2_26_8D VF2_26_8E VF2_26_8F VF2_26_8G VF2_26_8H VF2_26_8I VF2_26_8J VF2_26_8K VF2_26_8L VF2_26_8M VF2_26_8N VF2_26_8O VF2_26_8P VF2_26_8Q
FV2_03_8A FV2_03_8B
FV2_04_8A FV2_04_8B FV2_04_8C FV2_04_8D FV2_04_8E FV2_04_8F FV2_04_8G FV2_04_8H
FV2_05_8A FV2_05_8B FV2_05_8C FV2_05_8D
FV2_08_8A FV2_08_8B FV2_08_8C FV2_08_8D FV2_08_8E
FV2_09_8A FV2_09_8B FV2_09_8C FV2_09_8D FV2_09_8E FV2_09_8F FV2_09_8G FV2_09_8H FV2_09_8I FV2_09_8J FV2_09_8K FV2_09_8L
VF3_01a_8A VF3_01a_8B VF3_01a_8C
VF3_13_8A VF3_13_8B VF3_13_8C VF3_13_8D VF3_13_8E VF3_13_8F VF3_13_8G VF3_13_8H VF3_13_8I VF3_13_8J VF3_13_8K VF3_13_8L VF3_13_8M VF3_13_8N VF3_13_8O VF3_13_8P VF3_13_8Q 
VF3_13_8R VF3_13_8S
VF3_24_8A VF3_24_8B
VF3_29_8A VF3_29_8B VF3_29_8C VF3_29_8D VF3_29_8E VF3_29_8F VF3_29_8G VF3_29_8H VF3_29_8I VF3_29_8J VF3_29_8K VF3_29_8L VF3_29_8M VF3_29_8N VF3_29_8O VF3_29_8P VF3_29_8Q
FV3_05_8A FV3_05_8B
FV3_06_8A FV3_06_8B FV3_06_8C FV3_06_8D FV3_06_8E FV3_06_8F FV3_06_8G
FV3_07_8A FV3_07_8B FV3_07_8C FV3_07_8D
FV3_10_8A FV3_10_8B FV3_10_8C FV3_10_8D
FV3_11_8A FV3_11_8B FV3_11_8C FV3_11_8D FV3_11_8E FV3_11_8F FV3_11_8G FV3_11_8H FV3_11_8I FV3_11_8J FV3_11_8K FV3_11_8L



;

/*match word doc*/
rename 
/*WT*/
WT4_01_77 = WT4_01_X
WT4_01_78 = WT4_01_N
WT9_01_77 = WT9_01_X
WT9_01_78 = WT9_01_N
/*VF*/
VF2_09_1_77 = VF2_09_1_X
VF2_26_1_77 = VF2_26_1_X
FV2_04_1_77 = FV2_04_1_X
FV2_04_1_78 = FV2_04_1_N
FV2_05_1_77 = FV2_05_1_X
FV2_08_1_77 = FV2_08_1_X
FV2_09_1_77 = FV2_09_1_X
FV2_09_1_78 = FV2_09_1_N
VF3_13_1_77 = VF3_13_1_X
VF3_29_1_77 = VF3_29_1_X
FV3_06_1_77 = FV3_06_1_X
FV3_06_1_78 = FV3_06_1_N
FV3_07_1_77 = FV3_07_1_X
FV3_10_1_77 = FV3_10_1_X
FV3_11_1_77 = FV3_11_1_X
FV3_11_1_78 = FV3_11_1_N


VF2_09_2_77 = VF2_09_2_X
VF2_26_2_77 = VF2_26_2_X
FV2_04_2_77 = FV2_04_2_X
FV2_04_2_78 = FV2_04_2_N
FV2_05_2_77 = FV2_05_2_X
FV2_08_2_77 = FV2_08_2_X
FV2_09_2_77 = FV2_09_2_X
FV2_09_2_78 = FV2_09_2_N
VF3_13_2_77 = VF3_13_2_X
VF3_29_2_77 = VF3_29_2_X
FV3_06_2_77 = FV3_06_2_X
FV3_06_2_78 = FV3_06_2_N
FV3_07_2_77 = FV3_07_2_X
FV3_10_2_77 = FV3_10_2_X
FV3_11_2_77 = FV3_11_2_X
FV3_11_2_78 = FV3_11_2_N


VF2_09_3_77 = VF2_09_3_X
VF2_26_3_77 = VF2_26_3_X
FV2_04_3_77 = FV2_04_3_X
FV2_04_3_78 = FV2_04_3_N
FV2_05_3_77 = FV2_05_3_X
FV2_08_3_77 = FV2_08_3_X
FV2_09_3_77 = FV2_09_3_X
FV2_09_3_78 = FV2_09_3_N
VF3_13_3_77 = VF3_13_3_X
VF3_29_3_77 = VF3_29_3_X
FV3_06_3_77 = FV3_06_3_X
FV3_06_3_78 = FV3_06_3_N
FV3_07_3_77 = FV3_07_3_X
FV3_10_3_77 = FV3_10_3_X
FV3_11_3_77 = FV3_11_3_X
FV3_11_3_78 = FV3_11_3_N

VF2_09_4_77 = VF2_09_4_X
VF2_26_4_77 = VF2_26_4_X
FV2_04_4_77 = FV2_04_4_X
FV2_04_4_78 = FV2_04_4_N
FV2_05_4_77 = FV2_05_4_X
FV2_08_4_77 = FV2_08_4_X
FV2_09_4_77 = FV2_09_4_X
FV2_09_4_78 = FV2_09_4_N
VF3_13_4_77 = VF3_13_4_X
VF3_29_4_77 = VF3_29_4_X
FV3_06_4_77 = FV3_06_4_X
FV3_06_4_78 = FV3_06_4_N
FV3_07_4_77 = FV3_07_4_X
FV3_10_4_77 = FV3_10_4_X
FV3_11_4_77 = FV3_11_4_X
FV3_11_4_78 = FV3_11_4_N


VF2_09_5_77 = VF2_09_5_X
VF2_26_5_77 = VF2_26_5_X
FV2_04_5_77 = FV2_04_5_X
FV2_04_5_78 = FV2_04_5_N
FV2_05_5_77 = FV2_05_5_X
FV2_08_5_77 = FV2_08_5_X
FV2_09_5_77 = FV2_09_5_X
FV2_09_5_78 = FV2_09_5_N
VF3_13_5_77 = VF3_13_5_X
VF3_29_5_77 = VF3_29_5_X
FV3_06_5_77 = FV3_06_5_X
FV3_06_5_78 = FV3_06_5_N
FV3_07_5_77 = FV3_07_5_X
FV3_10_5_77 = FV3_10_5_X
FV3_11_5_77 = FV3_11_5_X
FV3_11_5_78 = FV3_11_5_N


VF2_09_6_77 = VF2_09_6_X
VF2_26_6_77 = VF2_26_6_X
FV2_04_6_77 = FV2_04_6_X
FV2_04_6_78 = FV2_04_6_N
FV2_05_6_77 = FV2_05_6_X
FV2_08_6_77 = FV2_08_6_X
FV2_09_6_77 = FV2_09_6_X
FV2_09_6_78 = FV2_09_6_N
VF3_13_6_77 = VF3_13_6_X
VF3_29_6_77 = VF3_29_6_X
FV3_06_6_77 = FV3_06_6_X
FV3_06_6_78 = FV3_06_6_N
FV3_07_6_77 = FV3_07_6_X
FV3_10_6_77 = FV3_10_6_X
FV3_11_6_77 = FV3_11_6_X
FV3_11_6_78 = FV3_11_6_N



VF2_09_7_77 = VF2_09_7_X
VF2_26_7_77 = VF2_26_7_X
FV2_04_7_77 = FV2_04_7_X
FV2_04_7_78 = FV2_04_7_N
FV2_05_7_77 = FV2_05_7_X
FV2_08_7_77 = FV2_08_7_X
FV2_09_7_77 = FV2_09_7_X
FV2_09_7_78 = FV2_09_7_N
VF3_13_7_77 = VF3_13_7_X
VF3_29_7_77 = VF3_29_7_X
FV3_06_7_77 = FV3_06_7_X
FV3_06_7_78 = FV3_06_7_N
FV3_07_7_77 = FV3_07_7_X
FV3_10_7_77 = FV3_10_7_X
FV3_11_7_77 = FV3_11_7_X
FV3_11_7_78 = FV3_11_7_N



VF2_09_8_77 = VF2_09_8_X
VF2_26_8_77 = VF2_26_8_X
FV2_04_8_77 = FV2_04_8_X
FV2_04_8_78 = FV2_04_8_N
FV2_05_8_77 = FV2_05_8_X
FV2_08_8_77 = FV2_08_8_X
FV2_09_8_77 = FV2_09_8_X
FV2_09_8_78 = FV2_09_8_N
VF3_13_8_77 = VF3_13_8_X
VF3_29_8_77 = VF3_29_8_X
FV3_06_8_77 = FV3_06_8_X
FV3_06_8_78 = FV3_06_8_N
FV3_07_8_77 = FV3_07_8_X
FV3_10_8_77 = FV3_10_8_X
FV3_11_8_77 = FV3_11_8_X
FV3_11_8_78 = FV3_11_8_N
MD1_01_77 = MD1_01_X

;
run;

/*add autocode*/
data nzcvs_flag;
set nzcvs_flag;
/*[if ID1.03=3 and ID1.04=3 and ID1.05=3 and VS9.01=1, autocode FV1.07=1 and FV1.08=1 */
if ID1_03=3 and ID1_04_03=1 and ID1_05_03=1 and VS9_01=1 then do FV1_07=1; FV1_08=1; end;
/*[if VS9.01=1, autocode FV1.07=1 and FV1.08=1 */ 
if VS9_01 = 1 then do FV1_07=1; FV1_08=1; end;
/*[if VS9.05=1 or FV1.07=1, autocode FV1.08=1 */
if VS9_05 = 1 or FV1_07=1 then FV1_08=1;
/*[If offence reference number = 14, autocode VF2.05=17*/
if CurrentVFCode_1=14 and VFType_1=1 then VF2_05_1=17;
if CurrentVFCode_2=14 and VFType_2=1 then VF2_05_2=17;
if CurrentVFCode_3=14 and VFType_3=1 then VF2_05_3=17;
if CurrentVFCode_4=14 and VFType_4=1 then VF2_05_4=17;
if CurrentVFCode_5=14 and VFType_5=1 then VF2_05_5=17;
if CurrentVFCode_6=14 and VFType_6=1 then VF2_05_6=17;
if CurrentVFCode_7=14 and VFType_7=1 then VF2_05_7=17;
if CurrentVFCode_8=14 and VFType_8=1 then VF2_05_8=17;
/*[If offence reference number = 12 or 15-17, autocode VF2.06=100%*/
if CurrentVFCode_1 in (12,15,16,17) and VFtype_1=1 then VF2_06_1=CurrentIncidentsCount_1;
if CurrentVFCode_2 in (12,15,16,17) and VFtype_2=1 then VF2_06_2=CurrentIncidentsCount_2;
if CurrentVFCode_3 in (12,15,16,17) and VFtype_3=1 then VF2_06_3=CurrentIncidentsCount_3;
if CurrentVFCode_4 in (12,15,16,17) and VFtype_4=1 then VF2_06_4=CurrentIncidentsCount_4;
if CurrentVFCode_5 in (12,15,16,17) and VFtype_5=1 then VF2_06_5=CurrentIncidentsCount_5;
if CurrentVFCode_6 in (12,15,16,17) and VFtype_6=1 then VF2_06_6=CurrentIncidentsCount_6;
if CurrentVFCode_7 in (12,15,16,17) and VFtype_7=1 then VF2_06_7=CurrentIncidentsCount_7;
if CurrentVFCode_8 in (12,15,16,17) and VFtype_8=1 then VF2_06_8=CurrentIncidentsCount_8;
/*[If offence reference number = 14, autocode VF3.05=17*/
if CurrentVFCode_1=14 and VFType_1=2 then VF3_05_1=17;
if CurrentVFCode_2=14 and VFType_2=2 then VF3_05_2=17;
if CurrentVFCode_3=14 and VFType_3=2 then VF3_05_3=17;
if CurrentVFCode_4=14 and VFType_4=2 then VF3_05_4=17;
if CurrentVFCode_5=14 and VFType_5=2 then VF3_05_5=17;
if CurrentVFCode_6=14 and VFType_6=2 then VF3_05_6=17;
if CurrentVFCode_7=14 and VFType_7=2 then VF3_05_7=17;
if CurrentVFCode_8=14 and VFType_8=2 then VF3_05_8=17;
/*[If offence reference number = 12 or 15-17 autocode VF3.06=1*/
if CurrentVFCode_1 in (12,15,16,17) and VFtype_1=2 then VF3_06_1=1;
if CurrentVFCode_2 in (12,15,16,17) and VFtype_2=2 then VF3_06_2=1;
if CurrentVFCode_3 in (12,15,16,17) and VFtype_3=2 then VF3_06_3=1;
if CurrentVFCode_4 in (12,15,16,17) and VFtype_4=2 then VF3_06_4=1;
if CurrentVFCode_5 in (12,15,16,17) and VFtype_5=2 then VF3_06_5=1;
if CurrentVFCode_6 in (12,15,16,17) and VFtype_6=2 then VF3_06_6=1;
if CurrentVFCode_7 in (12,15,16,17) and VFtype_7=2 then VF3_06_7=1;
if CurrentVFCode_8 in (12,15,16,17) and VFtype_8=2 then VF3_06_8=1;
/*12.	More than $150,000 [autocode MD4.04=12 and go to MD5.01]*/
if MD4_03 = 12 then MD4_04=12;

run;

/*get occupants*/
data Nzcvsoccupants;
set nzcvs1.Nzcvsoccupants;
adult=0; child=0;
if Age>14 then adult=1; else child=1;
keep qtr psu2015 nzcvshhid Age adult child;
run;

/*get sum of adults and children for each household*/
proc sql;
create table occupants as
select qtr,psu2015,nzcvshhid,sum(adult) as adult_count,sum(child) as child_count
from Nzcvsoccupants
group by qtr, psu2015, nzcvshhid;
quit;

data occupants;
set occupants;
total_people = sum(adult_count,child_count);
keep qtr psu2015 nzcvshhid total_people child_count;
run;

/*add extra variables from our combo*/
data nzcvs_flag;
merge nzcvs_flag(in=in1) nzcvs2.Nzcvsuuids(keep=qtr psu2015 nzcvshhid UUID)
nzcvs2.nzcvscombo(keep=qtr psu2015 nzcvshhid DurationInitialDemographics  DurationScreen DurationVictimForms DurationWellbeingAndTrust DurationMainDemographics  DurationOther 
SubSampleType meshblock2013 UrbanRuralIndicator2018 Region2015 OutcomeMoJ)
occupants
;
by qtr psu2015 nzcvshhid;
if in1;
run;


/*nzdep data*/
data Nzdep2013;
set FSGA2013.Meshblocks2013;
keep meshblock2013 NZDep2013 NZDepScore2013;
run;

proc sort data=nzcvs_flag; by meshblock2013;run;
proc sort data=Nzdep2013; by meshblock2013;run;

data nzcvs_flag;
merge nzcvs_flag(in=in1) Nzdep2013  ;
by meshblock2013;
if in1;
run;

proc sort data=nzcvs_flag; by qtr psu2015 nzcvshhid;run;


/*more tweak*/
data nzcvs_flag;
set nzcvs_flag;

/*recode VF2.02 and VF3.01a base on crime code*/
/*In the TSS this is stored in 1 question with the last option is inserted “smartly”.
option3 will be replaced with actual text depends on the different crime codes.
So in the dataset we will only have values 1 or 2 or 3.
My job here is to recreate option “3” back to option “3” “4” “5”
*/
if VF2_02_1_01 ne . then do VF2_02_1_04=0; VF2_02_1_05=0; end;
if VF2_02_2_01 ne . then do VF2_02_2_04=0; VF2_02_2_05=0; end;
if VF2_02_3_01 ne . then do VF2_02_3_04=0; VF2_02_3_05=0; end;
if VF2_02_4_01 ne . then do VF2_02_4_04=0; VF2_02_4_05=0; end;
if VF2_02_5_01 ne . then do VF2_02_5_04=0; VF2_02_5_05=0; end;
if VF2_02_6_01 ne . then do VF2_02_6_04=0; VF2_02_6_05=0; end;
if VF2_02_7_01 ne . then do VF2_02_7_04=0; VF2_02_7_05=0; end;
if VF2_02_8_01 ne . then do VF2_02_8_04=0; VF2_02_8_05=0; end;

if VF2_02_1_03 = 1 and CurrentVFCode_1 in (1,2,3,4,5,6,7,8,9,11,14) then do VF2_02_1_04=1; VF2_02_1_03=0;end;
if VF2_02_2_03 = 1 and CurrentVFCode_2 in (1,2,3,4,5,6,7,8,9,11,14) then do VF2_02_2_04=1; VF2_02_2_03=0;end;
if VF2_02_3_03 = 1 and CurrentVFCode_3 in (1,2,3,4,5,6,7,8,9,11,14) then do VF2_02_3_04=1; VF2_02_3_03=0;end;
if VF2_02_4_03 = 1 and CurrentVFCode_4 in (1,2,3,4,5,6,7,8,9,11,14) then do VF2_02_4_04=1; VF2_02_4_03=0;end;
if VF2_02_5_03 = 1 and CurrentVFCode_5 in (1,2,3,4,5,6,7,8,9,11,14) then do VF2_02_5_04=1; VF2_02_5_03=0;end;
if VF2_02_6_03 = 1 and CurrentVFCode_6 in (1,2,3,4,5,6,7,8,9,11,14) then do VF2_02_6_04=1; VF2_02_6_03=0;end;
if VF2_02_7_03 = 1 and CurrentVFCode_7 in (1,2,3,4,5,6,7,8,9,11,14) then do VF2_02_7_04=1; VF2_02_7_03=0;end;
if VF2_02_8_03 = 1 and CurrentVFCode_8 in (1,2,3,4,5,6,7,8,9,11,14) then do VF2_02_8_04=1; VF2_02_8_03=0;end;

if VF2_02_1_03 = 1 and CurrentVFCode_1 in (17) then do VF2_02_1_05=1;  VF2_02_1_03=0;end;
if VF2_02_2_03 = 1 and CurrentVFCode_2 in (17) then do VF2_02_2_05=1;  VF2_02_2_03=0;end;
if VF2_02_3_03 = 1 and CurrentVFCode_3 in (17) then do VF2_02_3_05=1;  VF2_02_3_03=0;end;
if VF2_02_4_03 = 1 and CurrentVFCode_4 in (17) then do VF2_02_4_05=1;  VF2_02_4_03=0;end;
if VF2_02_5_03 = 1 and CurrentVFCode_5 in (17) then do VF2_02_5_05=1;  VF2_02_5_03=0;end;
if VF2_02_6_03 = 1 and CurrentVFCode_6 in (17) then do VF2_02_6_05=1;  VF2_02_6_03=0;end;
if VF2_02_7_03 = 1 and CurrentVFCode_7 in (17) then do VF2_02_7_05=1;  VF2_02_7_03=0;end;
if VF2_02_8_03 = 1 and CurrentVFCode_8 in (17) then do VF2_02_8_05=1;  VF2_02_8_03=0;end;

if VF3_01A_1_01 ne . then do VF3_01A_1_04=0; VF3_01A_1_05=0; end;
if VF3_01A_2_01 ne . then do VF3_01A_2_04=0; VF3_01A_2_05=0; end;
if VF3_01A_3_01 ne . then do VF3_01A_3_04=0; VF3_01A_3_05=0; end;
if VF3_01A_4_01 ne . then do VF3_01A_4_04=0; VF3_01A_4_05=0; end;
if VF3_01A_5_01 ne . then do VF3_01A_5_04=0; VF3_01A_5_05=0; end;
if VF3_01A_6_01 ne . then do VF3_01A_6_04=0; VF3_01A_6_05=0; end;
if VF3_01A_7_01 ne . then do VF3_01A_7_04=0; VF3_01A_7_05=0; end;
if VF3_01A_8_01 ne . then do VF3_01A_8_04=0; VF3_01A_8_05=0; end;

if VF3_01A_1_03 = 1 and CurrentVFCode_1 in (1,2,3,4,5,6,7,8,9,11,14) then do  VF3_01A_1_04=1; VF3_01A_1_03=0;end;
if VF3_01A_2_03 = 1 and CurrentVFCode_2 in (1,2,3,4,5,6,7,8,9,11,14) then do  VF3_01A_2_04=1; VF3_01A_2_03=0;end;
if VF3_01A_3_03 = 1 and CurrentVFCode_3 in (1,2,3,4,5,6,7,8,9,11,14) then do  VF3_01A_3_04=1; VF3_01A_3_03=0;end;
if VF3_01A_4_03 = 1 and CurrentVFCode_4 in (1,2,3,4,5,6,7,8,9,11,14) then do  VF3_01A_4_04=1; VF3_01A_4_03=0;end;
if VF3_01A_5_03 = 1 and CurrentVFCode_5 in (1,2,3,4,5,6,7,8,9,11,14) then do  VF3_01A_5_04=1; VF3_01A_5_03=0;end;
if VF3_01A_6_03 = 1 and CurrentVFCode_6 in (1,2,3,4,5,6,7,8,9,11,14) then do  VF3_01A_6_04=1; VF3_01A_6_03=0;end;
if VF3_01A_7_03 = 1 and CurrentVFCode_7 in (1,2,3,4,5,6,7,8,9,11,14) then do  VF3_01A_7_04=1; VF3_01A_7_03=0;end;
if VF3_01A_8_03 = 1 and CurrentVFCode_8 in (1,2,3,4,5,6,7,8,9,11,14) then do  VF3_01A_8_04=1; VF3_01A_8_03=0;end;

if VF3_01A_1_03 = 1 and CurrentVFCode_1 in (17) then do VF3_01A_1_05=1;  VF3_01A_1_03=0;end;
if VF3_01A_2_03 = 1 and CurrentVFCode_2 in (17) then do VF3_01A_2_05=1;  VF3_01A_2_03=0;end;
if VF3_01A_3_03 = 1 and CurrentVFCode_3 in (17) then do VF3_01A_3_05=1;  VF3_01A_3_03=0;end;
if VF3_01A_4_03 = 1 and CurrentVFCode_4 in (17) then do VF3_01A_4_05=1;  VF3_01A_4_03=0;end;
if VF3_01A_5_03 = 1 and CurrentVFCode_5 in (17) then do VF3_01A_5_05=1;  VF3_01A_5_03=0;end;
if VF3_01A_6_03 = 1 and CurrentVFCode_6 in (17) then do VF3_01A_6_05=1;  VF3_01A_6_03=0;end;
if VF3_01A_7_03 = 1 and CurrentVFCode_7 in (17) then do VF3_01A_7_05=1;  VF3_01A_7_03=0;end;
if VF3_01A_8_03 = 1 and CurrentVFCode_8 in (17) then do VF3_01A_8_05=1;  VF3_01A_8_03=0;end;


/*add scenario code1-45*/
if CurrentVFText_1='...someone succeeded, in getting into your home without permission (and no vehicle was stolen/taken at the same time)...' then SCN_1=1;
if CurrentVFText_1='...someone succeeded, in getting into your home without permission, and a vehicle was also stolen/taken at the same time...' then SCN_1=2;
if CurrentVFText_1='...someone tried to get into your home without permission but did not succeed in getting in (and no vehicle was stolen/taken at the same time)...' then SCN_1=3;
if CurrentVFText_1='...someone tried to get into your home without permission but did not succeed in getting in, but a vehicle was also stolen/taken at the same time...' then SCN_1=4;
if CurrentVFText_1='...you or someone else living in your household had a vehicle stolen/taken without permission, (and the vehicle was not parked inside a private yard at the time)...' then SCN_1=5;
if CurrentVFText_1='...you or someone else living in your household had a vehicle stolen/taken without permission, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_1=6;
if CurrentVFText_1='...you or someone else living in your household had a vehicle stolen/taken without permission, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_1=7;
if CurrentVFText_1='...you or someone else living in your household had something stolen from inside, or stolen off a vehicle, (when the vehicle was not parked inside a private yard at the time)...' then SCN_1=8;
if CurrentVFText_1='...you or someone else living in your household had something stolen from inside, or stolen off a vehicle, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_1=9;
if CurrentVFText_1='...you or someone else living in your household had something stolen from inside, or stolen off a vehicle, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_1=10;
if CurrentVFText_1='...you or someone else living in your household had a vehicle tampered with, (when the vehicle was not parked inside a private yard at the time)...' then SCN_1=11;
if CurrentVFText_1='...you or someone else living in your household had a vehicle tampered with, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_1=12;
if CurrentVFText_1='...you or someone else living in your household had a vehicle tampered with, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_1=13;
if CurrentVFText_1='...you or someone else living in your household had a vehicle deliberately damaged or vandalised, (when the vehicle was not parked inside a private yard at the time)...' then SCN_1=14;
if CurrentVFText_1='...you or someone else living in your household had a vehicle deliberately damaged or vandalised, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_1=15;
if CurrentVFText_1='...you or someone else living in your household had a vehicle deliberately damaged or vandalised, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_1=16;
if CurrentVFText_1='...you or someone else living in your household had a bicycle stolen/taken without permission, (when the bicycle was not located inside a private yard at the time)...' then SCN_1=17;
if CurrentVFText_1='...you or someone else living in your household had a bicycle stolen/taken without permission, (when the bicycle was located inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_1=18;
if CurrentVFText_1='...you or someone else living in your household had a bicycle stolen/taken without permission, (when the bicycle was located inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_1=19;
if CurrentVFText_1='...you or someone else living in your household had a bicycle deliberately damaged or vandalised, (when the bicycle was not located inside a private yard at the time)...' then SCN_1=20;
if CurrentVFText_1='...you or someone else living in your household had a bicycle deliberately damaged or vandalised, (when the bicycle was located inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_1=21;
if CurrentVFText_1='...you or someone else living in your household had a bicycle deliberately damaged or vandalised, (when the bicycle was located inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_1=22;
if CurrentVFText_1='...someone deliberately damaged your home, or anything inside or outside your home, belonging to your household...' then SCN_1=23;
if CurrentVFText_1='...someone deliberately damaged something belonging to you personally...' then SCN_1=24;
if CurrentVFText_1='...something was stolen from the outside of your home, (which was not located within a private yard at the time...' then SCN_1=25;
if CurrentVFText_1='...something was stolen from the outside of outside your home, (which was located within a private yard, and the person who did it was allowed to be there...' then SCN_1=26;
if CurrentVFText_1='...something was stolen from the outside of outside your home, (which was located within a private yard, and the person who did it was not allowed to be there...' then SCN_1=27;
if CurrentVFText_1='...something was stolen from inside your home or garage by someone who was allowed to be there...' then SCN_1=28;
if CurrentVFText_1='...someone came into your house or onto the surrounding grounds, without permission or a fair reason to be there...' then SCN_1=29;
if CurrentVFText_1='...someone stole, or tried to steal, something you were carrying, (and the person used, or threatened to use, force or violence at the time)...' then SCN_1=30;
if CurrentVFText_1='...someone stole, or tried to steal, something you were carrying, (and the person did not use, or threaten to use, force or violence at the time)...' then SCN_1=31;
if CurrentVFText_1='...someone stole, or tried to steal, something else that belongs to you personally, such as from an office or anywhere else...' then SCN_1=32;
if CurrentVFText_1='...someone tricked or deceived you, in order to obtain money, goods or a service ...' then SCN_1=33;
if CurrentVFText_1='...someone used or attempted to use a bank card, credit card, cheque or other document belonging to you without your permission, in order to obtain money or credit, or to buy goods or services...' then SCN_1=34;
if CurrentVFText_1='...a computer or Internet-enabled device of belonging to you or a member of your household, was infected or interfered with, (for example by a virus or someone accessing it without your permission)...' then SCN_1=35;
if CurrentVFText_1='...someone forced you, or tried to force you, to have sexual intercourse when you did not want to...' then SCN_1=36;
if CurrentVFText_1='...someone forced you, or tried to force you, to perform a sexual act (excluding sexual intercourse), when you did not want to...' then SCN_1=37;
if CurrentVFText_1='...someone touched you sexually, or tried to touch you sexually, when you did not want them to...' then SCN_1=38;
if CurrentVFText_1='...someone threatened you face-to-face, to do something to you of a sexual nature, that actually frightened you...' then SCN_1=39;
if CurrentVFText_1='...someone deliberately used force or violence on you...' then SCN_1=40;
if CurrentVFText_1='...someone tried to use force or violence on you, or physically harm you, in some way...' then SCN_1=41;
if CurrentVFText_1='...someone threatened to use force or violence on you, or to physically harm you in a way that actually frightened you...' then SCN_1=42;
if CurrentVFText_1='...someone threatened to destroy or damage something belonging to you or your household in a way that caused you fear, alarm or distress...' then SCN_1=43;
if CurrentVFText_1='...someone made a threat to you, to injure any member of your family or whanau, in a way that caused you fear, alarm or distress?...' then SCN_1=44;
if CurrentVFText_1='...someone acted in a way that caused you fear, alarm or distress...' then SCN_1=45;
if CurrentVFText_1='...you experienced some other types of crime...' then SCN_1=46;

if CurrentVFText_2='...someone succeeded, in getting into your home without permission (and no vehicle was stolen/taken at the same time)...' then SCN_2=1;
if CurrentVFText_2='...someone succeeded, in getting into your home without permission, and a vehicle was also stolen/taken at the same time...' then SCN_2=2;
if CurrentVFText_2='...someone tried to get into your home without permission but did not succeed in getting in (and no vehicle was stolen/taken at the same time)...' then SCN_2=3;
if CurrentVFText_2='...someone tried to get into your home without permission but did not succeed in getting in, but a vehicle was also stolen/taken at the same time...' then SCN_2=4;
if CurrentVFText_2='...you or someone else living in your household had a vehicle stolen/taken without permission, (and the vehicle was not parked inside a private yard at the time)...' then SCN_2=5;
if CurrentVFText_2='...you or someone else living in your household had a vehicle stolen/taken without permission, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_2=6;
if CurrentVFText_2='...you or someone else living in your household had a vehicle stolen/taken without permission, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_2=7;
if CurrentVFText_2='...you or someone else living in your household had something stolen from inside, or stolen off a vehicle, (when the vehicle was not parked inside a private yard at the time)...' then SCN_2=8;
if CurrentVFText_2='...you or someone else living in your household had something stolen from inside, or stolen off a vehicle, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_2=9;
if CurrentVFText_2='...you or someone else living in your household had something stolen from inside, or stolen off a vehicle, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_2=10;
if CurrentVFText_2='...you or someone else living in your household had a vehicle tampered with, (when the vehicle was not parked inside a private yard at the time)...' then SCN_2=11;
if CurrentVFText_2='...you or someone else living in your household had a vehicle tampered with, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_2=12;
if CurrentVFText_2='...you or someone else living in your household had a vehicle tampered with, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_2=13;
if CurrentVFText_2='...you or someone else living in your household had a vehicle deliberately damaged or vandalised, (when the vehicle was not parked inside a private yard at the time)...' then SCN_2=14;
if CurrentVFText_2='...you or someone else living in your household had a vehicle deliberately damaged or vandalised, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_2=15;
if CurrentVFText_2='...you or someone else living in your household had a vehicle deliberately damaged or vandalised, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_2=16;
if CurrentVFText_2='...you or someone else living in your household had a bicycle stolen/taken without permission, (when the bicycle was not located inside a private yard at the time)...' then SCN_2=17;
if CurrentVFText_2='...you or someone else living in your household had a bicycle stolen/taken without permission, (when the bicycle was located inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_2=18;
if CurrentVFText_2='...you or someone else living in your household had a bicycle stolen/taken without permission, (when the bicycle was located inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_2=19;
if CurrentVFText_2='...you or someone else living in your household had a bicycle deliberately damaged or vandalised, (when the bicycle was not located inside a private yard at the time)...' then SCN_2=20;
if CurrentVFText_2='...you or someone else living in your household had a bicycle deliberately damaged or vandalised, (when the bicycle was located inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_2=21;
if CurrentVFText_2='...you or someone else living in your household had a bicycle deliberately damaged or vandalised, (when the bicycle was located inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_2=22;
if CurrentVFText_2='...someone deliberately damaged your home, or anything inside or outside your home, belonging to your household...' then SCN_2=23;
if CurrentVFText_2='...someone deliberately damaged something belonging to you personally...' then SCN_2=24;
if CurrentVFText_2='...something was stolen from the outside of your home, (which was not located within a private yard at the time...' then SCN_2=25;
if CurrentVFText_2='...something was stolen from the outside of outside your home, (which was located within a private yard, and the person who did it was allowed to be there...' then SCN_2=26;
if CurrentVFText_2='...something was stolen from the outside of outside your home, (which was located within a private yard, and the person who did it was not allowed to be there...' then SCN_2=27;
if CurrentVFText_2='...something was stolen from inside your home or garage by someone who was allowed to be there...' then SCN_2=28;
if CurrentVFText_2='...someone came into your house or onto the surrounding grounds, without permission or a fair reason to be there...' then SCN_2=29;
if CurrentVFText_2='...someone stole, or tried to steal, something you were carrying, (and the person used, or threatened to use, force or violence at the time)...' then SCN_2=30;
if CurrentVFText_2='...someone stole, or tried to steal, something you were carrying, (and the person did not use, or threaten to use, force or violence at the time)...' then SCN_2=31;
if CurrentVFText_2='...someone stole, or tried to steal, something else that belongs to you personally, such as from an office or anywhere else...' then SCN_2=32;
if CurrentVFText_2='...someone tricked or deceived you, in order to obtain money, goods or a service ...' then SCN_2=33;
if CurrentVFText_2='...someone used or attempted to use a bank card, credit card, cheque or other document belonging to you without your permission, in order to obtain money or credit, or to buy goods or services...' then SCN_2=34;
if CurrentVFText_2='...a computer or Internet-enabled device of belonging to you or a member of your household, was infected or interfered with, (for example by a virus or someone accessing it without your permission)...' then SCN_2=35;
if CurrentVFText_2='...someone forced you, or tried to force you, to have sexual intercourse when you did not want to...' then SCN_2=36;
if CurrentVFText_2='...someone forced you, or tried to force you, to perform a sexual act (excluding sexual intercourse), when you did not want to...' then SCN_2=37;
if CurrentVFText_2='...someone touched you sexually, or tried to touch you sexually, when you did not want them to...' then SCN_2=38;
if CurrentVFText_2='...someone threatened you face-to-face, to do something to you of a sexual nature, that actually frightened you...' then SCN_2=39;
if CurrentVFText_2='...someone deliberately used force or violence on you...' then SCN_2=40;
if CurrentVFText_2='...someone tried to use force or violence on you, or physically harm you, in some way...' then SCN_2=41;
if CurrentVFText_2='...someone threatened to use force or violence on you, or to physically harm you in a way that actually frightened you...' then SCN_2=42;
if CurrentVFText_2='...someone threatened to destroy or damage something belonging to you or your household in a way that caused you fear, alarm or distress...' then SCN_2=43;
if CurrentVFText_2='...someone made a threat to you, to injure any member of your family or whanau, in a way that caused you fear, alarm or distress?...' then SCN_2=44;
if CurrentVFText_2='...someone acted in a way that caused you fear, alarm or distress...' then SCN_2=45;
if CurrentVFText_2='...you experienced some other types of crime...' then SCN_2=46;

if CurrentVFText_3='...someone succeeded, in getting into your home without permission (and no vehicle was stolen/taken at the same time)...' then SCN_3=1;
if CurrentVFText_3='...someone succeeded, in getting into your home without permission, and a vehicle was also stolen/taken at the same time...' then SCN_3=2;
if CurrentVFText_3='...someone tried to get into your home without permission but did not succeed in getting in (and no vehicle was stolen/taken at the same time)...' then SCN_3=3;
if CurrentVFText_3='...someone tried to get into your home without permission but did not succeed in getting in, but a vehicle was also stolen/taken at the same time...' then SCN_3=4;
if CurrentVFText_3='...you or someone else living in your household had a vehicle stolen/taken without permission, (and the vehicle was not parked inside a private yard at the time)...' then SCN_3=5;
if CurrentVFText_3='...you or someone else living in your household had a vehicle stolen/taken without permission, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_3=6;
if CurrentVFText_3='...you or someone else living in your household had a vehicle stolen/taken without permission, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_3=7;
if CurrentVFText_3='...you or someone else living in your household had something stolen from inside, or stolen off a vehicle, (when the vehicle was not parked inside a private yard at the time)...' then SCN_3=8;
if CurrentVFText_3='...you or someone else living in your household had something stolen from inside, or stolen off a vehicle, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_3=9;
if CurrentVFText_3='...you or someone else living in your household had something stolen from inside, or stolen off a vehicle, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_3=10;
if CurrentVFText_3='...you or someone else living in your household had a vehicle tampered with, (when the vehicle was not parked inside a private yard at the time)...' then SCN_3=11;
if CurrentVFText_3='...you or someone else living in your household had a vehicle tampered with, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_3=12;
if CurrentVFText_3='...you or someone else living in your household had a vehicle tampered with, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_3=13;
if CurrentVFText_3='...you or someone else living in your household had a vehicle deliberately damaged or vandalised, (when the vehicle was not parked inside a private yard at the time)...' then SCN_3=14;
if CurrentVFText_3='...you or someone else living in your household had a vehicle deliberately damaged or vandalised, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_3=15;
if CurrentVFText_3='...you or someone else living in your household had a vehicle deliberately damaged or vandalised, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_3=16;
if CurrentVFText_3='...you or someone else living in your household had a bicycle stolen/taken without permission, (when the bicycle was not located inside a private yard at the time)...' then SCN_3=17;
if CurrentVFText_3='...you or someone else living in your household had a bicycle stolen/taken without permission, (when the bicycle was located inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_3=18;
if CurrentVFText_3='...you or someone else living in your household had a bicycle stolen/taken without permission, (when the bicycle was located inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_3=19;
if CurrentVFText_3='...you or someone else living in your household had a bicycle deliberately damaged or vandalised, (when the bicycle was not located inside a private yard at the time)...' then SCN_3=20;
if CurrentVFText_3='...you or someone else living in your household had a bicycle deliberately damaged or vandalised, (when the bicycle was located inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_3=21;
if CurrentVFText_3='...you or someone else living in your household had a bicycle deliberately damaged or vandalised, (when the bicycle was located inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_3=22;
if CurrentVFText_3='...someone deliberately damaged your home, or anything inside or outside your home, belonging to your household...' then SCN_3=23;
if CurrentVFText_3='...someone deliberately damaged something belonging to you personally...' then SCN_3=24;
if CurrentVFText_3='...something was stolen from the outside of your home, (which was not located within a private yard at the time...' then SCN_3=25;
if CurrentVFText_3='...something was stolen from the outside of outside your home, (which was located within a private yard, and the person who did it was allowed to be there...' then SCN_3=26;
if CurrentVFText_3='...something was stolen from the outside of outside your home, (which was located within a private yard, and the person who did it was not allowed to be there...' then SCN_3=27;
if CurrentVFText_3='...something was stolen from inside your home or garage by someone who was allowed to be there...' then SCN_3=28;
if CurrentVFText_3='...someone came into your house or onto the surrounding grounds, without permission or a fair reason to be there...' then SCN_3=29;
if CurrentVFText_3='...someone stole, or tried to steal, something you were carrying, (and the person used, or threatened to use, force or violence at the time)...' then SCN_3=30;
if CurrentVFText_3='...someone stole, or tried to steal, something you were carrying, (and the person did not use, or threaten to use, force or violence at the time)...' then SCN_3=31;
if CurrentVFText_3='...someone stole, or tried to steal, something else that belongs to you personally, such as from an office or anywhere else...' then SCN_3=32;
if CurrentVFText_3='...someone tricked or deceived you, in order to obtain money, goods or a service ...' then SCN_3=33;
if CurrentVFText_3='...someone used or attempted to use a bank card, credit card, cheque or other document belonging to you without your permission, in order to obtain money or credit, or to buy goods or services...' then SCN_3=34;
if CurrentVFText_3='...a computer or Internet-enabled device of belonging to you or a member of your household, was infected or interfered with, (for example by a virus or someone accessing it without your permission)...' then SCN_3=35;
if CurrentVFText_3='...someone forced you, or tried to force you, to have sexual intercourse when you did not want to...' then SCN_3=36;
if CurrentVFText_3='...someone forced you, or tried to force you, to perform a sexual act (excluding sexual intercourse), when you did not want to...' then SCN_3=37;
if CurrentVFText_3='...someone touched you sexually, or tried to touch you sexually, when you did not want them to...' then SCN_3=38;
if CurrentVFText_3='...someone threatened you face-to-face, to do something to you of a sexual nature, that actually frightened you...' then SCN_3=39;
if CurrentVFText_3='...someone deliberately used force or violence on you...' then SCN_3=40;
if CurrentVFText_3='...someone tried to use force or violence on you, or physically harm you, in some way...' then SCN_3=41;
if CurrentVFText_3='...someone threatened to use force or violence on you, or to physically harm you in a way that actually frightened you...' then SCN_3=42;
if CurrentVFText_3='...someone threatened to destroy or damage something belonging to you or your household in a way that caused you fear, alarm or distress...' then SCN_3=43;
if CurrentVFText_3='...someone made a threat to you, to injure any member of your family or whanau, in a way that caused you fear, alarm or distress?...' then SCN_3=44;
if CurrentVFText_3='...someone acted in a way that caused you fear, alarm or distress...' then SCN_3=45;
if CurrentVFText_3='...you experienced some other types of crime...' then SCN_3=46;

if CurrentVFText_4='...someone succeeded, in getting into your home without permission (and no vehicle was stolen/taken at the same time)...' then SCN_4=1;
if CurrentVFText_4='...someone succeeded, in getting into your home without permission, and a vehicle was also stolen/taken at the same time...' then SCN_4=2;
if CurrentVFText_4='...someone tried to get into your home without permission but did not succeed in getting in (and no vehicle was stolen/taken at the same time)...' then SCN_4=3;
if CurrentVFText_4='...someone tried to get into your home without permission but did not succeed in getting in, but a vehicle was also stolen/taken at the same time...' then SCN_4=4;
if CurrentVFText_4='...you or someone else living in your household had a vehicle stolen/taken without permission, (and the vehicle was not parked inside a private yard at the time)...' then SCN_4=5;
if CurrentVFText_4='...you or someone else living in your household had a vehicle stolen/taken without permission, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_4=6;
if CurrentVFText_4='...you or someone else living in your household had a vehicle stolen/taken without permission, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_4=7;
if CurrentVFText_4='...you or someone else living in your household had something stolen from inside, or stolen off a vehicle, (when the vehicle was not parked inside a private yard at the time)...' then SCN_4=8;
if CurrentVFText_4='...you or someone else living in your household had something stolen from inside, or stolen off a vehicle, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_4=9;
if CurrentVFText_4='...you or someone else living in your household had something stolen from inside, or stolen off a vehicle, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_4=10;
if CurrentVFText_4='...you or someone else living in your household had a vehicle tampered with, (when the vehicle was not parked inside a private yard at the time)...' then SCN_4=11;
if CurrentVFText_4='...you or someone else living in your household had a vehicle tampered with, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_4=12;
if CurrentVFText_4='...you or someone else living in your household had a vehicle tampered with, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_4=13;
if CurrentVFText_4='...you or someone else living in your household had a vehicle deliberately damaged or vandalised, (when the vehicle was not parked inside a private yard at the time)...' then SCN_4=14;
if CurrentVFText_4='...you or someone else living in your household had a vehicle deliberately damaged or vandalised, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_4=15;
if CurrentVFText_4='...you or someone else living in your household had a vehicle deliberately damaged or vandalised, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_4=16;
if CurrentVFText_4='...you or someone else living in your household had a bicycle stolen/taken without permission, (when the bicycle was not located inside a private yard at the time)...' then SCN_4=17;
if CurrentVFText_4='...you or someone else living in your household had a bicycle stolen/taken without permission, (when the bicycle was located inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_4=18;
if CurrentVFText_4='...you or someone else living in your household had a bicycle stolen/taken without permission, (when the bicycle was located inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_4=19;
if CurrentVFText_4='...you or someone else living in your household had a bicycle deliberately damaged or vandalised, (when the bicycle was not located inside a private yard at the time)...' then SCN_4=20;
if CurrentVFText_4='...you or someone else living in your household had a bicycle deliberately damaged or vandalised, (when the bicycle was located inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_4=21;
if CurrentVFText_4='...you or someone else living in your household had a bicycle deliberately damaged or vandalised, (when the bicycle was located inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_4=22;
if CurrentVFText_4='...someone deliberately damaged your home, or anything inside or outside your home, belonging to your household...' then SCN_4=23;
if CurrentVFText_4='...someone deliberately damaged something belonging to you personally...' then SCN_4=24;
if CurrentVFText_4='...something was stolen from the outside of your home, (which was not located within a private yard at the time...' then SCN_4=25;
if CurrentVFText_4='...something was stolen from the outside of outside your home, (which was located within a private yard, and the person who did it was allowed to be there...' then SCN_4=26;
if CurrentVFText_4='...something was stolen from the outside of outside your home, (which was located within a private yard, and the person who did it was not allowed to be there...' then SCN_4=27;
if CurrentVFText_4='...something was stolen from inside your home or garage by someone who was allowed to be there...' then SCN_4=28;
if CurrentVFText_4='...someone came into your house or onto the surrounding grounds, without permission or a fair reason to be there...' then SCN_4=29;
if CurrentVFText_4='...someone stole, or tried to steal, something you were carrying, (and the person used, or threatened to use, force or violence at the time)...' then SCN_4=30;
if CurrentVFText_4='...someone stole, or tried to steal, something you were carrying, (and the person did not use, or threaten to use, force or violence at the time)...' then SCN_4=31;
if CurrentVFText_4='...someone stole, or tried to steal, something else that belongs to you personally, such as from an office or anywhere else...' then SCN_4=32;
if CurrentVFText_4='...someone tricked or deceived you, in order to obtain money, goods or a service ...' then SCN_4=33;
if CurrentVFText_4='...someone used or attempted to use a bank card, credit card, cheque or other document belonging to you without your permission, in order to obtain money or credit, or to buy goods or services...' then SCN_4=34;
if CurrentVFText_4='...a computer or Internet-enabled device of belonging to you or a member of your household, was infected or interfered with, (for example by a virus or someone accessing it without your permission)...' then SCN_4=35;
if CurrentVFText_4='...someone forced you, or tried to force you, to have sexual intercourse when you did not want to...' then SCN_4=36;
if CurrentVFText_4='...someone forced you, or tried to force you, to perform a sexual act (excluding sexual intercourse), when you did not want to...' then SCN_4=37;
if CurrentVFText_4='...someone touched you sexually, or tried to touch you sexually, when you did not want them to...' then SCN_4=38;
if CurrentVFText_4='...someone threatened you face-to-face, to do something to you of a sexual nature, that actually frightened you...' then SCN_4=39;
if CurrentVFText_4='...someone deliberately used force or violence on you...' then SCN_4=40;
if CurrentVFText_4='...someone tried to use force or violence on you, or physically harm you, in some way...' then SCN_4=41;
if CurrentVFText_4='...someone threatened to use force or violence on you, or to physically harm you in a way that actually frightened you...' then SCN_4=42;
if CurrentVFText_4='...someone threatened to destroy or damage something belonging to you or your household in a way that caused you fear, alarm or distress...' then SCN_4=43;
if CurrentVFText_4='...someone made a threat to you, to injure any member of your family or whanau, in a way that caused you fear, alarm or distress?...' then SCN_4=44;
if CurrentVFText_4='...someone acted in a way that caused you fear, alarm or distress...' then SCN_4=45;
if CurrentVFText_4='...you experienced some other types of crime...' then SCN_4=46;

if CurrentVFText_5='...someone succeeded, in getting into your home without permission (and no vehicle was stolen/taken at the same time)...' then SCN_5=1;
if CurrentVFText_5='...someone succeeded, in getting into your home without permission, and a vehicle was also stolen/taken at the same time...' then SCN_5=2;
if CurrentVFText_5='...someone tried to get into your home without permission but did not succeed in getting in (and no vehicle was stolen/taken at the same time)...' then SCN_5=3;
if CurrentVFText_5='...someone tried to get into your home without permission but did not succeed in getting in, but a vehicle was also stolen/taken at the same time...' then SCN_5=4;
if CurrentVFText_5='...you or someone else living in your household had a vehicle stolen/taken without permission, (and the vehicle was not parked inside a private yard at the time)...' then SCN_5=5;
if CurrentVFText_5='...you or someone else living in your household had a vehicle stolen/taken without permission, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_5=6;
if CurrentVFText_5='...you or someone else living in your household had a vehicle stolen/taken without permission, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_5=7;
if CurrentVFText_5='...you or someone else living in your household had something stolen from inside, or stolen off a vehicle, (when the vehicle was not parked inside a private yard at the time)...' then SCN_5=8;
if CurrentVFText_5='...you or someone else living in your household had something stolen from inside, or stolen off a vehicle, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_5=9;
if CurrentVFText_5='...you or someone else living in your household had something stolen from inside, or stolen off a vehicle, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_5=10;
if CurrentVFText_5='...you or someone else living in your household had a vehicle tampered with, (when the vehicle was not parked inside a private yard at the time)...' then SCN_5=11;
if CurrentVFText_5='...you or someone else living in your household had a vehicle tampered with, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_5=12;
if CurrentVFText_5='...you or someone else living in your household had a vehicle tampered with, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_5=13;
if CurrentVFText_5='...you or someone else living in your household had a vehicle deliberately damaged or vandalised, (when the vehicle was not parked inside a private yard at the time)...' then SCN_5=14;
if CurrentVFText_5='...you or someone else living in your household had a vehicle deliberately damaged or vandalised, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_5=15;
if CurrentVFText_5='...you or someone else living in your household had a vehicle deliberately damaged or vandalised, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_5=16;
if CurrentVFText_5='...you or someone else living in your household had a bicycle stolen/taken without permission, (when the bicycle was not located inside a private yard at the time)...' then SCN_5=17;
if CurrentVFText_5='...you or someone else living in your household had a bicycle stolen/taken without permission, (when the bicycle was located inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_5=18;
if CurrentVFText_5='...you or someone else living in your household had a bicycle stolen/taken without permission, (when the bicycle was located inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_5=19;
if CurrentVFText_5='...you or someone else living in your household had a bicycle deliberately damaged or vandalised, (when the bicycle was not located inside a private yard at the time)...' then SCN_5=20;
if CurrentVFText_5='...you or someone else living in your household had a bicycle deliberately damaged or vandalised, (when the bicycle was located inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_5=21;
if CurrentVFText_5='...you or someone else living in your household had a bicycle deliberately damaged or vandalised, (when the bicycle was located inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_5=22;
if CurrentVFText_5='...someone deliberately damaged your home, or anything inside or outside your home, belonging to your household...' then SCN_5=23;
if CurrentVFText_5='...someone deliberately damaged something belonging to you personally...' then SCN_5=24;
if CurrentVFText_5='...something was stolen from the outside of your home, (which was not located within a private yard at the time...' then SCN_5=25;
if CurrentVFText_5='...something was stolen from the outside of outside your home, (which was located within a private yard, and the person who did it was allowed to be there...' then SCN_5=26;
if CurrentVFText_5='...something was stolen from the outside of outside your home, (which was located within a private yard, and the person who did it was not allowed to be there...' then SCN_5=27;
if CurrentVFText_5='...something was stolen from inside your home or garage by someone who was allowed to be there...' then SCN_5=28;
if CurrentVFText_5='...someone came into your house or onto the surrounding grounds, without permission or a fair reason to be there...' then SCN_5=29;
if CurrentVFText_5='...someone stole, or tried to steal, something you were carrying, (and the person used, or threatened to use, force or violence at the time)...' then SCN_5=30;
if CurrentVFText_5='...someone stole, or tried to steal, something you were carrying, (and the person did not use, or threaten to use, force or violence at the time)...' then SCN_5=31;
if CurrentVFText_5='...someone stole, or tried to steal, something else that belongs to you personally, such as from an office or anywhere else...' then SCN_5=32;
if CurrentVFText_5='...someone tricked or deceived you, in order to obtain money, goods or a service ...' then SCN_5=33;
if CurrentVFText_5='...someone used or attempted to use a bank card, credit card, cheque or other document belonging to you without your permission, in order to obtain money or credit, or to buy goods or services...' then SCN_5=34;
if CurrentVFText_5='...a computer or Internet-enabled device of belonging to you or a member of your household, was infected or interfered with, (for example by a virus or someone accessing it without your permission)...' then SCN_5=35;
if CurrentVFText_5='...someone forced you, or tried to force you, to have sexual intercourse when you did not want to...' then SCN_5=36;
if CurrentVFText_5='...someone forced you, or tried to force you, to perform a sexual act (excluding sexual intercourse), when you did not want to...' then SCN_5=37;
if CurrentVFText_5='...someone touched you sexually, or tried to touch you sexually, when you did not want them to...' then SCN_5=38;
if CurrentVFText_5='...someone threatened you face-to-face, to do something to you of a sexual nature, that actually frightened you...' then SCN_5=39;
if CurrentVFText_5='...someone deliberately used force or violence on you...' then SCN_5=40;
if CurrentVFText_5='...someone tried to use force or violence on you, or physically harm you, in some way...' then SCN_5=41;
if CurrentVFText_5='...someone threatened to use force or violence on you, or to physically harm you in a way that actually frightened you...' then SCN_5=42;
if CurrentVFText_5='...someone threatened to destroy or damage something belonging to you or your household in a way that caused you fear, alarm or distress...' then SCN_5=43;
if CurrentVFText_5='...someone made a threat to you, to injure any member of your family or whanau, in a way that caused you fear, alarm or distress?...' then SCN_5=44;
if CurrentVFText_5='...someone acted in a way that caused you fear, alarm or distress...' then SCN_5=45;
if CurrentVFText_5='...you experienced some other types of crime...' then SCN_5=46;

if CurrentVFText_6='...someone succeeded, in getting into your home without permission (and no vehicle was stolen/taken at the same time)...' then SCN_6=1;
if CurrentVFText_6='...someone succeeded, in getting into your home without permission, and a vehicle was also stolen/taken at the same time...' then SCN_6=2;
if CurrentVFText_6='...someone tried to get into your home without permission but did not succeed in getting in (and no vehicle was stolen/taken at the same time)...' then SCN_6=3;
if CurrentVFText_6='...someone tried to get into your home without permission but did not succeed in getting in, but a vehicle was also stolen/taken at the same time...' then SCN_6=4;
if CurrentVFText_6='...you or someone else living in your household had a vehicle stolen/taken without permission, (and the vehicle was not parked inside a private yard at the time)...' then SCN_6=5;
if CurrentVFText_6='...you or someone else living in your household had a vehicle stolen/taken without permission, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_6=6;
if CurrentVFText_6='...you or someone else living in your household had a vehicle stolen/taken without permission, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_6=7;
if CurrentVFText_6='...you or someone else living in your household had something stolen from inside, or stolen off a vehicle, (when the vehicle was not parked inside a private yard at the time)...' then SCN_6=8;
if CurrentVFText_6='...you or someone else living in your household had something stolen from inside, or stolen off a vehicle, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_6=9;
if CurrentVFText_6='...you or someone else living in your household had something stolen from inside, or stolen off a vehicle, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_6=10;
if CurrentVFText_6='...you or someone else living in your household had a vehicle tampered with, (when the vehicle was not parked inside a private yard at the time)...' then SCN_6=11;
if CurrentVFText_6='...you or someone else living in your household had a vehicle tampered with, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_6=12;
if CurrentVFText_6='...you or someone else living in your household had a vehicle tampered with, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_6=13;
if CurrentVFText_6='...you or someone else living in your household had a vehicle deliberately damaged or vandalised, (when the vehicle was not parked inside a private yard at the time)...' then SCN_6=14;
if CurrentVFText_6='...you or someone else living in your household had a vehicle deliberately damaged or vandalised, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_6=15;
if CurrentVFText_6='...you or someone else living in your household had a vehicle deliberately damaged or vandalised, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_6=16;
if CurrentVFText_6='...you or someone else living in your household had a bicycle stolen/taken without permission, (when the bicycle was not located inside a private yard at the time)...' then SCN_6=17;
if CurrentVFText_6='...you or someone else living in your household had a bicycle stolen/taken without permission, (when the bicycle was located inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_6=18;
if CurrentVFText_6='...you or someone else living in your household had a bicycle stolen/taken without permission, (when the bicycle was located inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_6=19;
if CurrentVFText_6='...you or someone else living in your household had a bicycle deliberately damaged or vandalised, (when the bicycle was not located inside a private yard at the time)...' then SCN_6=20;
if CurrentVFText_6='...you or someone else living in your household had a bicycle deliberately damaged or vandalised, (when the bicycle was located inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_6=21;
if CurrentVFText_6='...you or someone else living in your household had a bicycle deliberately damaged or vandalised, (when the bicycle was located inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_6=22;
if CurrentVFText_6='...someone deliberately damaged your home, or anything inside or outside your home, belonging to your household...' then SCN_6=23;
if CurrentVFText_6='...someone deliberately damaged something belonging to you personally...' then SCN_6=24;
if CurrentVFText_6='...something was stolen from the outside of your home, (which was not located within a private yard at the time...' then SCN_6=25;
if CurrentVFText_6='...something was stolen from the outside of outside your home, (which was located within a private yard, and the person who did it was allowed to be there...' then SCN_6=26;
if CurrentVFText_6='...something was stolen from the outside of outside your home, (which was located within a private yard, and the person who did it was not allowed to be there...' then SCN_6=27;
if CurrentVFText_6='...something was stolen from inside your home or garage by someone who was allowed to be there...' then SCN_6=28;
if CurrentVFText_6='...someone came into your house or onto the surrounding grounds, without permission or a fair reason to be there...' then SCN_6=29;
if CurrentVFText_6='...someone stole, or tried to steal, something you were carrying, (and the person used, or threatened to use, force or violence at the time)...' then SCN_6=30;
if CurrentVFText_6='...someone stole, or tried to steal, something you were carrying, (and the person did not use, or threaten to use, force or violence at the time)...' then SCN_6=31;
if CurrentVFText_6='...someone stole, or tried to steal, something else that belongs to you personally, such as from an office or anywhere else...' then SCN_6=32;
if CurrentVFText_6='...someone tricked or deceived you, in order to obtain money, goods or a service ...' then SCN_6=33;
if CurrentVFText_6='...someone used or attempted to use a bank card, credit card, cheque or other document belonging to you without your permission, in order to obtain money or credit, or to buy goods or services...' then SCN_6=34;
if CurrentVFText_6='...a computer or Internet-enabled device of belonging to you or a member of your household, was infected or interfered with, (for example by a virus or someone accessing it without your permission)...' then SCN_6=35;
if CurrentVFText_6='...someone forced you, or tried to force you, to have sexual intercourse when you did not want to...' then SCN_6=36;
if CurrentVFText_6='...someone forced you, or tried to force you, to perform a sexual act (excluding sexual intercourse), when you did not want to...' then SCN_6=37;
if CurrentVFText_6='...someone touched you sexually, or tried to touch you sexually, when you did not want them to...' then SCN_6=38;
if CurrentVFText_6='...someone threatened you face-to-face, to do something to you of a sexual nature, that actually frightened you...' then SCN_6=39;
if CurrentVFText_6='...someone deliberately used force or violence on you...' then SCN_6=40;
if CurrentVFText_6='...someone tried to use force or violence on you, or physically harm you, in some way...' then SCN_6=41;
if CurrentVFText_6='...someone threatened to use force or violence on you, or to physically harm you in a way that actually frightened you...' then SCN_6=42;
if CurrentVFText_6='...someone threatened to destroy or damage something belonging to you or your household in a way that caused you fear, alarm or distress...' then SCN_6=43;
if CurrentVFText_6='...someone made a threat to you, to injure any member of your family or whanau, in a way that caused you fear, alarm or distress?...' then SCN_6=44;
if CurrentVFText_6='...someone acted in a way that caused you fear, alarm or distress...' then SCN_6=45;
if CurrentVFText_6='...you experienced some other types of crime...' then SCN_6=46;

if CurrentVFText_7='...someone succeeded, in getting into your home without permission (and no vehicle was stolen/taken at the same time)...' then SCN_7=1;
if CurrentVFText_7='...someone succeeded, in getting into your home without permission, and a vehicle was also stolen/taken at the same time...' then SCN_7=2;
if CurrentVFText_7='...someone tried to get into your home without permission but did not succeed in getting in (and no vehicle was stolen/taken at the same time)...' then SCN_7=3;
if CurrentVFText_7='...someone tried to get into your home without permission but did not succeed in getting in, but a vehicle was also stolen/taken at the same time...' then SCN_7=4;
if CurrentVFText_7='...you or someone else living in your household had a vehicle stolen/taken without permission, (and the vehicle was not parked inside a private yard at the time)...' then SCN_7=5;
if CurrentVFText_7='...you or someone else living in your household had a vehicle stolen/taken without permission, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_7=6;
if CurrentVFText_7='...you or someone else living in your household had a vehicle stolen/taken without permission, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_7=7;
if CurrentVFText_7='...you or someone else living in your household had something stolen from inside, or stolen off a vehicle, (when the vehicle was not parked inside a private yard at the time)...' then SCN_7=8;
if CurrentVFText_7='...you or someone else living in your household had something stolen from inside, or stolen off a vehicle, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_7=9;
if CurrentVFText_7='...you or someone else living in your household had something stolen from inside, or stolen off a vehicle, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_7=10;
if CurrentVFText_7='...you or someone else living in your household had a vehicle tampered with, (when the vehicle was not parked inside a private yard at the time)...' then SCN_7=11;
if CurrentVFText_7='...you or someone else living in your household had a vehicle tampered with, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_7=12;
if CurrentVFText_7='...you or someone else living in your household had a vehicle tampered with, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_7=13;
if CurrentVFText_7='...you or someone else living in your household had a vehicle deliberately damaged or vandalised, (when the vehicle was not parked inside a private yard at the time)...' then SCN_7=14;
if CurrentVFText_7='...you or someone else living in your household had a vehicle deliberately damaged or vandalised, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_7=15;
if CurrentVFText_7='...you or someone else living in your household had a vehicle deliberately damaged or vandalised, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_7=16;
if CurrentVFText_7='...you or someone else living in your household had a bicycle stolen/taken without permission, (when the bicycle was not located inside a private yard at the time)...' then SCN_7=17;
if CurrentVFText_7='...you or someone else living in your household had a bicycle stolen/taken without permission, (when the bicycle was located inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_7=18;
if CurrentVFText_7='...you or someone else living in your household had a bicycle stolen/taken without permission, (when the bicycle was located inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_7=19;
if CurrentVFText_7='...you or someone else living in your household had a bicycle deliberately damaged or vandalised, (when the bicycle was not located inside a private yard at the time)...' then SCN_7=20;
if CurrentVFText_7='...you or someone else living in your household had a bicycle deliberately damaged or vandalised, (when the bicycle was located inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_7=21;
if CurrentVFText_7='...you or someone else living in your household had a bicycle deliberately damaged or vandalised, (when the bicycle was located inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_7=22;
if CurrentVFText_7='...someone deliberately damaged your home, or anything inside or outside your home, belonging to your household...' then SCN_7=23;
if CurrentVFText_7='...someone deliberately damaged something belonging to you personally...' then SCN_7=24;
if CurrentVFText_7='...something was stolen from the outside of your home, (which was not located within a private yard at the time...' then SCN_7=25;
if CurrentVFText_7='...something was stolen from the outside of outside your home, (which was located within a private yard, and the person who did it was allowed to be there...' then SCN_7=26;
if CurrentVFText_7='...something was stolen from the outside of outside your home, (which was located within a private yard, and the person who did it was not allowed to be there...' then SCN_7=27;
if CurrentVFText_7='...something was stolen from inside your home or garage by someone who was allowed to be there...' then SCN_7=28;
if CurrentVFText_7='...someone came into your house or onto the surrounding grounds, without permission or a fair reason to be there...' then SCN_7=29;
if CurrentVFText_7='...someone stole, or tried to steal, something you were carrying, (and the person used, or threatened to use, force or violence at the time)...' then SCN_7=30;
if CurrentVFText_7='...someone stole, or tried to steal, something you were carrying, (and the person did not use, or threaten to use, force or violence at the time)...' then SCN_7=31;
if CurrentVFText_7='...someone stole, or tried to steal, something else that belongs to you personally, such as from an office or anywhere else...' then SCN_7=32;
if CurrentVFText_7='...someone tricked or deceived you, in order to obtain money, goods or a service ...' then SCN_7=33;
if CurrentVFText_7='...someone used or attempted to use a bank card, credit card, cheque or other document belonging to you without your permission, in order to obtain money or credit, or to buy goods or services...' then SCN_7=34;
if CurrentVFText_7='...a computer or Internet-enabled device of belonging to you or a member of your household, was infected or interfered with, (for example by a virus or someone accessing it without your permission)...' then SCN_7=35;
if CurrentVFText_7='...someone forced you, or tried to force you, to have sexual intercourse when you did not want to...' then SCN_7=36;
if CurrentVFText_7='...someone forced you, or tried to force you, to perform a sexual act (excluding sexual intercourse), when you did not want to...' then SCN_7=37;
if CurrentVFText_7='...someone touched you sexually, or tried to touch you sexually, when you did not want them to...' then SCN_7=38;
if CurrentVFText_7='...someone threatened you face-to-face, to do something to you of a sexual nature, that actually frightened you...' then SCN_7=39;
if CurrentVFText_7='...someone deliberately used force or violence on you...' then SCN_7=40;
if CurrentVFText_7='...someone tried to use force or violence on you, or physically harm you, in some way...' then SCN_7=41;
if CurrentVFText_7='...someone threatened to use force or violence on you, or to physically harm you in a way that actually frightened you...' then SCN_7=42;
if CurrentVFText_7='...someone threatened to destroy or damage something belonging to you or your household in a way that caused you fear, alarm or distress...' then SCN_7=43;
if CurrentVFText_7='...someone made a threat to you, to injure any member of your family or whanau, in a way that caused you fear, alarm or distress?...' then SCN_7=44;
if CurrentVFText_7='...someone acted in a way that caused you fear, alarm or distress...' then SCN_7=45;
if CurrentVFText_7='...you experienced some other types of crime...' then SCN_7=46;

if CurrentVFText_8='...someone succeeded, in getting into your home without permission (and no vehicle was stolen/taken at the same time)...' then SCN_8=1;
if CurrentVFText_8='...someone succeeded, in getting into your home without permission, and a vehicle was also stolen/taken at the same time...' then SCN_8=2;
if CurrentVFText_8='...someone tried to get into your home without permission but did not succeed in getting in (and no vehicle was stolen/taken at the same time)...' then SCN_8=3;
if CurrentVFText_8='...someone tried to get into your home without permission but did not succeed in getting in, but a vehicle was also stolen/taken at the same time...' then SCN_8=4;
if CurrentVFText_8='...you or someone else living in your household had a vehicle stolen/taken without permission, (and the vehicle was not parked inside a private yard at the time)...' then SCN_8=5;
if CurrentVFText_8='...you or someone else living in your household had a vehicle stolen/taken without permission, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_8=6;
if CurrentVFText_8='...you or someone else living in your household had a vehicle stolen/taken without permission, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_8=7;
if CurrentVFText_8='...you or someone else living in your household had something stolen from inside, or stolen off a vehicle, (when the vehicle was not parked inside a private yard at the time)...' then SCN_8=8;
if CurrentVFText_8='...you or someone else living in your household had something stolen from inside, or stolen off a vehicle, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_8=9;
if CurrentVFText_8='...you or someone else living in your household had something stolen from inside, or stolen off a vehicle, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_8=10;
if CurrentVFText_8='...you or someone else living in your household had a vehicle tampered with, (when the vehicle was not parked inside a private yard at the time)...' then SCN_8=11;
if CurrentVFText_8='...you or someone else living in your household had a vehicle tampered with, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_8=12;
if CurrentVFText_8='...you or someone else living in your household had a vehicle tampered with, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_8=13;
if CurrentVFText_8='...you or someone else living in your household had a vehicle deliberately damaged or vandalised, (when the vehicle was not parked inside a private yard at the time)...' then SCN_8=14;
if CurrentVFText_8='...you or someone else living in your household had a vehicle deliberately damaged or vandalised, (when the vehicle was parked inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_8=15;
if CurrentVFText_8='...you or someone else living in your household had a vehicle deliberately damaged or vandalised, (when the vehicle was parked inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_8=16;
if CurrentVFText_8='...you or someone else living in your household had a bicycle stolen/taken without permission, (when the bicycle was not located inside a private yard at the time)...' then SCN_8=17;
if CurrentVFText_8='...you or someone else living in your household had a bicycle stolen/taken without permission, (when the bicycle was located inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_8=18;
if CurrentVFText_8='...you or someone else living in your household had a bicycle stolen/taken without permission, (when the bicycle was located inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_8=19;
if CurrentVFText_8='...you or someone else living in your household had a bicycle deliberately damaged or vandalised, (when the bicycle was not located inside a private yard at the time)...' then SCN_8=20;
if CurrentVFText_8='...you or someone else living in your household had a bicycle deliberately damaged or vandalised, (when the bicycle was located inside a private yard at the time, and the person who did it was not allowed to be there)...' then SCN_8=21;
if CurrentVFText_8='...you or someone else living in your household had a bicycle deliberately damaged or vandalised, (when the bicycle was located inside a private yard at the time, and the person who did it was allowed to be there)...' then SCN_8=22;
if CurrentVFText_8='...someone deliberately damaged your home, or anything inside or outside your home, belonging to your household...' then SCN_8=23;
if CurrentVFText_8='...someone deliberately damaged something belonging to you personally...' then SCN_8=24;
if CurrentVFText_8='...something was stolen from the outside of your home, (which was not located within a private yard at the time...' then SCN_8=25;
if CurrentVFText_8='...something was stolen from the outside of outside your home, (which was located within a private yard, and the person who did it was allowed to be there...' then SCN_8=26;
if CurrentVFText_8='...something was stolen from the outside of outside your home, (which was located within a private yard, and the person who did it was not allowed to be there...' then SCN_8=27;
if CurrentVFText_8='...something was stolen from inside your home or garage by someone who was allowed to be there...' then SCN_8=28;
if CurrentVFText_8='...someone came into your house or onto the surrounding grounds, without permission or a fair reason to be there...' then SCN_8=29;
if CurrentVFText_8='...someone stole, or tried to steal, something you were carrying, (and the person used, or threatened to use, force or violence at the time)...' then SCN_8=30;
if CurrentVFText_8='...someone stole, or tried to steal, something you were carrying, (and the person did not use, or threaten to use, force or violence at the time)...' then SCN_8=31;
if CurrentVFText_8='...someone stole, or tried to steal, something else that belongs to you personally, such as from an office or anywhere else...' then SCN_8=32;
if CurrentVFText_8='...someone tricked or deceived you, in order to obtain money, goods or a service ...' then SCN_8=33;
if CurrentVFText_8='...someone used or attempted to use a bank card, credit card, cheque or other document belonging to you without your permission, in order to obtain money or credit, or to buy goods or services...' then SCN_8=34;
if CurrentVFText_8='...a computer or Internet-enabled device of belonging to you or a member of your household, was infected or interfered with, (for example by a virus or someone accessing it without your permission)...' then SCN_8=35;
if CurrentVFText_8='...someone forced you, or tried to force you, to have sexual intercourse when you did not want to...' then SCN_8=36;
if CurrentVFText_8='...someone forced you, or tried to force you, to perform a sexual act (excluding sexual intercourse), when you did not want to...' then SCN_8=37;
if CurrentVFText_8='...someone touched you sexually, or tried to touch you sexually, when you did not want them to...' then SCN_8=38;
if CurrentVFText_8='...someone threatened you face-to-face, to do something to you of a sexual nature, that actually frightened you...' then SCN_8=39;
if CurrentVFText_8='...someone deliberately used force or violence on you...' then SCN_8=40;
if CurrentVFText_8='...someone tried to use force or violence on you, or physically harm you, in some way...' then SCN_8=41;
if CurrentVFText_8='...someone threatened to use force or violence on you, or to physically harm you in a way that actually frightened you...' then SCN_8=42;
if CurrentVFText_8='...someone threatened to destroy or damage something belonging to you or your household in a way that caused you fear, alarm or distress...' then SCN_8=43;
if CurrentVFText_8='...someone made a threat to you, to injure any member of your family or whanau, in a way that caused you fear, alarm or distress?...' then SCN_8=44;
if CurrentVFText_8='...someone acted in a way that caused you fear, alarm or distress...' then SCN_8=45;
if CurrentVFText_8='...you experienced some other types of crime...' then SCN_8=46;

DurationTotal=sum(DurationInitialDemographics, DurationScreen, DurationVictimForms, DurationMainDemographics,  DurationOther);
format DurationTotal mmss.;
rename DurationOther= DurationExitQuestions;
run;

/*patch eth spelling error in other 
tablet error, we shouldn't have any spelling error.
these tablets didn't install JQuery package correctly, fixed now
*/
data nzcvs_flag;
set nzcvs_flag;
*if psu2015= 32075 and nzcvshhid="A3044364" then MD1_02_Other1="South African";

run;

/*reorder all variables*/
%INCLUDE "C:\Documents and Settings\cbg.thomas\My Documents\Program\NZCVS\Year2\ReOrderY2.sas";
%INCLUDE "C:\Documents and Settings\cbg.thomas\My Documents\Program\NZCVS\Year2\NZCVSOtherEth_Y2.sas";




data Nzcvs_clean;
set Nzcvs_flag;
where OutcomeMoJ='INTCOM'; /*only complete survey*/
/*recode crime code18 (in TSS it's 19)*/
if CurrentVFCode_1=19 then CurrentVFCode_1=18;
if CurrentVFCode_2=19 then CurrentVFCode_2=18;
if CurrentVFCode_3=19 then CurrentVFCode_3=18;
if CurrentVFCode_4=19 then CurrentVFCode_4=18;
if CurrentVFCode_5=19 then CurrentVFCode_5=18;
if CurrentVFCode_6=19 then CurrentVFCode_6=18;
if CurrentVFCode_7=19 then CurrentVFCode_7=18;
if CurrentVFCode_8=19 then CurrentVFCode_8=18;

/*recode incident count for VF1_01=2 (split incidents)*/
/*
When we split the incidents in VF1.02 (if VF1_02RemainingIncidents_1 ne .) the CurrentIncidentsCount_1 will store the value in VF1_02_1. 
The remaining counts will be stored in VF1_02RemainingIncidents_1.
VFIncidentsCount_1 will store the total counts for this VF.
Then in the next VF templates I have set the VFIncidentsCount_2 = VFIncidentsCount_1. Because it’s from the previous VF. 
The CurrentIncidentsCount_2 will be the value in VF1_02RemainingIncidents_1

e.g.
VF1 num =10.   In VF1.02 it has been split into 3 and 7.  In this case we will have 
VFIncidentsCount_1=10, CurrentIncidentsCount_1 = 3 (CVF)
VFIncidentsCount_2=10, CurrentIncidentsCount_2 = 7 (IVF)
*/
if VF1_02RemainingIncidents_1 ne . then VFIncidentsCount_2= VFIncidentsCount_1;
if VF1_02RemainingIncidents_2 ne . then VFIncidentsCount_3= VFIncidentsCount_2;
if VF1_02RemainingIncidents_3 ne . then VFIncidentsCount_4= VFIncidentsCount_3;
if VF1_02RemainingIncidents_4 ne . then VFIncidentsCount_5= VFIncidentsCount_4;
if VF1_02RemainingIncidents_5 ne . then VFIncidentsCount_6= VFIncidentsCount_5;
if VF1_02RemainingIncidents_6 ne . then VFIncidentsCount_7= VFIncidentsCount_6;
if VF1_02RemainingIncidents_7 ne . then VFIncidentsCount_8= VFIncidentsCount_7;

/*recode second incident count for IVF count=2 and for VF1_01=3*/
/*
The first part is to find out the IVF count=2 or VF1_01 = 3 (then we will have 1 or 2 IVF)
VF3_01_2 ne . it has IVF data.
VFIncidentsCount_2 = . the VFcount is not set in TSS. Means it has IVF left in queue. 
(too complex to explain in details.)
Then the second VFIncidentcount is set with previous count.
*/
if VFIncidentsCount_2 = . and VF3_01_2 ne . then do VFIncidentsCount_2= VFIncidentsCount_1; CurrentIncidentsCount_2=CurrentIncidentsCount_1; end;
if VFIncidentsCount_3 = . and VF3_01_3 ne . then do VFIncidentsCount_3= VFIncidentsCount_2; CurrentIncidentsCount_3=CurrentIncidentsCount_2; end;
if VFIncidentsCount_4 = . and VF3_01_4 ne . then do VFIncidentsCount_4= VFIncidentsCount_3; CurrentIncidentsCount_4=CurrentIncidentsCount_3; end;
if VFIncidentsCount_5 = . and VF3_01_5 ne . then do VFIncidentsCount_5= VFIncidentsCount_4; CurrentIncidentsCount_5=CurrentIncidentsCount_4; end;
if VFIncidentsCount_6 = . and VF3_01_6 ne . then do VFIncidentsCount_6= VFIncidentsCount_5; CurrentIncidentsCount_6=CurrentIncidentsCount_5; end;
if VFIncidentsCount_7 = . and VF3_01_7 ne . then do VFIncidentsCount_7= VFIncidentsCount_6; CurrentIncidentsCount_7=CurrentIncidentsCount_6; end;
if VFIncidentsCount_8 = . and VF3_01_8 ne . then do VFIncidentsCount_8= VFIncidentsCount_7; CurrentIncidentsCount_8=CurrentIncidentsCount_7; end;

/*recode VF1_06=2 when repick in second VF
condination: VF1_01=3 and 2 crime text are different (means repick)*/
/*
if we have VF1.01 =3 (all different) then it will go to first IVF.
Then in the second template it will be asked for VF1.06. 
When choose VF1.06=“2” it will go back to VF setup JavaScript page (do not consume a template in this case)
If the next template description text is different. That means it must choose “2” to repick the next scenario.
(the original VF1.06=“2” will be deleted by TSS because it “violated skip logic”,  I added this data back)

*/
if VF1_01_1=3 and CurrentVFText_1 ne CurrentVFText_2 then VF1_06_2=2;
if VF1_01_2=3 and CurrentVFText_2 ne CurrentVFText_3 then VF1_06_3=2;
if VF1_01_3=3 and CurrentVFText_3 ne CurrentVFText_4 then VF1_06_4=2;
if VF1_01_4=3 and CurrentVFText_4 ne CurrentVFText_5 then VF1_06_5=2;
if VF1_01_5=3 and CurrentVFText_5 ne CurrentVFText_6 then VF1_06_6=2;
if VF1_01_6=3 and CurrentVFText_6 ne CurrentVFText_7 then VF1_06_7=2;
if VF1_01_7=3 and CurrentVFText_7 ne CurrentVFText_8 then VF1_06_8=2;


/*clean some dummy pre-entered data when VF exit flag = 1 */
/*VF_Exit=1 means the VF section is done*/
if VF_Exit_1=1 then call missing(of CurrentVFCode_1 -- CurrentIncidentsCount_1); 
if VF_Exit_2=1 then call missing(of CurrentVFCode_2 -- CurrentIncidentsCount_2); 
if VF_Exit_3=1 then call missing(of CurrentVFCode_3 -- CurrentIncidentsCount_3); 
if VF_Exit_4=1 then call missing(of CurrentVFCode_4 -- CurrentIncidentsCount_4); 
if VF_Exit_5=1 then call missing(of CurrentVFCode_5 -- CurrentIncidentsCount_5); 
if VF_Exit_6=1 then call missing(of CurrentVFCode_6 -- CurrentIncidentsCount_6); 
if VF_Exit_7=1 then call missing(of CurrentVFCode_7 -- CurrentIncidentsCount_7); 
if VF_Exit_8=1 then call missing(of CurrentVFCode_8 -- CurrentIncidentsCount_8); 


drop MD1_01A MD1_01B MD1_01C MD1_01D MD1_01E MD1_01F MD1_01G MD1_01H MD1_01I;
run;

/*add moj requested ariables. detail in data dict*/
data Nzcvs_moj;
set Nzcvs_clean;
/*MOJ Variables*/
if ID1_01=2 then DVSEX='2'; 
if ID1_01=1 then DVSEX='1'; 

Select;
when (MD4_01 = 1)  DVGender='01';
when (MD4_01 = 2)  DVGender='02';
when (MD4_01 = 3)  DVGender='03';
when (MD4_01 = 98)  DVGender='98';
when (MD4_01 = 99)  DVGender='99';
otherwise DVGender='';
end;

Select;
when (MD4_02 = 1)  DVSEXORIENT='01';
when (MD4_02 = 2)  DVSEXORIENT='02';
when (MD4_02 = 3)  DVSEXORIENT='03';
when (MD4_02 = 4)  DVSEXORIENT='04';
when (MD4_02 = 98)  DVSEXORIENT='98';
when (MD4_02 = 99)  DVSEXORIENT='99';
otherwise DVSEXORIENT='';
end;

DVAGE = ID1_02;
if ID1_02_DKR=99 then DVAGE=9999; 

Select;
when(DVAGE>=15 and DVAGE<=19)  DV5YRAGEGRP='01';
when(DVAGE>=20 and DVAGE<=24)  DV5YRAGEGRP='02';
when(DVAGE>=25 and DVAGE<=29)  DV5YRAGEGRP='03';
when(DVAGE>=30 and DVAGE<=34)  DV5YRAGEGRP='04';
when(DVAGE>=35 and DVAGE<=39)  DV5YRAGEGRP='05';
when(DVAGE>=40 and DVAGE<=44)  DV5YRAGEGRP='06';
when(DVAGE>=45 and DVAGE<=49)  DV5YRAGEGRP='07';
when(DVAGE>=50 and DVAGE<=54)  DV5YRAGEGRP='08';
when(DVAGE>=55 and DVAGE<=59)  DV5YRAGEGRP='09';
when(DVAGE>=60 and DVAGE<=64)  DV5YRAGEGRP='10';
when(DVAGE>=65 and DVAGE<=69)  DV5YRAGEGRP='11';
when(DVAGE>=70 and DVAGE<=74)  DV5YRAGEGRP='12';
when(DVAGE>=75 and DVAGE<=120)  DV5YRAGEGRP='13';
when(DVAGE=9999)  DV5YRAGEGRP='99';
otherwise DV5YRAGEGRP='';
end;

Select;
when(DVAGE>=15 and DVAGE<=19)  DVAGEGRP='01';
when(DVAGE>=20 and DVAGE<=29)  DVAGEGRP='02';
when(DVAGE>=30 and DVAGE<=39)  DVAGEGRP='03';
when(DVAGE>=40 and DVAGE<=49)  DVAGEGRP='04';
when(DVAGE>=50 and DVAGE<=59)  DVAGEGRP='05';
when(DVAGE>=60 and DVAGE<=64)  DVAGEGRP='06';
when(DVAGE>=65 and DVAGE<=120)  DVAGEGRP='07';
when(DVAGE=9999)  DVAGEGRP='99';
otherwise DVAGEGRP='';
end;

if 
(ETHNICCODE1 >= 10000 and ETHNICCODE1<=19999) or  
(ETHNICCODE2 >= 10000 and ETHNICCODE2<=19999) or 
(ETHNICCODE3 >= 10000 and ETHNICCODE3<=19999) or 
(ETHNICCODE4 >= 10000 and ETHNICCODE4<=19999) or 
(ETHNICCODE5 >= 10000 and ETHNICCODE5<=19999) or 
(ETHNICCODE6 >= 10000 and ETHNICCODE6<=19999) 
then DVETHN_EURO=1; else DVETHN_EURO=0;

if 
(ETHNICCODE1 = 21111 ) or  
(ETHNICCODE2 = 21111 ) or 
(ETHNICCODE3 = 21111 ) or 
(ETHNICCODE4 = 21111 ) or 
(ETHNICCODE5 = 21111 ) or 
(ETHNICCODE6 = 21111 ) 
then DVETHN_MAORI=1; else DVETHN_MAORI=0;

if 
(ETHNICCODE1 >= 30000 and ETHNICCODE1<=39999) or  
(ETHNICCODE2 >= 30000 and ETHNICCODE2<=39999) or 
(ETHNICCODE3 >= 30000 and ETHNICCODE3<=39999) or 
(ETHNICCODE4 >= 30000 and ETHNICCODE4<=39999) or 
(ETHNICCODE5 >= 30000 and ETHNICCODE5<=39999) or 
(ETHNICCODE6 >= 30000 and ETHNICCODE6<=39999) 
then DVETHN_PACIFIC=1; else DVETHN_PACIFIC=0;


if 
(ETHNICCODE1 >= 40000 and ETHNICCODE1<=49999) or  
(ETHNICCODE2 >= 40000 and ETHNICCODE2<=49999) or 
(ETHNICCODE3 >= 40000 and ETHNICCODE3<=49999) or 
(ETHNICCODE4 >= 40000 and ETHNICCODE4<=49999) or 
(ETHNICCODE5 >= 40000 and ETHNICCODE5<=49999) or 
(ETHNICCODE6 >= 40000 and ETHNICCODE6<=49999) 
then DVETHN_ASIAN=1; else DVETHN_ASIAN=0;

if 
(ETHNICCODE1 >= 42100 and ETHNICCODE1<=42199) or  
(ETHNICCODE2 >= 42100 and ETHNICCODE2<=42199) or 
(ETHNICCODE3 >= 42100 and ETHNICCODE3<=42199) or 
(ETHNICCODE4 >= 42100 and ETHNICCODE4<=42199) or 
(ETHNICCODE5 >= 42100 and ETHNICCODE5<=42199) or 
(ETHNICCODE6 >= 42100 and ETHNICCODE6<=42199) 
then DVETHN_CHINESE=1; else DVETHN_CHINESE=0;

if 
(ETHNICCODE1 >= 43100 and ETHNICCODE1<=43199) or  
(ETHNICCODE2 >= 43100 and ETHNICCODE2<=43199) or 
(ETHNICCODE3 >= 43100 and ETHNICCODE3<=43199) or 
(ETHNICCODE4 >= 43100 and ETHNICCODE4<=43199) or 
(ETHNICCODE5 >= 43100 and ETHNICCODE5<=43199) or 
(ETHNICCODE6 >= 43100 and ETHNICCODE6<=43199) 
then DVETHN_INDIAN=1; else DVETHN_INDIAN=0;

DVETHN_OTHERASIAN=0;
if DVETHN_ASIAN=1 and DVETHN_CHINESE=0 and DVETHN_INDIAN=0 then DVETHN_OTHERASIAN=1;

if 
(ETHNICCODE1 >= 51100 and ETHNICCODE1<=61199) or  
(ETHNICCODE2 >= 51100 and ETHNICCODE2<=61199) or 
(ETHNICCODE3 >= 51100 and ETHNICCODE3<=61199) or 
(ETHNICCODE4 >= 51100 and ETHNICCODE4<=61199) or 
(ETHNICCODE5 >= 51100 and ETHNICCODE5<=61199) or 
(ETHNICCODE6 >= 51100 and ETHNICCODE6<=61199) 
then DVETHN_OTHER=1; else DVETHN_OTHER=0;

if 
(ETHNICCODE1 >= 94444 and ETHNICCODE1<=99999) or  
(ETHNICCODE2 >= 94444 and ETHNICCODE2<=99999) or 
(ETHNICCODE3 >= 94444 and ETHNICCODE3<=99999) or 
(ETHNICCODE4 >= 94444 and ETHNICCODE4<=99999) or 
(ETHNICCODE5 >= 94444 and ETHNICCODE5<=99999) or 
(ETHNICCODE6 >= 94444 and ETHNICCODE6<=99999) 
then DVETHN_NS=1; else DVETHN_NS=0;

DVNUMUSRES=total_people;
DVNUMCHILD=child_count;
*if DVNUMUSRES=. then DVNUMUSRES=9999;
*if DVNUMCHILD=. then DVNUMCHILD=9999;



Select;
when (MD3_02 = 1)  DVTENURE='01';
when (MD3_02 = 2)  DVTENURE='02';
when (MD3_02 = 98)  DVTENURE='98';
when (MD3_02 = 99)  DVTENURE='99';
otherwise DVTENURE='';
end;

Select;
when (MD3_03 = 1)  DVLANDLORD='01';
when (MD3_03 = 2)  DVLANDLORD='02';
when (MD3_03 = 3)  DVLANDLORD='03';
when (MD3_03 = 4)  DVLANDLORD='04';
when (MD3_03 = 98) DVLANDLORD='98';
when (MD3_03 = 99)  DVLANDLORD='99';
otherwise DVLANDLORD='';
end;

if MD3_02=1 then  DVTENLLORD ='01';
else if MD3_02 = 2 and MD3_03 = 1 then DVTENLLORD='02';
else if MD3_02 = 2 AND MD3_03 in (2, 3, 4) then DVTENLLORD='03'; 
else IF MD3_02 = 98 OR MD3_03 = 98 THEN DVTENLLORD = '98';
else IF MD3_02 = 99 OR MD3_03 = 99 THEN DVTENLLORD = '99';

Select;
when (ID1_03 = 1)  DVPARTNERC='1';
when (ID1_03 = 2)  DVPARTNERC='2';
when (ID1_03 = 3)  DVPARTNERC='3';
otherwise DVPARTNERC='';
end;

if ID1_04_01=1 and ID1_04_02=0 then DVPARTNERP='1';
if ID1_04_02=1 and ID1_04_01=0 then DVPARTNERP='2';
if ID1_04_01=1 and ID1_04_02=1 then DVPARTNERP='3';
if ID1_04_03=1 then DVPARTNERP='4';

DVEVERPARTNER='                               ';
if ID1_03 in (1, 2)  or ID1_04_01=1 or ID1_04_02=1 or ID1_05_01=1 or ID1_05_02=1 then DVEVERPARTNER='1';
else DVEVERPARTNER='2';

Select;
when (ID1_06 = 1)  DVRELASTAT='01';
when (ID1_06 = 2)  DVRELASTAT='02';
when (ID1_06 = 3)  DVRELASTAT='03';
when (ID1_06 = 4)  DVRELASTAT='04';
when (ID1_06 = 5)  DVRELASTAT='05';
when (ID1_06 = 98)  DVRELASTAT='98';
when (ID1_06 = 99)  DVRELASTAT='99';
otherwise DVRELASTAT='';
end;

IF ID1_03 in (1, 2) AND ID1_06 in (5) then DVPARTNERSTATUS='01';
else IF ID1_03 in (1, 2) AND ID1_06 in (1, 2, 3, 4) then DVPARTNERSTATUS='02';
else IF ID1_03 = 3 then DVPARTNERSTATUS='03';
else IF ID1_06 = 98 then DVPARTNERSTATUS='98';
else IF ID1_06 = 99 then DVPARTNERSTATUS='99';

IF ID1_06 = 5 THEN DVRELATIONSTATUS = '01';
IF ID1_06 in (2, 4) THEN DVRELATIONSTATUS = '02';
IF ID1_06 = 3  THEN DVRELATIONSTATUS = '03';
IF ID1_06 = 1 THEN DVRELATIONSTATUS = '04';
IF ID1_06 = 98 THEN DVRELATIONSTATUS = '98';
IF ID1_06 = 99 THEN DVRELATIONSTATUS = '99';

IF MD2_01 = 1 THEN DVEMPSTATUS = '01';
else IF MD2_01 = 2 THEN DVEMPSTATUS = '02';
else IF MD2_01 = 3 AND MD2_02 = 2 THEN DVEMPSTATUS = '03';
else IF MD2_01 = 3 AND MD2_02 in (3, 4, 7) THEN DVEMPSTATUS = '04';
else IF MD2_01 = 3 AND MD2_02 = 1 THEN DVEMPSTATUS = '05';
else IF MD2_01 = 3 AND MD2_02 in (5, 6) THEN DVEMPSTATUS = '06';
else IF MD2_01 = 77 OR MD2_02 = 77 THEN DVEMPSTATUS = '77';
else IF MD2_01 = 98 OR MD2_02 = 98 THEN DVEMPSTATUS = '98';
else IF MD2_01 = 99 OR MD2_02 = 99 THEN DVEMPSTATUS = '99';


Select;
when (MD4_03 = 1)  DVPERSONINCOME='01';
when (MD4_03 = 2)  DVPERSONINCOME='02';
when (MD4_03 = 3)  DVPERSONINCOME='03';
when (MD4_03 = 4)  DVPERSONINCOME='04';
when (MD4_03 = 5)  DVPERSONINCOME='05';
when (MD4_03 = 6)  DVPERSONINCOME='06';
when (MD4_03 = 7)  DVPERSONINCOME='07';
when (MD4_03 = 8)  DVPERSONINCOME='08';
when (MD4_03 = 9)  DVPERSONINCOME='09';
when (MD4_03 = 10)  DVPERSONINCOME='10';
when (MD4_03 = 11)  DVPERSONINCOME='11';
when (MD4_03 = 12)  DVPERSONINCOME='12';
when (MD4_03 = 98)  DVPERSONINCOME='98';
when (MD4_03 = 99)  DVPERSONINCOME='99';
otherwise DVPERSONINCOME='';
end;


Select;
when (MD4_04 = 1)  DVHHOLDINCOME='01';
when (MD4_04 = 2)  DVHHOLDINCOME='02';
when (MD4_04 = 3)  DVHHOLDINCOME='03';
when (MD4_04 = 4)  DVHHOLDINCOME='04';
when (MD4_04 = 5)  DVHHOLDINCOME='05';
when (MD4_04 = 6)  DVHHOLDINCOME='06';
when (MD4_04 = 7)  DVHHOLDINCOME='07';
when (MD4_04 = 8)  DVHHOLDINCOME='08';
when (MD4_04 = 9)  DVHHOLDINCOME='09';
when (MD4_04 = 10)  DVHHOLDINCOME='10';
when (MD4_04 = 11)  DVHHOLDINCOME='11';
when (MD4_04 = 12)  DVHHOLDINCOME='12';
when (MD4_04 = 98)  DVHHOLDINCOME='98';
when (MD4_04 = 99)  DVHHOLDINCOME='99';
otherwise DVHHOLDINCOME='';
end;

IF MD4_03 in (1, 2) THEN DVPERSINCGRP1 = '01';
IF MD4_03 = 3 THEN DVPERSINCGRP1 = '02';
IF MD4_03 = 4 THEN DVPERSINCGRP1 = '03';
IF MD4_03 = 5 THEN DVPERSINCGRP1 = '04';
IF MD4_03 in (6, 7) THEN DVPERSINCGRP1 = '05';
IF MD4_03 in (8, 9, 10, 11, 12) THEN DVPERSINCGRP1 = '06';
IF MD4_03 = 98 THEN DVPERSINCGRP1 = '98';
IF MD4_03 = 99 THEN DVPERSINCGRP1 = '99';


IF MD4_03 in (1, 2, 3, 4, 5) THEN DVPERSINCGRP2 = '01';
IF MD4_03 in (6, 7, 8, 9) THEN DVPERSINCGRP2 = '02';
IF MD4_03 in (10, 11, 12) THEN DVPERSINCGRP2 = '03';
IF MD4_03 = 98 THEN DVPERSINCGRP2 = '98';
IF MD4_03 = 99 THEN DVPERSINCGRP2 = '99';


IF MD4_04 in (1, 2, 3, 4) THEN DVHHOLDINCGRP1 = '01';
IF MD4_04 = 5 THEN DVHHOLDINCGRP1 = '02';
IF MD4_04 in (6, 7) THEN DVHHOLDINCGRP1 = '03';
IF MD4_04 in (8, 9) THEN DVHHOLDINCGRP1 = '04';
IF MD4_04 = 10 THEN DVHHOLDINCGRP1 = '05';
IF MD4_04 in (11, 12) THEN DVHHOLDINCGRP1 = '06';
IF MD4_04 = 98 THEN DVHHOLDINCGRP1 = '98';
IF MD4_04 = 99 THEN DVHHOLDINCGRP1 = '99';


IF MD4_04 in (1, 2, 3, 4, 5) THEN DVHHOLDINCGRP2 = '01';
IF MD4_04 in (6, 7, 8, 9) THEN DVHHOLDINCGRP2 = '02';
IF MD4_04 = 10 THEN DVHHOLDINCGRP2 = '03';
IF MD4_04 in (11, 12) THEN DVHHOLDINCGRP2 = '04';
IF MD4_04 = 98 THEN DVHHOLDINCGRP2 = '98';
IF MD4_04 = 99 THEN DVHHOLDINCGRP2 = '99';

IF ID1_07 in (0, 1, 2, 3, 4, 5, 6) THEN DVSATISFACTION = '01';
IF ID1_07 = 7 THEN DVSATISFACTION = '02';
IF ID1_07 = 8 THEN DVSATISFACTION = '03';
IF ID1_07 = 9 THEN DVSATISFACTION = '04';
IF ID1_07 = 10 THEN DVSATISFACTION = '05';
IF ID1_07 = 98 THEN DVSATISFACTION = '98';
IF ID1_07 = 99 THEN DVSATISFACTION = '99';

IF ID1_08 in (0, 1, 2, 3, 4, 5, 6) THEN DVSAFEFEEL = '01';
IF ID1_08 = 7 THEN DVSAFEFEEL = '02';
IF ID1_08 = 8 THEN DVSAFEFEEL = '03';
IF ID1_08 = 9 THEN DVSAFEFEEL = '04';
IF ID1_08 = 10 THEN DVSAFEFEEL = '05';
IF ID1_08 = 98 THEN DVSAFEFEEL = '98';
IF ID1_08 = 99 THEN DVSAFEFEEL = '99"';

MB2013=meshblock2013;
PSU=PSU2015;

Select;
when (UrbanRuralIndicator2018 = 11)  DVURBAN='1';
when (UrbanRuralIndicator2018 = 12)  DVURBAN='2';
when (UrbanRuralIndicator2018 = 13)  DVURBAN='3';
when (UrbanRuralIndicator2018 = 14)  DVURBAN='4';
when (UrbanRuralIndicator2018 = 21)  DVURBAN='5';
when (UrbanRuralIndicator2018 = 22)  DVURBAN='6';
when (UrbanRuralIndicator2018 in (31,32,33))  DVURBAN='7';
otherwise DVURBAN='';
end;

if Region2015=1 then DVREGCOUNCIL = '01';
if Region2015=2 then DVREGCOUNCIL = '02';
if Region2015=3 then DVREGCOUNCIL = '03';
if Region2015=4 then DVREGCOUNCIL = '04';
if Region2015=5 then DVREGCOUNCIL = '05';
if Region2015=6 then DVREGCOUNCIL = '06';
if Region2015=7 then DVREGCOUNCIL = '07';
if Region2015=8 then DVREGCOUNCIL = '08';
if Region2015=9 then DVREGCOUNCIL = '09';
if Region2015=12 then DVREGCOUNCIL = '12';
if Region2015=13 then DVREGCOUNCIL = '13';
if Region2015=14 then DVREGCOUNCIL = '14';
if Region2015=15 then DVREGCOUNCIL = '15';
if Region2015=16 then DVREGCOUNCIL = '16';
if Region2015=17 then DVREGCOUNCIL = '17';
if Region2015=18 then DVREGCOUNCIL = '18';
if Region2015=99 then DVREGCOUNCIL = '99';

IF Region2015 = 2 THEN DVREGIONGRP5 = '1';
IF Region2015 = 9 THEN DVREGIONGRP5 = '2';
IF Region2015 in (1, 3, 4, 5, 6, 7, 8) THEN DVREGIONGRP5   = '3';
IF Region2015 = 13 THEN DVREGIONGRP5 = '4';
IF Region2015 in (12, 14, 15, 16, 17, 18) THEN DVREGIONGRP5 = '5';

NZDEPSCORE=NZDepScore2013;

NZDEPDECILE='      ';
Select;
when (NZDep2013 = 1)  NZDEPDECILE='01';
when (NZDep2013 = 2)  NZDEPDECILE='02';
when (NZDep2013 = 3)  NZDEPDECILE='03';
when (NZDep2013 = 4)  NZDEPDECILE='04';
when (NZDep2013 = 5)  NZDEPDECILE='05';
when (NZDep2013 = 6)  NZDEPDECILE='06';
when (NZDep2013 = 7)  NZDEPDECILE='07';
when (NZDep2013 = 8)  NZDEPDECILE='08';
when (NZDep2013 = 9)  NZDEPDECILE='09';
when (NZDep2013 = 10)  NZDEPDECILE='10';
otherwise NZDEPDECILE='9999';
end; 

NZDEPQUINTILE='      ';
Select;
when (NZDep2013 in (1,2))  NZDEPQUINTILE='01';
when (NZDep2013 in (3,4))  NZDEPQUINTILE='02';
when (NZDep2013 in (5,6))  NZDEPQUINTILE='03';
when (NZDep2013 in (7,8))  NZDEPQUINTILE='04';
when (NZDep2013 in (9,10))  NZDEPQUINTILE='05';
otherwise NZDEPQUINTILE='9999';
end;


IF FV1_07 = 1 OR FV1_08 = 1 THEN DVEVERSEXASSAULT = '1';
ELSE DVEVERSEXASSAULT = '2';

IF FV1_09 = 1 OR FV1_10 = 1 THEN DVEVEROTHASSAULT = '1';
ELSE DVEVEROTHASSAULT = '2';

IF MD1_03 = 1 THEN DV_L1_VISION = '2';
ELSE IF MD1_03 IN (98, 99) THEN DV_L1_VISION = '9';
ELSE DV_L1_VISION = '1';

IF MD1_03 IN (1, 2) THEN DV_L2_VISION = '2';
ELSE IF MD1_03 IN (98, 99) THEN DV_L2_VISION = '9';
ELSE DV_L2_VISION = '1t';

IF MD1_03 IN (1, 2, 3) THEN DV_L3_VISION = '2';
ELSE IF MD1_03 IN (98, 99) THEN DV_L3_VISION = '9';
ELSE DV_L3_VISION = '1';

IF MD1_04 = 1 THEN DV_L1_HEAR = '2';
ELSE IF MD1_04 IN (98, 99) THEN DV_L1_HEAR = '9';
ELSE DV_L1_HEAR = '1';

IF MD1_04 IN (1, 2) THEN DV_L2_HEAR = '2';
ELSE IF MD1_04 IN (98, 99) THEN DV_L2_HEAR = '9';
ELSE DV_L2_HEAR = '1';

IF MD1_04 IN (1, 2, 3) THEN DV_L3_Hear = '2';
ELSE IF MD1_04 IN (98, 99) THEN DV_L3_Hear = '9';
ELSE DV_L3_Hear = '1';

IF MD1_05 = 1 THEN DV_L1_MOBILE = '2';
ELSE IF MD1_05 IN (98, 99) THEN DV_L1_MOBILE = '9';
ELSE DV_L1_MOBILE = '1';


IF MD1_05 IN (1, 2) THEN DV_L2_MOBILE = '2';
ELSE IF MD1_05 IN (98, 99) THEN DV_L2_MOBILE = '9';
ELSE DV_L2_MOBILE = '1';

IF MD1_05 IN (1, 2, 3) THEN DV_L3_MOBILE = '2';
ELSE IF MD1_05 IN (98, 99) THEN DV_L3_MOBILE = '9';
ELSE DV_L3_MOBILE = '1';

IF MD1_06 = 1 THEN DV_L1_MEMORY = '2';
ELSE IF MD1_06 IN (98, 99) THEN DV_L1_MEMORY = '9';
ELSE DV_L1_MEMORY = '1';

IF MD1_06 IN (1, 2) THEN DV_L2_MEMORY = '2';
ELSE IF MD1_06 IN (98, 99) THEN DV_L2_MEMORY = '9';
ELSE DV_L2_MEMORY = '1';

IF MD1_06 IN (1, 2, 3) THEN DV_L3_MEMORY = '2';
ELSE IF MD1_06 IN (98, 99) THEN DV_L3_MEMORY = '9';
ELSE DV_L3_MEMORY = '1';

IF MD1_07 = 1 THEN DV_L1_SELFCARE = '2';
ELSE IF MD1_07 IN (98, 99) THEN DV_L1_SELFCARE = '9';
ELSE DV_L1_SELFCARE = '1';


IF MD1_07 IN (1, 2) THEN DV_L2_SELFCARE = '2';
ELSE IF MD1_07 IN (98, 99) THEN DV_L2_SELFCARE = '9';
ELSE DV_L2_SELFCARE = '1';

IF MD1_07 = 1 THEN DV_L3_SELFCARE = '2';
ELSE IF MD1_07 IN (98, 99) THEN DV_L3_SELFCARE = '9';
ELSE DV_L3_SELFCARE = '1';


IF MD1_08 = 1 THEN DV_L1_COMMS = '2';
ELSE IF MD1_08 IN (98, 99) THEN DV_L1_COMMS = '9';
ELSE DV_L1_COMMS = '1';

IF MD1_08 IN (1, 2) THEN DV_L2_COMMS = '2';
ELSE IF MD1_08 IN (98, 99) THEN DV_L2_COMMS = '9';
ELSE DV_L2_COMMS = '1';

IF MD1_08 IN (1, 2, 3) THEN DV_L3_COMMS = '2';
ELSE IF MD1_08 IN (98, 99) THEN DV_L3_COMMS = '9';
ELSE DV_L3_COMMS =  '1';


IF DV_L1_VISION = '1' THEN COUNT_VISION = 1; ELSE COUNT_VISION = 0;
IF DV_L1_HEAR = '1' THEN COUNT_HEAR = 1; ELSE COUNT_HEAR = 0;
IF DV_L1_MOBILE = '1' THEN COUNT_MOBILE = 1; ELSE COUNT_MOBILE = 0;
IF DV_L1_MEMORY = '1' THEN COUNT_MEMORY = 1; ELSE COUNT_MEMORY = 0;
IF DV_L1_SELFCARE = '1' THEN COUNT_SELFCARE = 1; ELSE COUNT_SELFCARE = 0;
IF DV_L1_COMMS = '1' THEN COUNT_COMMS = 1; ELSE COUNT_COMMS = 0;


DV_WGSS_COUNT = sum(
COUNT_VISION,
COUNT_HEAR,
COUNT_MOBILE,
COUNT_MEMORY,
COUNT_SELFCARE,
COUNT_COMMS);

IF DV_L1_VISION = '1' AND DV_L1_HEAR = '1' 
AND DV_L1_MOBILE = '1' AND DV_L1_MEMORY = '1' 
AND DV_L1_SELFCARE = '1' AND DV_L1_COMMS = '1'
THEN DV_WGSS1 = '1';
else IF DV_L1_VISION = '9' AND DV_L1_HEAR = '9' 
AND DV_L1_MOBILE = '9' AND DV_L1_MEMORY = '9' 
AND DV_L1_SELFCARE = '9' AND DV_L1_COMMS = '9'
THEN DV_WGSS1 = '9';
ELSE DV_WGSS1 = '2';

IF DV_L2_VISION = '1' AND DV_L2_HEAR = '1' 
AND DV_L2_MOBILE = '1' AND DV_L2_MEMORY = '1' 
AND DV_L2_SELFCARE = '1' AND DV_L2_COMMS = '1'
THEN DV_WGSS2 = '1';
else IF DV_L2_VISION = '9' AND DV_L2_HEAR = '9' 
AND DV_L2_MOBILE = '9' AND DV_L2_MEMORY = '9' 
AND DV_L2_SELFCARE = '9' AND DV_L2_COMMS = '9'
THEN DV_WGSS2 = '9';
ELSE DV_WGSS2 = '2';

IF DV_L3_VISION = '1' AND DV_L3_HEAR = '1' 
AND DV_L3_MOBILE = '1' AND DV_L3_MEMORY = '1' 
AND DV_L3_SELFCARE = '1' AND DV_L3_COMMS = '1'
THEN DV_WGSS3 = '1';
else IF DV_L3_VISION = '9' AND DV_L3_HEAR = '9' 
AND DV_L3_MOBILE = '9' AND DV_L3_MEMORY = '9' 
AND DV_L3_SELFCARE = '9' AND DV_L3_COMMS = '9'
THEN DV_WGSS3 = '9';
ELSE DV_WGSS3 = '2';

IF DV_WGSS_COUNT > 1 OR DV_WGSS2 = '1' THEN DV_WGSS4 = '1';
ELSE DV_WGSS4= '2';
IF DV_WGSS1 = '9' AND DV_WGSS2 = '9' THEN DV_WGSS4 = '9';

Select;
when (MD1_09 = 1)  MD1_09s=4;
when (MD1_09 = 2)  MD1_09s=3;
when (MD1_09 = 3)  MD1_09s=2;
when (MD1_09 = 4)  MD1_09s=1;
when (MD1_09 = 5)  MD1_09s=0;
otherwise MD1_09s=.;
end;

Select;
when (MD1_10 = 1)  MD1_10s=4;
when (MD1_10 = 2)  MD1_10s=3;
when (MD1_10 = 3)  MD1_10s=2;
when (MD1_10 = 4)  MD1_10s=1;
when (MD1_10 = 5)  MD1_10s=0;
otherwise MD1_10s=.;
end;

Select;
when (MD1_11 = 1)  MD1_11s=4;
when (MD1_11 = 2)  MD1_11s=3;
when (MD1_11 = 3)  MD1_11s=2;
when (MD1_11 = 4)  MD1_11s=1;
when (MD1_11 = 5)  MD1_11s=0;
otherwise MD1_11s=.;
end;

Select;
when (MD1_12 = 1)  MD1_12s=4;
when (MD1_12 = 2)  MD1_12s=3;
when (MD1_12 = 3)  MD1_12s=2;
when (MD1_12 = 4)  MD1_12s=1;
when (MD1_12 = 5)  MD1_12s=0;
otherwise MD1_12s=.;
end;

Select;
when (MD1_13 = 1)  MD1_13s=4;
when (MD1_13 = 2)  MD1_13s=3;
when (MD1_13 = 3)  MD1_13s=2;
when (MD1_13 = 4)  MD1_13s=1;
when (MD1_13 = 5)  MD1_13s=0;
otherwise MD1_13s=.;
end;

Select;
when (MD1_14 = 1)  MD1_14s=4;
when (MD1_14 = 2)  MD1_14s=3;
when (MD1_14 = 3)  MD1_14s=2;
when (MD1_14 = 4)  MD1_14s=1;
when (MD1_14 = 5)  MD1_14s=0;
otherwise MD1_14s=.;
end;

Count_miss=nmiss(MD1_09s ,
MD1_10s ,
MD1_11s ,
MD1_12s ,
MD1_13s ,
MD1_14s );

if Count_miss=0 then 
DVMENTALSCORE = sum(
MD1_09s ,
MD1_10s ,
MD1_11s ,
MD1_12s ,
MD1_13s ,
MD1_14s );
else if Count_miss=1 then do
DVMENTALSCORE = sum(
MD1_09s ,
MD1_10s ,
MD1_11s ,
MD1_12s ,
MD1_13s ,
MD1_14s )/5 *6;
end;
else DVMENTALSCORE=.;

IF DVMENTALSCORE <= 15 THEN DVMENTALSCORELV = '1';
IF DVMENTALSCORE >= 16 and DVMENTALSCORE<100 THEN DVMENTALSCORELV = '2';
if DVMENTALSCORE = . then DVMENTALSCORELV='9';


/*screener*/
DVSCREEN_INCIDENTCOUNT = SUM(
VS1_01Num, VS1_03Num,
VS2_01Num, VS2_04Num, VS2_07Num, VS2_10Num, VS2_13Num, VS2_16Num,
VS3_01Num, VS3_02Num,
VS4_01Num, VS4_04Num,
VS5_01Num,
VS6_01Num, VS6_03Num,
VS7_01Num, VS7_02Num,
VS8_01Num,
VS9_02Num, VS9_04Num, VS9_06Num, VS9_08Num,
VS10_02Num, VS10_04Num,
VS11_02Num, VS11_04Num, VS11_06Num, VS11_08Num,
VS13_01Num);

IF sum(VS1_01Num,VS1_02Num,VS1_03Num,VS1_04Num)>0 THEN DVSCREEN_BURGLARY = '1' ; 
ELSE DVSCREEN_BURGLARY = '0';

IF sum(VS2_01Num,VS2_02Num,VS2_03Num,VS2_04Num,VS2_05Num,VS2_06Num,VS2_07Num,VS2_08Num,VS2_09Num,VS2_10Num,VS2_11Num,VS2_12Num,VS2_13Num,VS2_14Num,VS2_15Num,VS2_16Num,VS2_17Num,VS2_18Num)>0 THEN DVSCREEN_VEHICLEBICYCLE = '1';
ELSE DVSCREEN_VEHICLEBICYCLE = '0';

IF sum(VS3_01Num,VS3_02Num)>0 THEN DVSCREEN_PROPERTYDAMAGE = '1';
ELSE DVSCREEN_PROPERTYDAMAGE = '0';

IF sum(VS4_01Num,VS4_02Num,VS4_03Num,VS4_04Num)>0 THEN DVSCREEN_THEFT = '1';
ELSE DVSCREEN_THEFT = '0';

IF VS5_01Num>0 THEN DVSCREEN_TRESPASS = '1' ;
ELSE DVSCREEN_TRESPASS = '0';

IF sum(VS6_01Num,VS6_02Num,VS6_03Num)>0 THEN DVSCREEN_ROBBERY = '1';
ELSE DVSCREEN_ROBBERY = '0';

IF sum(VS7_01Num,VS7_02Num)>0 THEN DVSCREEN_FRAUD = '1';
ELSE DVSCREEN_FRAUD = '0';

IF VS8_01Num>0 THEN DVSCREEN_CYBERCRIME = '1';
ELSE DVSCREEN_CYBERCRIME = '0';

IF VS9_01=1 or VS9_03=1 or VS9_05=1 or VS9_07=1 THEN DVSCREEN_SEXUAL = '1';
ELSE DVSCREEN_SEXUAL = '0';

IF VS10_01=1 or VS10_03=1 THEN DVSCREEN_ASSAULT = '1';
ELSE DVSCREEN_ASSAULT = '0';

IF VS11_01=1 or VS11_03=1 or VS11_05=1 or VS11_07=1 THEN DVSCREEN_THREAT = '1';
ELSE DVSCREEN_THREAT = '0';

IF VS13_01Num >0 THEN DVSCREEN_OTHER = '1'; ELSE DVSCREEN_OTHER = '0';

IF VS12_01=1 or VS12_02=1 or VS12_03=1 THEN DVBREACHORDERS = '1';
ELSE DVBREACHORDERS = '0';

drop /*COUNT_VISION COUNT_HEAR COUNT_MOBILE COUNT_MEMORY COUNT_SELFCARE COUNT_COMMS*/
MD1_09s MD1_10s MD1_11s MD1_12s MD1_13s MD1_14s Count_miss
;
run;

/*add Income impute
PROC IMPORT OUT= income DATAFILE= "C:\Documents and Settings\cbg.thomas\My Documents\data\NZCVS\CVS_Income_Impute.xlsx"
            DBMS=xlsx REPLACE;		
     GETNAMES=YES;
RUN;

data income_clean;
set income;
keep psu2015 nzcvshhid DVPERSONINCOMEN	DVHHOLDINCOMEN DVPERSONINCOMEN_imp	DVHHOLDINCOMEN_imp;
rename 
DVPERSONINCOMEN=DVPERSONINCOME
DVHHOLDINCOMEN=DVHHOLDINCOME
DVPERSONINCOMEN_imp=DVPERSONINCOME_imp
DVHHOLDINCOMEN_imp=DVHHOLDINCOME_imp
;
run;


proc sort data = Nzcvs_moj; by psu2015 nzcvshhid; run;
proc sort data = income_clean; by psu2015 nzcvshhid; run;

data Nzcvs_moj;
merge Nzcvs_moj(drop=DVPERSONINCOME DVHHOLDINCOME in=in1) income_clean(in=in2);
by  psu2015 nzcvshhid;
if in1 and in2;
run;
*/
/*add HHcomp variable
%INCLUDE "C:\Documents and Settings\cbg.thomas\My Documents\Program\NZCVS\Year1\CVSHouseholdComp.sas";

proc sort data = hhcomp_final; by psu2015 nzcvshhid; run;

data Nzcvs_moj;
merge Nzcvs_moj(in=in1) hhcomp_final(keep = psu2015 nzcvshhid DVHHCOMP );
by psu2015 nzcvshhid;
if in1;
run;

data Nzcvs_moj;
set Nzcvs_moj;
if DVNUMUSRES=1 then DVHHCOMP='01';
if DVHHCOMP='' then DVHHCOMP='98';
run;
*/

/*add final offence code from our form site*/
data code;
set CVSform.Coding;
where qtr in (3,4,5,6);
/*patch error*/
/*patch error*/
if nzcvshhid="A1507409" then nzcvshhid="A1507414";
if nzcvshhid="A1040024" then nzcvshhid="A1043541";
if nzcvshhid="A0779315" then nzcvshhid="A0777562";
if nzcvshhid="A1409009" then nzcvshhid="A3285609";
if nzcvshhid="A0374791" then nzcvshhid="A0374801";
if nzcvshhid="A0374791" then nzcvshhid="A0374801";
if nzcvshhid="A1454321" then nzcvshhid="A1452409";
if nzcvshhid="A1413510" then nzcvshhid="A1412964";
if nzcvshhid="A2600132" then nzcvshhid="A1013364";
if nzcvshhid="A1221691" then nzcvshhid="A1219901";
if nzcvshhid="A0054373" then nzcvshhid="A0054377";
if nzcvshhid="A0761061" then nzcvshhid="A0760476";
if nzcvshhid="A0224977" then nzcvshhid="A0224983";
if nzcvshhid="A0219296" then nzcvshhid="A0215063";
if nzcvshhid="A1409009" then nzcvshhid="A3285609";
if nzcvshhid="A1091727" then nzcvshhid="A1096561";
if nzcvshhid="A0360549" then nzcvshhid="A0360561";
if nzcvshhid="A2600132" then nzcvshhid="A1013364";
if nzcvshhid="A0374791" then nzcvshhid="A0374801";
if nzcvshhid="A0779315" then nzcvshhid="A0777562";
if nzcvshhid="A1221691" then nzcvshhid="A1219901";
if nzcvshhid="A0586480" then nzcvshhid="A0697543";
if nzcvshhid="A1091724" then nzcvshhid="A1513315";
if nzcvshhid="A0995595" then nzcvshhid="A0998639";
if nzcvshhid="A1221691" then nzcvshhid="A1219901";
run;

proc sort data =code; by qtr PSU2015 nzcvshhid;run;
proc sort data = Nzcvs_moj; by qtr psu2015 nzcvshhid; run;

data Nzcvs_moj;
merge Nzcvs_moj(in=in1) code (keep= qtr PSU2015 nzcvshhid FinalOffenceCodeCVF1--FinalOffenceCodeIVF8);
by  qtr PSU2015 nzcvshhid;
if in1;
run;

data Nzcvs_moj;
set Nzcvs_moj;

/*get FinalOffenceCodeNum*/
if VFType_1=1 and (FinalOffenceCodeCVF1 ne . or FinalOffenceCodeIVF1 ne .) then FinalOffenceCode1Num=CurrentIncidentsCount_1;
if VFType_2=1 and (FinalOffenceCodeCVF2 ne . or FinalOffenceCodeIVF2 ne .) then FinalOffenceCode2Num=CurrentIncidentsCount_2;
if VFType_3=1 and (FinalOffenceCodeCVF3 ne . or FinalOffenceCodeIVF3 ne .) then FinalOffenceCode3Num=CurrentIncidentsCount_3;
if VFType_4=1 and (FinalOffenceCodeCVF4 ne . or FinalOffenceCodeIVF4 ne .) then FinalOffenceCode4Num=CurrentIncidentsCount_4;
if VFType_5=1 and (FinalOffenceCodeCVF5 ne . or FinalOffenceCodeIVF5 ne .) then FinalOffenceCode5Num=CurrentIncidentsCount_5;
if VFType_6=1 and (FinalOffenceCodeCVF6 ne . or FinalOffenceCodeIVF6 ne .) then FinalOffenceCode6Num=CurrentIncidentsCount_6;
if VFType_7=1 and (FinalOffenceCodeCVF7 ne . or FinalOffenceCodeIVF7 ne .) then FinalOffenceCode7Num=CurrentIncidentsCount_7;
if VFType_8=1 and (FinalOffenceCodeCVF8 ne . or FinalOffenceCodeIVF8 ne .) then FinalOffenceCode8Num=CurrentIncidentsCount_8;

/*IVF set to 1*/
if VFType_1=2 and (FinalOffenceCodeCVF1 ne . or FinalOffenceCodeIVF1 ne .) then FinalOffenceCode1Num=1;
if VFType_2=2 and (FinalOffenceCodeCVF2 ne . or FinalOffenceCodeIVF2 ne .) then FinalOffenceCode2Num=1;
if VFType_3=2 and (FinalOffenceCodeCVF3 ne . or FinalOffenceCodeIVF3 ne .) then FinalOffenceCode3Num=1;
if VFType_4=2 and (FinalOffenceCodeCVF4 ne . or FinalOffenceCodeIVF4 ne .) then FinalOffenceCode4Num=1;
if VFType_5=2 and (FinalOffenceCodeCVF5 ne . or FinalOffenceCodeIVF5 ne .) then FinalOffenceCode5Num=1;
if VFType_6=2 and (FinalOffenceCodeCVF6 ne . or FinalOffenceCodeIVF6 ne .) then FinalOffenceCode6Num=1;
if VFType_7=2 and (FinalOffenceCodeCVF7 ne . or FinalOffenceCodeIVF7 ne .) then FinalOffenceCode7Num=1;
if VFType_8=2 and (FinalOffenceCodeCVF8 ne . or FinalOffenceCodeIVF8 ne .) then FinalOffenceCode8Num=1;

if FinalOffenceCodeCVF1 ne . then FinalOffenceCode1= FinalOffenceCodeCVF1; else FinalOffenceCode1=FinalOffenceCodeIVF1;
if FinalOffenceCodeCVF2 ne . then FinalOffenceCode2= FinalOffenceCodeCVF2; else FinalOffenceCode2=FinalOffenceCodeIVF2;
if FinalOffenceCodeCVF3 ne . then FinalOffenceCode3= FinalOffenceCodeCVF3; else FinalOffenceCode3=FinalOffenceCodeIVF3;
if FinalOffenceCodeCVF4 ne . then FinalOffenceCode4= FinalOffenceCodeCVF4; else FinalOffenceCode4=FinalOffenceCodeIVF4;
if FinalOffenceCodeCVF5 ne . then FinalOffenceCode5= FinalOffenceCodeCVF5; else FinalOffenceCode5=FinalOffenceCodeIVF5;
if FinalOffenceCodeCVF6 ne . then FinalOffenceCode6= FinalOffenceCodeCVF6; else FinalOffenceCode6=FinalOffenceCodeIVF6;
if FinalOffenceCodeCVF7 ne . then FinalOffenceCode7= FinalOffenceCodeCVF7; else FinalOffenceCode7=FinalOffenceCodeIVF7;
if FinalOffenceCodeCVF8 ne . then FinalOffenceCode8= FinalOffenceCodeCVF8; else FinalOffenceCode8=FinalOffenceCodeIVF8;
run;

/*add weights*/
data NZCVS.Nzcvsoccupants;
set nzcvs1.Nzcvsoccupants;
where qtr in (3,4) and age>=15; *remove pilot records;
if EthnicityMO='M' then maori=1; else maori=0;

/*patch 4 households with 2 selected respondents
if nzcvshhid='A0138293' and age=79 then selected=0;
*/
/*1 houeshold with reselction but didnt record correctly in SM
if nzcvshhid='A3104689' then Reselection=1;
*/
run;

/*patch 4 missing occpants
proc sql;
  insert into NZCVS.Nzcvsoccupants
   set 	qtr=2,
   		psu2015=19147,
		nzcvshhid='A1154774',
		age=42,
		EthnicityMO='O',
		maori=0,
		selected=1

;quit;
*/

proc sort data= NZCVS.Nzcvsoccupants; by PSU2015 NZCVSHHID; run;

%INCLUDE "C:\Documents and Settings\cbg.thomas\My Documents\Program\NZCVS\Year1\NZCVSSelectionWeightY2.sas";


/*.
hholdweight: HH weight post-stratify by region
hholdweight_rep1-hholdweight_rep100: 100 replicate household weights
PersonWeight: person weight post-stratify by maori/non-maori
PersonWeight_rep1-PersonWeight_rep100: 100 replicate person weights
*/

proc sort data= Nzcvs_moj; by PSU2015 NZCVSHHID; run;

data Nzcvs_moj;
merge Nzcvs_moj(in=in1) 
nzcvs.SelectionWeightYear2(in=in2 keep=psu2015 nzcvshhid hholdweight PersonWeight hholdweight_rep1-hholdweight_rep100 PersonWeight_rep1-PersonWeight_rep100);
by psu2015 nzcvshhid;
if in1 and in2;
run;


proc sort data= Nzcvs_moj nodupkey; by qtr PSU2015 NZCVSHHID;  run;

/*back code other specify
%INCLUDE "C:\Documents and Settings\cbg.thomas\My Documents\Program\NZCVS\Year1\BackCodingY1.sas";
*/

/*final patch*/
data Nzcvs_moj;
set Nzcvs_moj;
run;

data nzcvs.Year2_NZCVSSurvey;
set Nzcvs_moj;
drop DatSurveyor CBGQ1 meshblock2013 UrbanRuralIndicator2018 Region2015 NZDepScore2013 total_people child_count VFSetter1-VFSetter8 RecordComments;
run;

/*internal version with surveyor name for audit*/
data nzcvs.Year2_NZCVSSurvey_Name;
set Nzcvs_moj;
run;


data try;
set nzcvs.Year2_NZCVSSurvey;
keep surveyorID;
run;

data char;
set nzcvs.Year2_NZCVSSurvey;
keep qtr psu2015 _character_;
run;


/*
ods csv body="CVSY2_Other.csv"
path="C:\Documents and Settings\cbg.thomas\My Documents\Misc";
proc print data =char  noobs;
run;
ods csv close;
*/
